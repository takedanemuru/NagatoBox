' Gambas class file

Property Read Image As Image
Property Read Number As Integer
Property Read SafeTitle As String
Property Read Alt As String

Private Const ApiCurrent As String = "http://xkcd.com/info.0.json"
Private Const ApiSelect As String = "http://xkcd.com/&1/info.0.json"

Private $imageDownloader As New NagatoImageDownloader As "ImageDownloader"
Private $xkcdDownloader As New NagatoXkcdDownloader As "XkcdDownloader"

Event Finished

Public Sub GetCurrent()
    
    $xkcdDownloader.Get(ApiCurrent)
    
End

Public Sub GetSelect(argNumber As Integer)
    
    $xkcdDownloader.Get(Subst$(ApiSelect, argNumber))
    
End

Public Sub XkcdDownloader_Finished()
    
    $imageDownloader.Get($xkcdDownloader.ImageUrl)
    
End

Public Sub ImageDownloader_Finished()
    
    Raise Finished
    
End

Private Function Image_Read() As Image

    Return $imageDownloader.Image

End

Private Function Number_Read() As Integer

    Return $xkcdDownloader.Number

End

Private Function SafeTitle_Read() As String

    Return $xkcdDownloader.SafeTitle

End

Private Function Alt_Read() As String

    Return $xkcdDownloader.AlternativeTitle

End
