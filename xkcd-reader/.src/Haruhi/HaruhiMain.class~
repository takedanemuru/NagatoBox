' Gambas class file

Private $api As New NagatoXkcdApi As "Api"
Private $index As New NagatoComicIndex

Private Sub setImageView()
    
    With MainImageView
        .Image = $api.Image
        .Tooltip = $api.Alt
        .W = $api.Image.W
        .H = $api.Image.H
    End With
    
End

Private Sub setForm()
    
    With Me
        .Title = Subst$("(#&1)  &2", $api.Number, $api.SafeTitle)
        .Center()
        .Show()
    End With
    
End

Public Sub Start()

    $api.GetCurrent()
    '$api.GetSelect(901)

End

Public Sub Api_Finished()
    
    $index.Reset($api.Number)
    Debug $index.Max
    
    setImageView()
    setForm()
    
End
