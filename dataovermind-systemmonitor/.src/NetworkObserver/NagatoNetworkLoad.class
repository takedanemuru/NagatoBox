' Gambas class file

Property Read ReceiveTotal As Integer
Property Read ReceiveBps As Float
Property Read ReceiveBpsHistory As Float[]
Property Read TransmitTotal As Integer
Property Read TransmitBps As Float
Property Read TransmitBpsHistory As Float[]

Private $streamReader As New NagatoNetworkStreamReader
Private $receiveHistory As New NagatoHistory
Private $transmitHistory As New NagatoHistory

Public Sub Prep()
    
    $streamReader.Refresh()
    
    $receiveHistory.Push($streamReader.ReceiveBit)
    $transmitHistory.Push($streamReader.TransmitBit)
    
End

Public Sub Step()
    
    $streamReader.Refresh()
    
    $receiveHistory.Push($streamReader.ReceiveBit)
    $transmitHistory.Push($streamReader.TransmitBit)
    
End

Private Function ReceiveTotal_Read() As Integer

    Return $receiveHistory.Current

End

Private Function ReceiveBps_Read() As Float

    Return $receiveHistory.Diff * (1000 / NagatoSettings.ObservationInterval) * 8

End

Private Function TransmitTotal_Read() As Integer

    Return $transmitHistory.Current

End

Private Function TransmitBps_Read() As Float

    Return $transmitHistory.Diff * (1000 / NagatoSettings.ObservationInterval) * 8

End

Private Function ReceiveBpsHistory_Read() As Float[]

    Return $receiveHistory.History

End

Private Function TransmitBpsHistory_Read() As Float[]

    Return $transmitHistory.History

End
