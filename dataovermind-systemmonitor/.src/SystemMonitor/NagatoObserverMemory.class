' Gambas class file

Inherits NagatoObserver

Private $memoryTotal As Integer
Private $memoryFree As Integer
Private $memoryBuffers As Integer
Private $memoryCached As Integer

Private Sub setVariables()
    
    Dim yukiArray As String[]
    
    yukiArray = Split(File.Load("/proc/meminfo"), "\n", "")
    $memoryTotal = Split(yukiArray[0], " ", "", True)[1]
    $memoryFree = Split(yukiArray[1], " ", "", True)[1]
    $memoryBuffers = Split(yukiArray[2], " ", "", True)[1]
    $memoryCached = Split(yukiArray[3], " ", "", True)[1]
    
End

Private Function getMemoryRate() As Float
    
    setVariables()
    
    Return ($memoryTotal - ($memoryFree + $memoryBuffers + $memoryCached)) / $memoryTotal
    
End

Public Sub GetStep() ' virtual
    
    Dim yukiUsage As Float = getMemoryRate()
    
    Me._$usage = yukiUsage
    Me._$history.Push(yukiUsage)
    
End