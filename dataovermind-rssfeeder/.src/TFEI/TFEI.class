' Gambas class file

Inherits DBusObject

Create Static

Property Read Ready As String
Property Read FeedCount As Integer
Property Read FeedReady As Boolean

Public Sub Stop() As Boolean
    
    NagatoDBus.Unregister()
    
    If Not Error Then Return True
    
Catch
    Return False
    
End

Public Sub GetFeedTitle(argFeedIndex As Integer) As String
    
    Return NagatoRss[argFeedIndex].Title
    
End

Public Sub GetFeedItemsCount(argFeedIndex As Integer) As Integer
    
    Return NagatoRss[argFeedIndex].Items.Count
    
End

Public Sub GetFeedItem(argFeedIndex As Integer, argItemIndex As Integer) As String[]
    
    Dim yukiArray As New String[]
    
    With NagatoRss[argFeedIndex].Items[argItemIndex]
        yukiArray.Add(.Title)
        yukiArray.Add(.Description)
        yukiArray.Add(.Link)
        yukiArray.Add(.ThumbnailPath)
    End With
    
    Return yukiArray
    
End

Private Function Ready_Read() As String

    Return "YUKI.N >  Can you see this ?"

End

Private Function FeedCount_Read() As Integer

    Return NagatoRss.Count

End

Private Function FeedReady_Read() As Boolean

    Return NagatoRss.Ready

End
