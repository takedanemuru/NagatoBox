' Gambas class file

Private Sub initializeRecentIcons()
    
    Dim yukiPath As String
    
    RecentIcons.Clear()
    
    For Each yukiPath In NagatoSettings.RecentPath
        If Not Exist(yukiPath) Then Continue
        If DesktopMime.FromFile(yukiPath).Type Not Begins "image" Then Continue
        RecentIcons.Add(yukiPath, File.Name(yukiPath), MikuruThumbnailer.Get(yukiPath))
    Next
    
End

Private Sub showDirectory(argDirectory As String)
    
    Dim yukiPath As String
    
    SelectIcons.Clear()
    
    For Each yukiPath In Dir(argDirectory, "*", gb.File)
        If Not Exist(argDirectory &/ yukiPath) Then Continue
        If DesktopMime.FromFile(argDirectory &/ yukiPath).Type Not Begins "image" Then Continue
        If Not MikuruThumbnailer.IsLoadable(argDirectory &/ yukiPath) Then Continue
        SelectIcons.Add(argDirectory &/ yukiPath, yukiPath, MikuruThumbnailer.Get(argDirectory &/ yukiPath))
    Next
    
End

Public Sub Form_Open()
    
    Me.Center()
    
    initializeRecentIcons()
    'showDirectory(User.Home)
    
    FileChooser1.Filter = ["*.png;*.jpg;*.jpeg", "Picture Files"]
    FileChooser1.ShowPreview = True
    FileChooser1.FileView.IconSize = 128
    
End


Public Sub DirChooser1_Change()

    'showDirectory(DirChooser1.DirView.Current)

End

Public Sub RecentIcons_Activate()
    
    MikuruDialog.Path = RecentIcons.Key

    Me.Close(MikuruDialog.ResponseSelected)
    
End

Public Sub FileChooser1_Activate()

    MikuruDialog.Path = FileChooser1.SelectedPath
    
    Me.Close(MikuruDialog.ResponseSelected)

End
