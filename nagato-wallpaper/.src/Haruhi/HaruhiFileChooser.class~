' Gambas class file

Private Sub initializeRecentIcons()
    
    Dim yukiPath As String
    
    RecentIcons.Clear()
    
    For Each yukiPath In NagatoSettings.RecentPath
        If Not Exist(yukiPath) Then Continue
        If DesktopMime.FromFile(yukiPath).Type Not Begins "image" Then Continue
        RecentIcons.Add(yukiPath, File.Name(yukiPath), MikuruThumbnailer.Get(yukiPath))
    Next
    
End

Private Sub showDirectory()
    
    With MainFileChooser
        .Filter = ["*.png;*.jpg;*.jpeg", "Picture File"]
'        .FileView.IconSize = 128
    End With
    
End

Public Sub Form_Open()
    
    Me.Center()
    
    initializeRecentIcons()
    showDirectory()
    
End

Public Sub RecentIcons_Activate()
    
    MikuruDialog.Path = RecentIcons.Key

    Me.Close(MikuruDialog.ResponseSelected)
    
End

Public Sub MainFileChooser_Activate()

    Debug MainFileChooser.SelectedPath

End
