' Gambas class file

Private $drawingArea As NagatoPreviewDrawingArea
Private $toolbar As NagatoToolBar

Private Sub changeColor(argColor As Integer)

    NagatoPreViewProperties.Color = argColor
    $drawingArea.Refresh(argColor)

End

Public Sub SetPath(argPath As String)
    
    NagatoPreViewProperties.Path = argPath
    $drawingArea.Refresh()
    NagatoSettings.PushToRecentPaths(argPath)
    
End

Public Sub Form_Open()

    Application.MainWindow = Me
    Me.H = 28 + Screen.Height * (Me.W / Screen.Width)
    Me.Center()
    NagatoPreViewProperties.LoadLastProperties()
    $drawingArea = New NagatoPreviewDrawingArea(Me)
    $toolbar = New NagatoToolBar(Me) As "ToolBar"
    
End

Public Sub ToolBar_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.PropertyPathChanged
            Me.SetPath(argValues[0])
        Case MikuruSignal.PropertyModeChanged
            $drawingArea.Refresh()
        Case MikuruSignal.PropertyColorChanged
            changeColor(argValues[0])
    End Select
    
End

Public Sub _unknown(...) As Variant
    
    Return $drawingArea.GetProperty(Param.Name)
    
End

Public Sub _property(...) As Boolean
    
    ' has no unnamed method
    
    Return True
    
End
