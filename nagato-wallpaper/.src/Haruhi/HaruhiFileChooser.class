' Gambas class file

Private Sub initializeRecentIcons()
    
    Dim yukiPath As String
    
    RecentIcons.Clear()
    
    For Each yukiPath In NagatoSettings.RecentPath
        If Not Exist(yukiPath) Then Continue
        If DesktopMime.FromFile(yukiPath).Type Not Begins "image" Then Continue
        RecentIcons.Add(yukiPath, File.Name(yukiPath), MikuruThumbnailer.Get(yukiPath))
    Next
    
End

Public Sub Form_Open()
    
    Me.Center()
    
    initializeRecentIcons()
    
    FileChooser1.Filter = ["*.png;*.jpg;*.jpeg", "Picture Files"]
    FileChooser1.ShowPreview = True
    FileChooser1.FileView.IconSize = 128
    FileChooser1.Root = Desktop.GetDirectory("PICTURES")
    
End

Public Sub RecentIcons_Activate()
    
    MikuruDialog.Path = RecentIcons.Key

    Me.Close(MikuruDialog.ResponseSelected)
    
End

Public Sub FileChooser1_Activate()

    MikuruDialog.Path = FileChooser1.SelectedPath
    
    Me.Close(MikuruDialog.ResponseSelected)

End
