' Gambas class file

Create Static

Private Function isValidPath(argPath As String) As Boolean
    
    If argPath = "" Then Return False
    If Not Exist(argPath) Then Return False
    
    Return True
    
End

Private Sub reloadNagatoDesktopWallpaper()
    
    Dim yukiService As String = "Session://org.gambas.nagato-files"
    Dim yukiObjectPath As String = "/org/nagato/files"
    Dim yukiInterface As String = "org.gambas.nagato-files.nagatointerfacedesktop"
    
    Debug "try reload"
    
    Try DBus[yukiService][yukiObjectPath, yukiInterface].ReloadDesktopWallpaper()
    
End

Private Sub reloadWallpaper()
    
    If Not NagatoDBus.IsNagatoDesktopActivated() Then
        Shell Subst$("hsetroot &1 &2", "-center", MikuruHidden.PathModefiedImage)
    Else
        reloadNagatoDesktopWallpaper()
    End If
    
End

Public Sub Set(argPath As String, argBackground As Integer, argRenderMode As Integer)
    
    If Not isValidPath(argPath) Then Return
    
    MikuruOriginalImage.SetPath(argPath)
    MikuruModefiedImage.Set(argRenderMode)
    
    reloadWallpaper()
    
End

Public Sub SetLast()
    
    If Not NagatoDBus.isNagatoDesktopActivated() Then
        Shell Subst$("hsetroot &1 &2", "-center", MikuruHidden.PathModefiedImage)
    End If
    
End
