' Gambas class file

Create Static

Private Sub setModefiedImage(argRenderMode As Integer, argBackground As Integer)
    
    Dim yukiRendarer As Object
    
    Select argRenderMode
        Case MikuruRenderMode.Center
            yukiRendarer = New NagatoWallPaperCenter
        Case MikuruRenderMode.Tile
            yukiRendarer = New NagatoWallpaperTileCenter
        Case MikuruRenderMode.Full
            yukiRendarer = New NagatoWallpaperFull
        Case MikuruRenderMode.Fit
            yukiRendarer = New NagatoWallpaperFit
        Case MikuruRenderMode.Fill
            yukiRendarer = New NagatoWallpaperFill
    End Select
    
    yukiRendarer.Set(MikuruOriginalImage.Image)
    
End

Public Sub Set(argPath As String, argBackground As Integer, argRenderMode As Integer)
    
    If argPath = "" Then Return
    If Not Exist(argPath) Then Return
    
    MikuruOriginalImage.SetPath(argPath)
    setModefiedImage(argRenderMode, argBackground)
    
    Shell Subst$("hsetroot &1 &2", "-center", MikuruHidden.PathModefiedImage)
    
End

Public Sub SetLast()
    
    With NagatoSettings
        If Exist(MikuruHidden.PathOriginalImage) Then
            NagatoPreview.CalendarPosition = .LastCalendarPosition
            Me.Set(MikuruHidden.PathOriginalImage, .LastColor, .LastMode)
        Endif
    End With
    
End
