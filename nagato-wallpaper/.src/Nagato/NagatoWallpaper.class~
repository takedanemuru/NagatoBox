' Gambas class file

Create Static

Public Sub Set(argPath As String, argBackground As Integer, argRenderMode As Integer)
    
    If argPath = "" Then Return
    If Not Exist(argPath) Then Return
    
    Debug argBackground
    
    MikuruOriginalImage.SetPath(argPath)
    MikuruModefiedImage.Set(argRenderMode)
    
    If Not NagatoDBus.isNagatoDesktopActivated() Then
        Shell Subst$("hsetroot &1 &2", "-center", MikuruHidden.PathModefiedImage)
    End If
    
End

Public Sub SetLast()
    
    With NagatoSettings
        If Exist(MikuruHidden.PathOriginalImage) Then
            Me.Set(MikuruHidden.PathOriginalImage, .LastColor, .LastMode)
        Endif
    End With
    
End
