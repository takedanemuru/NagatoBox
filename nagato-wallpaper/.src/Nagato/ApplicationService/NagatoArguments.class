' Gambas class file

Property Read SetLast As Boolean
Property Read Options As String[]

Private $setLastPath As Boolean
Private $options As New String[]

Private Sub sanitizeOptions(argOptions As String[])
    
    Dim yukiPath As String
    
    For Each yukiPath In argOptions
        If Exist(yukiPath) And If DesktopMime.FromFile(yukiPath).Type Begins "image" Then $options.Add(yukiPath)
    Next
    
End

Public Sub _new()
    
    Dim yukiOptions As String[]
    
    Args.Begin()
        $setLastPath = Args.Has("l", "last", ("set last picture"))
    yukiOptions = Args.End()
    
    If yukiOptions.Count > 0 Then sanitizeOptions(yukiOptions)
    
End

Private Function SetLast_Read() As Boolean

    Return $setLastPath

End

Private Function Options_Read() As String[]

    Return $options

End
