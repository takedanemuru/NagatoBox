' Gambas class file

Private Const DownloadTimeout As Integer = 60

Private $httpClient As HttpClient

Event Finished

Private Sub createHttpClient()
    
    $httpClient = New HttpClient As "HttpClient"
    
    With $httpClient
        .URL = MikuruAozoraBunko.LinkForNovelList
        .Async = True
        .Timeout = DownloadTimeout
    End With
    
End

Public Sub Get()
    
    MikuruDirectory.CheckAndCreateAppHiddenDirectory()
    createHttpClient()
    $httpClient.Get(, MikuruDirectory.ZipFilePath)
    
End

Public Sub HttpClient_Finished()
    
    Dim yukiArchiver As New NagatoArchiver As "Archiver"
    
    With MikuruDirectory
        yukiArchiver.UnzipOverwrite(.ApplicationHidden, .ZipFilePath, .UnzippedFilePath)
    End With
    
End

Public Sub Archiver_Finished()
    
    Raise Finished
    
End
