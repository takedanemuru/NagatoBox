' Gambas class file

Inherits NagatoPainter2

Private Sub paintBox(argColumn As Integer, argRow As Integer, argColor As Integer)
    
    Dim yukiRect As Rect = Me._$ux.GetRectangle(argColumn, argRow)

    Paint.Brush = Paint.Color(argColor)
        Paint.Rectangle(yukiRect.X, yukiRect.Y, yukiRect.H, yukiRect.W)
    Paint.Fill()
    
End

Private Sub paintText(argText As String, argColumn As Integer, argRow As Integer)
    
    Dim yukiRect As Rect = Me._$ux.GetRectangle(argColumn, argRow)
    
    Paint.Brush = Paint.Color(Color.White)
        Paint.Text(argText, yukiRect.X, yukiRect.Y, yukiRect.H, yukiRect.W, Align.Center)
    Paint.Fill()
    
End

Private Function getTileColor(argColumn As Integer, argDate As Date) As Integer
    
    If argDate = Day(Now()) Then Return MikuruColor.BoxHighlight
    If argColumn = 0 Then Return MikuruColor.BoxSunday
    
    Return MikuruColor.BoxNormal
    
End

Private Sub paintHeader(argColumn As Integer)

    paintBox(argColumn, 0, IIf(argColumn = 0, MikuruColor.BoxSunday, MikuruColor.BoxHeader))
    paintText(MikuruDate.GetWeekDaySingleText(argColumn), argColumn, 0)
    
End

Private Function isVoid(argColumn As Integer, argDate As Integer) As Boolean
    
    If argDate = 0 And If argColumn <> MikuruDate.FirstWeekDay Then Return True
    If argDate = MikuruDate.LastDayOfMonth Then Return True
    
    Return False
    
End

Private Sub paintBody(argColumn As Integer, argRow As Integer, ByRef refDate As Integer)
    
    If isVoid(argColumn, refDate) Then
        paintBox(argColumn, argRow, MikuruColor.BoxVoid)
    Else
        Inc refDate
        paintBox(argColumn, argRow, getTileColor(argColumn, refDate))
        If refDate > MikuruDate.LastDayOfMonth Then Return
        paintText(CStr(refDate), argColumn, argRow)
    End If
    
End

Private Sub paintCalendar()
    
    Dim yukiColumn As Integer
    Dim yukiRow As Integer
    Dim yukiDate As Integer 

    For yukiRow = 0 To 6
        For yukiColumn = 0 To 6
            If yukiRow = 0 Then paintHeader(yukiColumn)
            If yukiRow > 0 Then paintBody(yukiColumn, yukiRow, ByRef yukiDate)
        Next
    Next
    
End

Public Sub _OnDrawingAreaRefresh()
    
    Paint.Font.Size = Me._$ux.FontSizeL
    Paint.Font.Bold = True
    paintCalendar()
    
End
