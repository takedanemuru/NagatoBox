' Gambas class file

Create Static

Private Sub getExecElement(argDesktopFile As DesktopFile, argPath As String) As String
    
    Dim yukiPath As String = MikuruXml.ReplaceEscapes(argPath)
    Dim yukiExec As String = Split(argDesktopFile.Exec, " ", "", True)[0] & " " & Quote(yukiPath) 
    Dim yukiLabel As String = Quote(argDesktopFile.Name)
    
    Return Subst(File.Load("Text/MenuItemTemplate"), yukiLabel, yukiExec)

End

Private Sub getApplications(argFilePath As String) As String
    
    Dim yukiOutput As String
    Dim yukiDesktopFile As DesktopFile
    
    For Each yukiDesktopFile In MikuruDesktopFile.GetSorted(argFilePath)
        yukiOutput &= getExecElement(yukiDesktopFile, argFilePath)
    Next
    
    Return yukiOutput
    
End

Public Sub Get(argFilePath As String) As String
    
    Dim yukiOutput As String = getApplications(argFilePath)
    
    If yukiOutput = "" Then yukiOutput = "<item label=application not found/>"
    
    Return Subst(File.Load("Text/PipeMenuTemplateFile"), argFilePath, yukiOutput)
    
End
