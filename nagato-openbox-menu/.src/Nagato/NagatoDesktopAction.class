' Gambas class file

Property Read Ready As Boolean
Property Read Xml As String

Private $id As String
Private $name As String
Private $exec As String

Public Sub _new(argId As String)
    
    $id = argId
    
End

Public Sub SetName(argName As String)
    
    If Not $id Then Return
    
    $name = Replace(argName, "Name=", "")
    
End

Public Sub SetExec(argExec As String)
    
    If Not $id Then Return

    $exec = Replace(argExec, "Exec=", "")
    
End

Private Function Ready_Read() As Boolean

    If Not $name Then Return False
    If Not $exec Then Return False
    
    Return True

End

Private Function Xml_Read() As String

    Dim yukiXml As String = File.Load("Text/MenuItemTemplate")

    Return Subst(yukiXml, Quote$($name), $exec)

End
