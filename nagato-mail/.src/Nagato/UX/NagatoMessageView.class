' Gambas class file

Private $tabstrip As TabStrip
Private $started As Boolean = False

Private Sub setTab()
    
    If $started Then
        Inc $tabstrip.Count
    Else
        $started = True
    End If
    
    $tabstrip.Index = $tabstrip.Count - 1
    
End


Public Sub SetMessage(argIndex As Integer)
    
    Dim yukiMessage As MimeMessage = NagatoPop3[argIndex]
    Dim yukiObject As Object
    
    setTab()
    $tabstrip.Text = yukiMessage.Subject
    
    Select Case yukiMessage.Body.ContentType
        Case "multipart/alternative"
            yukiObject = New NagatoMessageAlternative(yukiMessage.Body, $tabstrip)
        Case "text/html"
            yukiObject = New NagatoMessageHtml(yukiMessage.Body, $tabstrip)
        Case "text/plain"
            yukiObject = New NagatoMessageText(yukiMessage.Body, $tabstrip)
    End Select
    
End

Public Sub _new(argContainer As Container)
    
    $tabstrip = New TabStrip(argContainer)
    $tabstrip.Arrangement = Arrange.Fill
    $tabstrip.Expand = True
    
End
