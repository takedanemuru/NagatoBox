' Gambas class file

Private $observer As Observer
Private $messageTray As NagatoMessageTray
Private $messageView As NagatoMessageView

Public Sub _new()
    
    $messageTray = New NagatoMessageTray(VSplit1) As "MessageTray"
    $messageView = New NagatoMessageView(VSplit1)
    $observer = New Observer(NagatoPop3) As "Asakura"
    NagatoPop3.Connect()
    
End

Public Sub Form_Open()
    
    Application.MainWindow = Me
    
End

Public Sub SetSubjects()
    
    $messageTray.SetAll()
    
End

Public Sub Asakura_MessageCount(argCount As Integer)
    
    Debug argCount
    
    $messageTray.SetAll()
    
End

Public Sub MessageTray_Activate(argIndex As Integer)

    $messageView.SetMessage(argIndex)

End
