' Gambas class file

Create Static

Property FeedLines As Collection

Private $settings As New Settings

Public Sub AddFeed(argTitle As String, argUrl As String)
    
    Dim yukiCollection As Collection = Me.FeedLines.Copy()
    
    If yukiCollection.Exist(argTitle) Then Return
    
    yukiCollection.Add(argUrl, argTitle)
    Me.FeedLines = yukiCollection
    
    Print "YUKI.N > New RSS feed successfully saved."
    
End

Public Sub RemoveFeed(argUrl As String)
    
    Dim yukiCollection As Collection = Me.FeedLines.Copy()
    
    If yukiCollection.Exist(argUrl) Then
        yukiCollection.Remove(argUrl)
        Me.FeedLines = yukiCollection
        Print "YUKI.N > RSS Feed successfully unregistered."
    Else
        Print "YUKI.N > Url hasn't been registered."
    End If
    
End

Private Function FeedLines_Read() As Collection

    Return $settings["rss/feed_lines", NagatoRssFeedLines.GetDefault()]

End

Private Sub FeedLines_Write(Value As Collection)

    $settings["rss/feed_lines"] = Value
    $settings.Save()

End
