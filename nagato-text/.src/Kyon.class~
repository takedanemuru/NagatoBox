' Gambas class file

Private $changed As Boolean = False
Private $currentPath As String = ""

'
'   Event handlers
'

Public Sub _new()

End

Public Sub Form_Open()

    NagatoSettings.LoadFormSettings(Me)

End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub MainTextArea_Change()

    $changed = True

End

Public Sub QuitMenu_Click()

    If $changed Then
        Select Case Message.Question(("Change is not saved"), ("Cancel"), ("Close without saving"), ("Save"))
            Case 1
                Debug "Cancel"
            Case 2
                Debug "Close without saving"
                Me.Close()
            Case 3
                Debug "Save"
                If $currentPath = "" Then
                    Dialog.Title = ("Save file")
                    Dialog.Path = User.Home
                    If Dialog.SaveFile() Then Return
                    File.Save(Dialog.Path, MainTextArea.Text)
                Else
                    File.Save($currentPath, MainTextArea.Text)
                Endif
                Me.Close()
        End Select
    Else
        Me.Close()
    End If

End
