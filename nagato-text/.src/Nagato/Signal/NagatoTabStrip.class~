' Gambas class file

Inherits NagatoMenuSignal

Private $tabStrip As TabStrip
Private $textPads As New NagatoTextPad[]
Private $observer As Observer
Private $searchAndReplace As Observer

Public Sub NewTab(Optional argPath As String = "")
    
    Dim yukiTextPad As NagatoTextPad
    
    Inc $tabStrip.Count
    $tabStrip.Index = $tabStrip.Count - 1

    Raise Signal(MikuruSignal.FileNewPath, [argPath])
    yukiTextPad = New NagatoTextPad($tabStrip, argPath) As "TextPad"
    
    $textPads.Add(yukiTextPad)
    
End

Public Sub SearchAndReplace_Query(argType As String, argQuery As Variant[])
    
    If $tabStrip.Index = 0 Then Return
    
    $textPads[$tabStrip.Index - 1].Search(argType, argValues)
    
End

Public Sub _new(argTabStrip As TabStrip)
    
    $tabStrip = argTabStrip
    $observer = New Observer($tabStrip) As "Asakura"
    $searchAndReplace = New Observer(NagatoSearchAndReplacementSignal) As "SearchAndReplace"
    
End

Public Sub TextPad_Signal(argSignal As Integer, argValue As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.ViewNewTab
            Me.NewTab()
        Case MikuruSignal.ViewNewTabWithPath
            Me.NewTab(argValue[0])
        Case MikuruSignal.FileNewPath
            Raise Signal(MikuruSignal.FileNewPath, argValue)
    End Select
    
End

Public Sub Asakura_Close(argIndex As Integer)

    If argIndex <> 0 Then $textPads.Remove(argIndex - 1)
    MikuruTabStrip.Delete($tabStrip, argIndex)
    
End
