' Gambas class file

Inherits NagatoMenuSignal

Property Text As String

Private $textArea As TextArea
Private $searchAndReplace As NagatoTextAreaSearchAndReplace

Public Sub Search(argTag As String, argValues As Variant[])
    
    $searchAndReplace.Search(argTag, argValues)
    
End

Public Sub _new(argContainer As Container)
    
    $textArea = New TextArea(argContainer) As "TextArea"
    
    With $textArea
        .Expand = True
        .SetFocus()
    End With
    
    $searchAndReplace = New NagatoTextAreaSearchAndReplace($textArea)
    
End

Public Sub TextArea_KeyPress()
    
    If Key.Control Then
        If Key.Code = Key["t"] Then Raise Signal(MikuruSignal.ViewNewTab, [""])
        If Key.Code = Key["s"] Then Raise Signal(MikuruSignal.FileSave, [""])
        If Key.Code = Key["f"] Then Raise Signal(MikuruSignal.EditSearch, [""])
        If Key.Code = Key["r"] Then HaruhiReplacement.Show()
    End If
    
End

Public Sub TextArea_Change()
    
    Raise Signal(MikuruSignal.EditChange, [""])
    
End

Private Function Text_Read() As String

    Return $textArea.Text

End

Private Sub Text_Write(Value As String)

    $textArea.Text = Value

End
