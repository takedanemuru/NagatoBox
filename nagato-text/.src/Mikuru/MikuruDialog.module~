' Gambas module file

Property Read TextFilePath As String

Private $textFilePath As String = ""

Public Function SelectTextFile() As Boolean
    
    Dialog.Title = ("Open text file")
    Dialog.Path = User.Home
    Dialog.Filter = ["*txt", ("Text file"), "*", "Any file"]
    
    If Not Dialog.OpenFile(False) Then
        $textFilePath = Dialog.Path
        Return False
    Else
        $textFilePath = ""
        Return True
    Endif
    
End

Public Function SaveTextFile() As Boolean
    
    Dialog.Title = ("Save text file")
    Dialog.Path = MikuruSafePath.Get(User.Home &/ "your_text.txt")
    Dialog.Filter = ["*txt", ("Text file"), "*", "Any file"]
    
    If Not Dialog.SaveFile() Then
        $textFilePath = Dialog.Path
        Return False
    Else
        $textFilePath = ""
        Return True
    Endif
    
End

Private Function TextFilePath_Read() As String

    Return $textFilePath

End
