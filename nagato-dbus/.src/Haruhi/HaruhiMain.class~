' Gambas class file

Private $menuBar As NagatoMenuBar
Private $listSystem As NagatoDBusListSystem
Private $listSession As NagatoDBusListSession

Public Sub Form_Open()

    $menuBar = New NagatoMenuBar(MenuHBox) As "MenuBar"

    NagatoSettings.LoadFormSettings(Me)
    Application.MainWindow = Me

    $listSession = New NagatoDBusListSession(SessionList)
    $listSystem = New NagatoDBusListSystem(SystemList)

End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub DBusList_Click()

    Dim yukiNode As NagatoNode
    
    Me.TreeView1.Clear()
    MikuruGDBus.Mode = IIf(Last.Tag = 0, MikuruGDBus.ModeSession, MikuruGDBus.ModeSystem)
    yukiNode = New NagatoNode(Last.Key, "", "/")

End

' Public Sub SessionList_Click()
' 
'     Dim yukiNode As NagatoNode
'     
'     Me.TreeView1.Clear()
'     MikuruGDBus.Mode = MikuruGDBus.ModeSession
'     yukiNode = New NagatoNode(SessionList.Key, "", "/")
' 
' End
' 
' Public Sub SystemList_Click()
' 
'     Dim yukiNode As NagatoNode
'     
'     Me.TreeView1.Clear()
'     MikuruGDBus.Mode = MikuruGDBus.ModeSystem
'     yukiNode = New NagatoNode(SystemList.Key, "", "/")
' 
' End

Public Sub MenuBar_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.DBusRefresh
            TreeView1.Clear()
            $listSession.Refresh()
            $listSystem.Refresh()
    End Select
    
End
