' Gambas class file

Inherits NagatoUxItemGridView

Property Read CurrentTitle As String

Private Enum ColumnIcon, ColumnTitle

Private Sub initializeColumns()
    
    With Me._$gridView.Columns
        .Count = 2
        .[ColumnIcon].W = Me._$gridView.Rows.H
        .[ColumnTitle].Title = ("Title")
    End With
    
End

Public Sub _Initialize(argContainer As Container)
    
    Me._InitializeGridView(argContainer)
    initializeColumns()
    
End

Public Sub Set(argCollection As Collection)
    
    Dim yukiTitle As String
    
    For Each yukiTitle In argCollection
        Inc Me._$gridView.Rows.Count
        Me._$gridView[Me._$gridView.Rows.Max, ColumnTitle].Text = argCollection.Key
        If Odd(Me._$gridView.Rows.Max) Then Me._SetBackGround()
    Next
    
End

Private Sub request()
    
    Me._SetIcon(ColumnIcon, Me._$gridView.Row, "music")
    
    Raise Signal(MikuruSignal.RequestPlay, Null)
    
End

Public Sub GridView_DblClick()
    
    If Me._$gridView.Row >= 0 Then request() ' GridView returns -1 when header is clicked.
    
End

Public Sub GridView_Menu()
    
    Dim yukiMenu As New NagatoContextMenuGridView(HaruhiMain) As "ContextMenu"
    
    yukiMenu.PopUp()
    
End

Public Sub ContextMenu_Signal(argSignal As Integer, argValues As Variant[])
    
    If argSignal = MikuruSignal.RequestPlay Then
        request()
    Else
        Raise Signal(argSignal, Null)
    End If
    
End

Private Function CurrentTitle_Read() As String

    Return Me._$gridView[Me._$gridView.Row, ColumnTitle].Text

End
