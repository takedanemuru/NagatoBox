' Gambas class file

Create Static

Property LastDirectory As String

Private $settings As New Settings

Public Sub LoadFormSettings(argForm As Form)
    
    With argForm
        .X = $settings["form/x", argForm.X]
        .Y = $settings["form/y", argForm.Y]
    End With
    
End

Public Sub SaveFormSettings(argForm As Form)
    
    With argForm
        $settings["form/x"] = argForm.X
        $settings["form/y"] = argForm.Y
    End With
    
End

Private Function LastDirectory_Read() As String

    Return $settings["history/last_directory", User.Home] 

End

Private Sub LastDirectory_Write(Value As String)

    $settings["history/last_directory"] = Value
    $settings.Save()

End
