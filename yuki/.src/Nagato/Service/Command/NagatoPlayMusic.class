' Gambas class file

Create Static

Private $player As MediaPlayer 
Private $paths As New NagatoMusicPaths
Private $observer As Observer

Private Sub endlessEight()
    
    Do
        MikuruDialog.Show("YUKI.N > type [stop] to stop music, press [ENTER] key to continue.")
        Break
    Loop
    
End

Public Sub _new()
    
    $player = New MediaPlayer As "Player"
    $observer = New Observer($player) As "Asakura"
    $player.Pause()
    
End

Public Sub Next()
    
    Print "YUKI.N > Next tune is... " & File.BaseName($paths.NextPath) 
    If $paths.Count = 0 Then Return
    $paths.Next()
    Me.PlayCurrentPath()
    
End

Public Sub Stop()
    
    Try $player.Stop()
    
End

Public Sub PlayCurrentPath()
    
    $player.Pause()
    $player.URL = Media.URL($paths.CurrentPath)
    Try $player.Play()
    endlessEight()

End

Public Sub Play2(argCurrentDirectory As String, argPaths As String[])
    
    $paths.SetNew(argCurrentDirectory, argPaths)
    If $paths.Count > 0 Then PlayCurrentPath()
    
End

Public Sub Asakura_End()
    
    Wait 1
    
    Me.Next()
    
End
