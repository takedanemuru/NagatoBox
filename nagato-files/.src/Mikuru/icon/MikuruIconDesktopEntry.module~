' Gambas module file

Public Function Get(argPath As String, argIconSize) As Picture
    
    Dim yukiDesktopFile As New DesktopFile(argPath)
    Dim yukiIcon As Image
    
    If Exist(yukiDesktopFile.Icon) Then
        yukiIcon = Image.Load(yukiDesktopFile.Icon)
        If IconSize > Max(yukiIcon.H, yukiIcon.W) Then
            Return yukiIcon.Picture
        Else
            Return yukiIcon.Stretch(argIconSize, argIconSize).Picture
        End If
    Else
        Return yukiDesktopFile.GetIcon(argIconSize).Picture
    End If
    
End
