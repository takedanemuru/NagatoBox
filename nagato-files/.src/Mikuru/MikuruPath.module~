' Gambas module file

Public Function GetSafePathName(argPath As String) As String
    
    Dim yukiCount As Integer 
    Dim yukiPath As String
    
    If Not Exist(argPath) Then Return argPath
    
    Do
         Inc yukiCount
         yukiPath = Subst$("&1(&2)", argPath, yukiCount)
         If Not Exist(yukiPath) Then Return yukiPath
    Loop
    
End

Public Sub GetChildrenFile(argDirectory As String, argShowHidden As Boolean) As String[]
    
     Dim yukiPaths As String[]
     Dim yukiPattern As String = IIf(argShowHidden, "*", "[^.]*")
     
     yukiPaths = Dir(argDirectory, yukiPattern, gb.File).Sort(gb.IgnoreCase + gb.Natural)
    
    Return yukiPaths
    
End

Public Sub GetChildrenDirectory(argDirectory As String, argShowHidden As Boolean) As String[]
    
     Dim yukiPaths As String[]
     Dim yukiPattern As String = IIf(argShowHidden, "*", "[^.]*")
     
     yukiPaths = Dir(argDirectory, yukiPattern, gb.Directory).Sort(gb.IgnoreCase + gb.Natural)
    
    Return yukiPaths
    
End

Public Function UrlToPath(argUrl As String) As String
    
    If String.InStr(argUrl, " ") > 0 Then argUrl = String.Left(argUrl, String.InStr(argUrl, " ") - 1)
    argUrl = Replace$(argUrl, "file://", "")
    argUrl = URL.Decode(argUrl)
    
    Return argUrl
    
End

Private Function uriEncode(argSource As String) As String
    
    Dim yukiLine As String
    Dim yukiResult As String
    
    For Each yukiLine In Split(argSource, "/", "", True)
        yukiResult &= ("/" & URL.Encode(yukiLine))
    Next
    
    Return yukiResult
    
End

Public Function PathToUri(argPath As String) As String
    
    Dim yukiPath As String
    Dim yukiResult As String
    
    yukiPath = Replace(yukiPath, " ", "NagatoSpaceEncodeFlag")
    yukiResult &= ("file://" & uriEncode(yukiPath) & gb.CrLf)
    yukiResult = Replace(yukiResult, "NagatoSpaceEncodeFlag", "%20")
    
    Return yukiResult
    
End
