' Gambas module file

Private Sub activateDesktop()
    
    If Not NagatoDBus.DesktopActivated() Then
        HaruhiDesktop.Show()
    Else
        Message(("YUKI.N > nagato-desktop has been activated."), ("OK"))
    End If
    
End

Private Sub setIconTheme()
    
    Dim yukiOutput As String
    Dim yukiProxy As DBusProxy 
    
    If DBus.Session.Applications.Exist("org.gambas.nagato-session") Then
        yukiProxy = DBus["org.gambas.nagato-session"]["/org/nagato/session", "org.gambas.nagato.session.nagatointerface"]
        Application.Theme = yukiProxy.IconTheme
        Stock.Refresh()
    Else If Application.Theme = "?" Then
        Shell "cat ~/.config/gtk-3.0/settings.ini | grep gtk-icon-theme-name" To yukiOutput
        Application.Theme = Replace$(Replace(yukiOutput, "gtk-icon-theme-name=", ""), "\n", "")
    End If
    
End

Public Sub Main()

    ' this call activate NagatoDBSymbol, so do not delete.
    If NagatoDBSymbol.Ready Then Print "YUKI.N > Now we are going to activate nagato-files..." 
    
    NagatoArguments.Parsing()
    setIconTheme()
    
    'Only For Testing
    activateDesktop()
    'HaruhiXdgConfig.ShowDialog()
    
     NagatoClipBoard.Activate()
    
    ' If NagatoArguments.DesktopIcons Then
    '     activateDesktop()
    ' Else If NagatoArguments.XdgUserDirs Then
    '     HaruhiXdgConfig.Show()
    ' Else If NagatoArguments.OpenTrashBin Then
    '     HaruhiMain.Show()
    '     TFEI.SetNewTrashBin()
    ' Else
    '     HaruhiMain.Show()
    ' End If

End
