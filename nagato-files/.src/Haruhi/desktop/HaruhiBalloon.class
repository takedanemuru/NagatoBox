' Gambas class file

Private Sub setForm(argText As String)
    
    Dim yukiTextW As Integer = Max(Me.Font.RichTextWidth(argText), 30 * MikuruUx.Grid)
    Dim yukiTextH As Integer = Me.Font.RichTextHeight(argText, yukiTextW) 
    Dim yukiBaseImage As Image = MikuruBalloonImage.Get(argText)
    
    Paint.Begin(yukiBaseImage)
        Paint.Brush = Paint.Color(Color.White)
        Paint.Font = Me.Font
        Paint.DrawRichText(argText, MikuruUx.Grid, MikuruUx.Grid, yukiTextW, yukiTextH, Align.TopLeft)
        Paint.Fill()
    Paint.End()
    
    MikuruWindow.AdjustWindowToImage(Me, yukiBaseImage)
    
End

Public Sub SetText(argText As String, Optional argPriority As Integer)
    
    MikuruWindow.EnsureVisible(Me)
    setForm(argText)
    
End

Public Sub Form_Open()
    
    Me.X = 120
    Me.Y = 30
    
End

Public Sub Form_DblClick()
    
    Me.Close()
    
End
