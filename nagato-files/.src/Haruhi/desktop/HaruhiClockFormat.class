' Gambas class file

Public Enum ResponseCancel, ResponseApply

Private $sampleDate As Date

Public Sub Form_Open()
    
    Dim yukiImage As Image = Image.Load("pictures/yukichan_21.jpg").Stretch(Me.W, Me.H)
    
    Me.Picture = yukiImage.Picture
    Me.Text = ("Clock format")
    $sampleDate = Now()
    CurrentLabel.Text = Format$($sampleDate, NagatoSettingsDesktop.ClockFormat)
    UserLabel.Text = ""
    UserInputBox.Text = NagatoSettingsDesktop.ClockFormat
    
    Me.Center()
    
End


Public Sub UserInputBox_Change()

    UserLabel.Text = Format$($sampleDate, UserInputBox.Text)

End

Public Sub CancelButton_Click()

    Me.Close(Me.ResponseCancel)

End

Public Sub ApplyButton_Click()

    NagatoSettingsDesktop.ClockFormat = UserInputBox.Text

    Me.Close(Me.ResponseApply)

End
