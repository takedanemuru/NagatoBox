' Gambas class file

Private $persona As NagatoPersona

Public Sub _new()
    
    $persona = New NagatoPersona(Me)
    
End

Public Sub Fortune()
    
    MikuruWindow.EnsureVisible(Me)

    HaruhiBalloon.SetText(MikuruFortune.Get())
    HaruhiBalloon.X = Me.X
    
End

Public Sub Notify(argSummary As String, argBody As String, argUrgency As Integer)
    
    'Sound.Load("sound/negative-warning.wav").Play()
    Sound.Load("sound/effect-notify.wav").Play()
    
    MikuruWindow.EnsureVisible(Me)
    
    HaruhiBalloon.SetText(argSummary & "<br>" & argBody)
    HaruhiBalloon.X = Me.X
    
End

Public Sub SetText(argText As String)
    
    MikuruWindow.EnsureVisible(Me)
    
    HaruhiBalloon.SetText(argText)
    HaruhiBalloon.X = Me.X
    
End

Public Sub Welcome()
    
    Sound.Load("sound/notification2.wav").Play()
    MikuruWindow.EnsureVisible(Me)
    
    HaruhiPersona.SetText(Subst$(("YUKI.N > Welcome back, &1"), System.User.Name))
    HaruhiBalloon.X = Me.X
    
End

Public Sub Form_Open()
    
    $persona.Activate()
    
    Me.X = 50
    
End

Public Sub Form_DblClick()
    
    HaruhiBalloon.Close()
    
    Me.Close()
    
End
