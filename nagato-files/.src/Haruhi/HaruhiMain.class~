' Gambas class file

Private $leftPane As NagatoLeftPane
Private $rightPane As NagatoRightPane
Private $mainPane As NagatoMainPane
Private $observer As Observer

Public Sub SetMainTabStrip(argTitle As String, argPicture As Picture)
    
    $mainPane.SetMainTabStrip(argTitle, argPicture)
    
End

Public Sub SetNewDirectory(argDirectory As String)
    
    $mainPane.SetNewDirectory(argDirectory)
    
End

Public Sub SetSearch(argRecursive As Boolean)
    
    $leftPane.SetSearch()
    
End

Public Sub Form_Open()
    
    $leftPane = New NagatoLeftPane(LeftPanel) As "LeftPane"
    $mainPane = New NagatoMainPane(MainTabStrip) As "MainPane"
    $rightPane = New NagatoRightPane(RightPanel) As "RightPane"
    
    $mainPane.SetInitialPath(NagatoArguments.StartupPath)
    
    Application.MainWindow = Me
    NagatoSettings.LoadFormSettings(Me)
    
    $observer = New Observer(NagatoSettings) As "Asakura"
    
End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
    Quit 0
    
End

Public Sub LeftPane_Signal(argSignal As Integer, argValues As Variant[])
    
    If argSignal = MikuruSignal.LeftSearch Then $mainPane.SearchQuery(argValues[0], argValues[1])
    If argSignal = MikuruSignal.LeftRefresh Then $mainPane.Refresh()
    
End

Public Sub MainPane_ShowProperty(argPath As String)
    
    $rightPane.SetProperty(argPath)
    
End

Public Sub MainPane_AppQuit()
    
    Me.Close()
    
End

Public Sub Asakura_ShowHiddenChanged()
    
    $leftPane.RefreshTreeView()
    
End
