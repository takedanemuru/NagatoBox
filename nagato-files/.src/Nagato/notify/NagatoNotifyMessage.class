' Gambas class file

Private $priority As Integer
Private $messageStrings As NagatoNotifyMessageStrings
Private $timer As New Timer As "Timer"

Event Dequeued

Public Sub Cancel()
    
    $timer.Enabled = False
    Raise Dequeued
    
End

Public Sub Show()
    
    MikuruSound.Notify($priority)
    $timer.Start()
    
End

Public Sub _new(argPriority As Integer, argMessage As String[])
    
    $priority = argPriority
    $messageStrings = New NagatoNotifyMessageStrings(argMessage)
    
End

Public Sub Timer_Timer()
    
    If $messageStrings.Step() Then
        MikuruWindow.EnsureVisible(HaruhiPersona)
        HaruhiBalloon.SetText($messageStrings.CurrentMessage)
        HaruhiBalloon.X = HaruhiPersona.X
    Else
        Raise Dequeued
        $timer.Stop()
    Endif
    
End
