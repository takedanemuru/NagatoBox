' Gambas class file

Private $drawingArea As DrawingArea
Private $currentPath As String

Private Function drawPath(argY As Integer) As Integer
    
    Dim yukiRect As New Rect(16, argY, IconSize + 32, $drawingArea.Font.RichTextHeight(File.Name($currentPath)))
    
    Paint.Brush = Paint.Color(Color.White)
    Paint.RichText(File.Name($currentPath), yukiRect.X, yukiRect.Y, yukiRect.W, yukiRect.H, Align.Center)
    Paint.Fill()
    
    Return argY + yukiRect.H + 16
    
End

Private Function drawRichText(argY As Integer, argText As String) As Integer
    
    Dim yukiRect As New Rect(16, argY, IconSize + 32, $drawingArea.Font.RichTextHeight(argText))
    
    Paint.Brush = Paint.Color(Color.White)
    Paint.RichText(argText, yukiRect.X, yukiRect.Y, yukiRect.W, yukiRect.H, Align.Center)
    Paint.Fill()
    
    Return argY + yukiRect.H + 16
    
End

Public Function Paint(argY As Integer, argPath As String) As Integer
    
    Dim yukiY As Integer = argY
    
    $currentPath = argPath
    
    yukiY = drawPath(yukiY)
    yukiY = drawRichText(yukiY, DesktopMime.FromFile($currentPath).Type)
    
    Return yukiY
    
End

Public Sub _new(argDrawingArea As DrawingArea)
    
    $drawingArea = argDrawingArea
    
End
