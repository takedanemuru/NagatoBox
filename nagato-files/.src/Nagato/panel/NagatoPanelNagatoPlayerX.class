' Gambas class file

Inherits NagatoDesktopPanelContent

Private $buttons As NagatoPanelButtonsNagatoPlayerX
Private $access As NagatoDBusAccessNagatoPlayerX

Private Sub showContextMenu()
    
    Dim yukiMenu As New NagatoContextMenuPanelNagatoPlayerX(HaruhiDesktop, "") As "ContextMenu"
    
    yukiMenu.Popup()
    
End

Public Sub _Close()
    
    $buttons.Visible = False
    
End

Public Sub _Show()
    
    $buttons.Visible = True
    
End

Public Sub _Refresh()
    
    Me._$drawingArea.Refresh()
    
End

Public Sub _new(argContainer As Container, argExpand As Boolean)
    
    $access = New NagatoDBusAccessNagatoPlayerX
    
    Me._Initialize(argContainer, argExpand)
    
    $buttons = New NagatoPanelButtonsNagatoPlayerX(argContainer) As "Buttons"
    $buttons.Visible = False
    
End

Public Sub ClockDrawingArea_Draw()

    Paint.Begin(Me._$drawingArea)
        Paint.Brush = Paint.Color(NagatoSettingsPanel.Foreground)
        Paint.Font.Bold = True
        Paint.DrawText($access.GetText(), 0, 0, Me._$drawingArea.W, Me._$drawingArea.H, Align.Left)
        Paint.Fill()
    Paint.End()
    
End

Public Sub ClockDrawingArea_MouseDown()
    
    If Not $access.Enabled Then Return
    
    If Mouse.Right Then showContextMenu()
    
End

Public Sub ContextMenu_Signal(argTag As Integer, argValues As Variant[])
    
    If argValues[0] Then Return
    
    $access.Action(argTag)
    
End

Public Sub Buttons_MenuAction(argAction As Integer)
    
    $access.Action(argAction)
    
End
