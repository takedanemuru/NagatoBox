' Gambas class file

Private $drawingArea As DrawingArea
Private $observer As Observer

Private $text As String

Public Sub _new(argContainer As Container, argExpand As Boolean)
    
    $drawingArea = New DrawingArea(argContainer) As "ClockDrawingArea"
    
    With $drawingArea
        .Expand = argExpand
        .Background = Color.Orange
        .Width = 16
    End With
    
    $observer = New Observer(NagatoDesktopTimer) As "Asakura"
    
End

Public Sub ClockDrawingArea_Draw()

    Paint.Begin($drawingArea)
        Paint.Brush = Paint.Color(Color.White)
        Paint.Font.Bold = True
        Paint.RichText($text, 0, 0, $drawingArea.W, $drawingArea.H, Align.Center)
        Paint.Fill()
    Paint.End()
    
End

Public Sub Asakura_Timer()
    
    $text = Format$(Now(), NagatoSettingsPanel.ClockFormat)
    $drawingArea.W = Max(HaruhiMain.Font.RichTextWidth($text) + 32, $drawingArea.W)
    
    $drawingArea.Refresh()
    
End
