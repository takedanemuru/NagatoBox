' Gambas class file

Inherits NagatoDesktopPanelContent

Private $windows As NagatoDesktopWindows

Public Sub _Refresh()
    
    $windows.Refresh(Me._$drawingArea.W)
    
    Me._$drawingArea.Refresh()
    
End

Public Sub _new(argContainer As Container, argExpand As Boolean)
    
    $windows = New NagatoDesktopWindows
    
    Me._Initialize(argContainer, argExpand)
    
End

Public Sub ClockDrawingArea_Draw()

    Dim yukiCount As Integer
    Dim yukiText As String

    Paint.Begin(Me._$drawingArea)
        Paint.Font.Bold = True
        For yukiCount = 0 To $windows.Max
            Paint.Brush = Paint.Color(Color.White)
            yukiText = MikuruCollapsedText.Get($windows[yukiCount].Name, Paint.Font, $windows.Width - 32)
            Try Paint.DrawImage($windows[yukiCount].Icon.Stretch(16, 16), $windows.Width * yukiCount, 4)
            Paint.RichText(yukiText, $windows.Width * yukiCount + 24, 0, $windows.Width, Me._$drawingArea.H, Align.Left)
            Paint.Fill()
        Next
    Paint.End()
    
End

Public Sub ClockDrawingArea_MouseDown()
    
    Dim yukiIndex As Integer = Mouse.X Div $windows.Width
    
    Try Desktop.Current = $windows[yukiIndex].Desktop
    Try $windows[yukiIndex].Activate()
    
End
