' Gambas class file

Property Read Width As Integer
Property Read Max As Integer

Private $totalWidth As Integer
Private $windows As New DesktopWindow[]

Private Sub reset()
    
    Dim yukiDesktopWindow As DesktopWindow
    
    $windows.Clear()
    
    For Each yukiDesktopWindow In Desktop.Windows
        If yukiDesktopWindow.SkipTaskbar Then Continue
        If yukiDesktopWindow.Id = HaruhiDesktop.Id Then Continue
        $windows.Add(yukiDesktopWindow)
    Next
    
End

Public Sub Refresh(argTotalWidth As Integer)
    
    $totalWidth = argTotalWidth
    
    Desktop.Windows.Refresh()
    reset()
    
End

Public Sub _get(argIndex As Integer) As DesktopWindow
    
    Return $windows[argIndex]
    
End

Private Function Width_Read() As Integer

    If $windows.Count = 0 Then Return $totalWidth

    Return $totalWidth / $windows.Count

End

Private Function Max_Read() As Integer

    Return $windows.Max

End
