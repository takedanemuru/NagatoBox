' Gambas class file

Private $drawingArea As DrawingArea
Private $observer As Observer

Public Sub _new(argContainer As Container, argExpand As Boolean)
    
    $drawingArea = New DrawingArea(argContainer) As "ClockDrawingArea"
    
    With $drawingArea
        .Expand = argExpand
        .Background = Color.Orange
        .Width = 200
    End With
    
    $observer = New Observer(HaruhiDesktop) As "Asakura"
    
End

Public Sub ClockDrawingArea_Draw()

    Dim yukiCount As Integer

    Paint.Begin($drawingArea)
        For yukiCount = 0 To Desktop.Count - 1
            Paint.Brush = Paint.Color(IIf(Desktop.Current = yukiCount, Color.Yellow, Color.White))
            Paint.Rectangle(22 * yukiCount + 2, 2, 20, 20)
            Paint.Fill()
            Paint.Brush = Paint.Color(Color.Orange)
            Paint.Text(yukiCount + 1, 22 * yukiCount + 2, 2, 20, 20, Align.Center)
            Paint.Fill()
        Next
    Paint.End()
    
End

Public Sub ClockDrawingArea_MouseDown()
    
    Dim yukiMenu As NagatoContextMenuPanelPager
    
    If Mouse.Left Then
        Desktop.Current = (Mouse.X Div 22)
        $drawingArea.Refresh()
    Else If Mouse.Right Then
        yukiMenu = New NagatoContextMenuPanelPager(HaruhiDesktop, "")
        yukiMenu.Popup()
    End If
    
End

Public Sub Asakura_Timer()
    
    $drawingArea.W = 22 * Desktop.Count + 4
    $drawingArea.Refresh()
    
Catch
    Debug Error.Text
    Return
    
End
