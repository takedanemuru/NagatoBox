' Gambas class file

Public Enum ModeNone, ModeTasksTypeA, ModeTasksTypeB, ModeTaskManager, ModeRss, ModePlayer

Private $miniTask As NagatoPanelMiniTask
Private $tasksTypeA As NagatoPanelTasksTypeA
Private $tasksTypeB As NagatoPanelTasksTypeB
Private $systemMonitor As NagatoPanelSystemMonitor
Private $rssFeeder As NagatoPanelRssFeeder
Private $player As NagatoPanelNagatoPlayerX

Private Function getMiniTaskVisible(argMode As Integer) As Boolean
    
    If argMode = Me.ModeTasksTypeA Then Return False
    If argMode = Me.ModeTasksTypeB Then Return False

    Return True
    
End

Public Sub ChangeMode(argMode As Integer)
    
    $miniTask.Visible = getMiniTaskVisible(argMode)
    $tasksTypeA.Visible = (argMode = Me.ModeTasksTypeA)
    $tasksTypeB.Visible = (argMode = Me.ModeTasksTypeB)
    $systemMonitor.Visible = (argMode = Me.ModeTaskManager)
    $rssFeeder.Visible = (argMode = Me.ModeRss)
    $player.Visible = (argMode = Me.ModePlayer)
    
End

Public Sub ForceReload()
    
    $tasksTypeA.ForceReload()
    $tasksTypeB.ForceReload()
    $systemMonitor.ForceReload()
    $rssFeeder.ForceReload()
    $player.ForceReload()
    
End

Public Sub _new(argContainer As Container)
    
    $miniTask = New NagatoPanelMiniTask(argContainer)
    $tasksTypeA = New NagatoPanelTasksTypeA(argContainer, True)
    $tasksTypeB = New NagatoPanelTasksTypeB(argContainer, True)
    $systemMonitor = New NagatoPanelSystemMonitor(argContainer, True)
    $rssFeeder = New NagatoPanelRssFeeder(argContainer, True)
    $player = New NagatoPanelNagatoPlayerX(argContainer, True)
    
    Me.ChangeMode(Me.ModeTasksTypeA)
    
End
