' Gambas class file

Inherits NagatoPanelContentCore

Create Private

Property Visible As Boolean

Public _$drawingArea As DrawingArea
Public _$observer As Observer

Public Sub _InitializeObserver()
    
    Me._$observer = New Observer(HaruhiDesktop) As "Asakura"
    
End

Public Sub _Initialize(argContainer As Container, argExpand As Boolean)
    
    Me._$drawingArea = New DrawingArea(argContainer) As "ClockDrawingArea"
    
    With Me._$drawingArea
        .Expand = argExpand
        .Background = NagatoSettingsPanel.Background
        If Not argExpand Then .Width = 100
        If argExpand Then .Visible = False
    End With
    
    Me._InitializeObserver()
    
End

Public Sub _Refresh() ' virtual interface
    
    
    
End

Public Sub _Close()
    
    
    
End

Public Sub _Show()
    
    
    
End

Public Sub _RefreshAll()
    
    If Not Me._$drawingArea.Visible Then Return
    
    Me._Refresh()
    
Catch
    Debug Error.Text
    Return
    
End

Public Sub Asakura_Timer()
    
    Me._RefreshAll()
    
End

Public Sub ForceReload()
    
    Me._$drawingArea.Background = NagatoSettingsPanel.Background
    
    Me._RefreshAll()
    
End

Private Function Visible_Read() As Boolean

    Return Me._$drawingArea.Visible

Catch
    Return False
    
End

Private Sub Visible_Write(Value As Boolean)

    If Me._$drawingArea.Visible = Value Then Return
    Me._$drawingArea.Visible = Value
    If Not Value Then Me._Close()
    If Value Then Me._Show()

End
