' Gambas class file

Create Private

Property Visible As Boolean

Public _$drawingArea As DrawingArea
Public _$observer As Observer

Public Sub _Initialize(argContainer As Container, argExpand As Boolean)
    
    Me._$drawingArea = New DrawingArea(argContainer) As "ClockDrawingArea"
    
    With Me._$drawingArea
        .Expand = argExpand
        .Background = NagatoSettingsPanel.Bacground
        If Not argExpand Then .Width = 200
        If argExpand Then .Visible = False
    End With
    
    Me._$observer = New Observer(HaruhiDesktop) As "Asakura"
    
End

Public Sub _Refresh() ' virtual interface
    
    
    
End

Public Sub _Close()
    
    
    
End

Public Sub _Show()
    
    
    
End

Public Sub Asakura_Timer()
    
    If Not Me._$drawingArea.Visible Then Return
    
    Me._Refresh()
    
Catch
    Debug Error.Text
    Return
    
End

Private Function Visible_Read() As Boolean

    Return Me._$drawingArea.Visible

End

Private Sub Visible_Write(Value As Boolean)

    If Me._$drawingArea.Visible <> Value Then
        Me._$drawingArea.Visible = Value
        If Not Value Then Me._Close()
        If Value Then Me._Show()
    End If

End
