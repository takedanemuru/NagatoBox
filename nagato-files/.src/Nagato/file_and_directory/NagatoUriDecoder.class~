' Gambas class file

Public Function GetConvertedUri(argSource As String) As String
    
    Dim yukiResult As String = URL.Decode(Replace$(argSource, "file://", ""))
    Dim yukiCount As Integer
    
    Do
        If Exist(yukiResult) Then Return yukiResult
        Inc yukiCount
        yukiResult = String.Left(yukiResult, String.Len(yukiResult) - 1)
        If yukiCount > 5 Then Return argSource
    Loop
    
End

Public Function UriEncode(argSource As String) As String
    
    Dim yukiLine As String
    Dim yukiResult As String
    
    For Each yukiLine In Split(argSource, "/", "", True)
        yukiResult &= ("/" & URL.Encode(yukiLine))
    Next
    
    Return yukiResult
    
End
