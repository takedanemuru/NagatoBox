' Gambas class file

Create Static

Private $uriDecoder As New NagatoUriDecoder

Public Function GetPaths(argData As String) As String[]
    
    Dim yukiLine As String
    Dim yukiDecodedUrl As String
    Dim yukiResult As New String[]
    
    ' each line of "text/uri-list" ends "\r\n"
    
    For Each yukiLine In Split(argData, "\n", "", True)
        If yukiLine = "" Then Continue
        yukiDecodedUrl = $uriDecoder.GetConvertedUri(yukiLine)
        If Exist(yukiDecodedUrl) Then yukiResult.Add(yukiDecodedUrl)
    Next
    
    Return yukiResult
    
End

Public Function GetUriList(argPaths As String[]) As String
    
    Dim yukiPath As String
    Dim yukiResult As String
    
    For Each yukiPath In argPaths
        If Exist(yukiPath) Then
            yukiPath = Replace(yukiPath, " ", "NagatoSpaceEncodeFlag")
            yukiResult &= ("file://" & $uriDecoder.UriEncode(yukiPath) & gb.CrLf)
            yukiResult = Replace(yukiResult, "NagatoSpaceEncodeFlag", "%20")
        Endif
    Next
    
    Return yukiResult
    
End

Public Function GetUriListCopy(argPaths As String[]) As String
    
    Dim yukiPath As String = "#nagato-files_mode=copy" & gb.CrLf
    Dim yukiResult As String
    
    For Each yukiPath In argPaths
        If Exist(yukiPath) Then
            yukiPath = Replace(yukiPath, " ", "NagatoSpaceEncodeFlag")
            yukiResult &= ("file://" & $uriDecoder.UriEncode(yukiPath) & gb.CrLf)
            yukiResult = Replace(yukiResult, "NagatoSpaceEncodeFlag", "%20")
        Endif
    Next
    
    Return yukiResult
    
End

Public Function GetUriListCut(argPaths As String[]) As String
    
    Dim yukiPath As String = "#nagato-files_mode=cut" & gb.CrLf
    Dim yukiResult As String
    
    For Each yukiPath In argPaths
        If Exist(yukiPath) Then
            yukiPath = Replace(yukiPath, " ", "NagatoSpaceEncodeFlag")
            yukiResult &= ("file://" & $uriDecoder.UriEncode(yukiPath) & gb.CrLf)
            yukiResult = Replace(yukiResult, "NagatoSpaceEncodeFlag", "%20")
        Endif
    Next
    
    Return yukiResult
    
End
