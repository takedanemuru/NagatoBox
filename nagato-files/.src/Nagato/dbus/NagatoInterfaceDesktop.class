' Gambas class file

Inherits DBusObject

Create Static

Property Read Ready As Boolean

Private $formName As String

Public Sub SetType(argType As String)
    
    $formName = argType
    
End

Public Sub Notify(argApp As String, argSummary As String, argBody As String, argUrgency As Integer)
    
    Select Case $formName
        Case "HaruhiDesktop"
            HaruhiDesktop.Notify(argApp, argSummary, argBody, argUrgency)
        Case "HaruhiDesktopSummerDress"
            HaruhiDesktopSummerDress.Notify(argApp, argSummary, argBody, argUrgency)
    End Select

End

Public Sub SetTextToPersona(argText As String) 
    
    Select Case $formName
        Case "HaruhiDesktop"
            HaruhiDesktop.SetText(argText)
        Case "HaruhiDesktopSummerDress"
            HaruhiDesktopSummerDress.SetText(argText)
    End Select

End

Public Sub Show() As Boolean
    
    Select Case $formName
        Case "HaruhiDesktop"
            Try HaruhiDesktop.Show()
        Case "HaruhiDesktopSummerDress"
            Try HaruhiDesktopSummerDress.Show()
    End Select
    
    If Not Error Then Return True
    
Finally
    Return False
    
End

Public Sub ReloadDesktopWallpaper() As Boolean
    
    Select Case $formName
        Case "HaruhiDesktop"
            HaruhiDesktop.RealodDesktopWallpaper()
        Case "HaruhiDesktopSummerDress"
            HaruhiDesktopSummerDress.RealodDesktopWallpaper()
    End Select
    
    Return True
    
Catch
    Return False
    
End

Private Function Ready_Read() As Boolean

    Select Case $formName
        Case "HaruhiDesktop"
            Return HaruhiDesktop.Ready
        Case "HaruhiDesktopSummerDress"
            Return HaruhiDesktopSummerDress.Ready
    End Select

End
