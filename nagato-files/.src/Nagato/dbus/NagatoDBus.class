' Gambas class file

Create Static

Property Read Proxy As DBusProxy

Public Const Service As String = "org.gambas.nagato.files"
Public Const ObjectPath As String = "/org/nagato/files"
Public Const Interface As String = "org.gambas.nagato.files.nagatointerfacedesktop"

Public Function DesktopActivated() As Boolean
    
    Try Debug DBus[Me.Service][Me.ObjectPath, Me.Interface].Ready
    
    If Not Error Then
        Return True
    Else
        Return False
    End If
    
End

Public Function IsUnique() As Boolean
    
    Return Not DBus.Session.Applications.Exist(Me.Service)
    
End

Public Sub Register()
    
    DBus.Session.Register(NagatoInterfaceDesktop, Me.ObjectPath)
    
End

Public Sub Unregister()
    
    DBus.Session.Unregister(NagatoInterfaceDesktop)
    
End

Private Function Proxy_Read() As DBusProxy

    Return DBus[Me.Service][Me.ObjectPath, Me.Interface]

End
