' Gambas class file

Private Const ServiceName As String = "org.gambas.nagato-player-x"
Private Const ObjectPath As String = "/org/nagato/player/x/property"
Private Const InterfaceName As String = "org.gambas.nagato.player.x.nagatodbusinterfaceproperty"

Private $proxy As DBusProxy

Public Sub Ensure()
    
    If Not Object.IsValid($proxy) Then $proxy = DBus[ServiceName][ObjectPath, InterfaceName]
    
End

Public Function GetCoverArtPath() As String
    
    Return $proxy.CoverArtPath
    
End

Public Function GetRate() As Float
    
    Return $proxy.ProgressInRate
    
End

Public Function GetTextTile() As String
    
    Return $proxy.Title
    
End

Public Sub GetTextProgress() As String
    
    Return $proxy.ProgressInText
    
End

Public Function GetCurrentPath() As String
    
    Return $proxy.CurrentPath
    
End

Public Sub GetTextMain() As String
    
    Dim yukiText As String 
    
    yukiText &= ($proxy.Title & Space$(4))
    yukiText &= ($proxy.Artist & Space$(4))
    yukiText &= ($proxy.Album & Space$(4))

    Return yukiText
    
End
