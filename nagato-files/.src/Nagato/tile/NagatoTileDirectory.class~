' Gambas class file

Inherits NagatoTile

Public _$baseColor As Integer = Color.Blue

Private Function getFolderDescription(argPath As String) As String
    
    Dim yukiFolders As String = Subst$("folder:&1", Dir(argPath, "*", gb.Directory).Count)
    Dim yukiFiles As String = Subst$("file:&1", Dir(argPath, "*", gb.File).Count)
    Dim yukiText As String = File.Name(argPath) & "<br>" & yukiFolders & " " & yukiFiles
    
    Return yukiText
    
End

Private Function getMode(argPath As String, argSelected As Boolean) As Integer
    
    If Not Access(argPath, gb.Write) And If Not argSelected Then
        Return NagatoTile.ModeSelected
    Else If NagatoClipBoard.PathsCut.Exist(argPath)
        Return NagatoTile.ModeCut
    Else If NagatoClipBoard.PathCopy.Exist(argPath) Then
        Return NagatoTile.ModeCopied
    Else If argSelected Then
        Return NagatoTile.ModeSelected
    Else
        Return NagatoTile.ModeNull
    Endif
    
End

Public Sub _call(argPath As String, argSelected As Boolean) As Picture
    
    Dim yukiBaseImage As Image = Me._GetBaseImage(argSelected)
    Dim yukiIcon As Picture = MikuruIcon.GetDirectory(argPath, Me.IconSize)
    Dim yukiDescription As String = getFolderDescription(argPath)
    Dim yukiMode As Integer = getMode(argPath, argSelected)
    Dim yukiTile As Picture = Me._GetTile2(yukiBaseImage, yukiIcon, yukiDescription, yukiMode)
    
    ' If Not Access(argPath, gb.Write) And If Not argSelected Then
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, getFolderDescription(argPath), NagatoTile.ModeReadOnly)
    ' Else If NagatoClipBoard.PathsCut.Exist(argPath)
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, getFolderDescription(argPath), NagatoTile.ModeCut)
    ' Else If NagatoClipBoard.PathCopy.Exist(argPath) Then
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, getFolderDescription(argPath), NagatoTile.ModeCopied)
    ' Else If argSelected Then
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, getFolderDescription(argPath), NagatoTile.ModeSelected)
    ' Else
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, getFolderDescription(argPath), NagatoTile.ModeNull)
    ' Endif
    
    Return Me._SetSymbol(yukiTile, argPath)
    
End
