' Gambas class file

Inherits NagatoTile

Public _$baseColor As Integer = Color.Violet

Private Function getName(argDesktopFile As DesktopFile) As String
    
    If argDesktopFile.Name Then
        Return argDesktopFile.Name
    Else
        Return File.Name(argDesktopFile.Path) & IIf(argDesktopFile.Hidden, " (hidden entry)", "")
    End If
    
End

Public Sub _call(argPath As String, argSelected As Boolean) As Picture
    
    Dim yukiBaseImage As Image = Me._GetBaseImage(argSelected)
    Dim yukiDesktopFile As New DesktopFile(argPath)
    Dim yukiIcon As Picture = MikuruIconDesktopEntry[argPath, Me.IconSize]
    Dim yukiMode As Integer = MikuruTileMode(argPath, argSelected)
    
    Return Me._GetTile2(yukiBaseImage, yukiIcon, getName(yukiDesktopFile), yukiMode)
    
End
