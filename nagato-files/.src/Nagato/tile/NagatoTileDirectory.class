' Gambas class file

Inherits NagatoTile

Public _$baseColor As Integer = Color.Blue

Private Function getFolderDescription(argPath As String) As String
    
    Dim yukiText As String = Me._GetTextToFitHeight(File.Name(argPath))
    Dim yukiFolders As String = Subst$("folder:&1", Dir(argPath, "*", gb.Directory).Count)
    Dim yukiFiles As String = Subst$("file:&1", Dir(argPath, "*", gb.File).Count)
    
    Return yukiText & "<br>" & yukiFolders & " " & yukiFiles
    
End

Public Sub _call(argPath As String, argSelected As Boolean) As Picture
    
    Dim yukiBaseImage As Image = Me._GetBaseImage(argSelected)
    Dim yukiIcon As Picture = MikuruIcon.GetDirectory(argPath, Me.IconSize)
    Dim yukiDescription As String = getFolderDescription(argPath)
    Dim yukiMode As Integer = MikuruTileMode(argPath, argSelected)
    Dim yukiTile As Picture = Me._GetTile2(yukiBaseImage, yukiIcon, yukiDescription, yukiMode)
    
    Return Me._SetSymbol(yukiTile, argPath)
    
End
