' Gambas class file

Inherits NagatoTile

Public _$baseColor As Integer = Color.Magenta

Private Function getMode(argPath As String, argSelected As Boolean) As Integer
    
    If Not Access(argPath, gb.Write) And If Not argSelected Then
        Return NagatoTile.ModeSelected
    Else If NagatoClipBoard.PathsCut.Exist(argPath)
        Return NagatoTile.ModeCut
    Else If NagatoClipBoard.PathCopy.Exist(argPath) Then
        Return NagatoTile.ModeCopied
    Else If argSelected Then
        Return NagatoTile.ModeSelected
    Else
        Return NagatoTile.ModeNull
    Endif
    
End

Public Sub _call(argPath As String, argSelected As Boolean) As Picture
    
    Dim yukiBaseImage As Image = Me._GetBaseImage(argSelected)
    Dim yukiIcon As Picture = Desktop.GetFileIcon(argPath, Me.IconSize)
    Dim yukiMode As Integer = getMode(argPath, argSelected)
    Dim yukiTile As Picture = Me._GetTile2(yukiBaseImage, yukiIcon, File.Name(argPath), yukiMode)
    
    ' If Not Access(argPath, gb.Write) And If Not argSelected Then
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, File.Name(argPath), NagatoTile.ModeReadOnly)
    ' Else If NagatoClipBoard.PathsCut.Exist(argPath) Then
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, File.Name(argPath), NagatoTile.ModeCut)
    ' Else If NagatoClipBoard.PathCopy.Exist(argPath) Then
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, File.Name(argPath), NagatoTile.ModeCopied)
    ' Else If argSelected Then
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, File.Name(argPath), NagatoTile.ModeSelected)
    ' Else
    '     yukiTile = Me._GetTile2(yukiBaseImage, yukiIcon, File.Name(argPath), NagatoTile.ModeNull)
    ' Endif
    
    Return Me._SetSymbol(yukiTile, argPath)
    
End
