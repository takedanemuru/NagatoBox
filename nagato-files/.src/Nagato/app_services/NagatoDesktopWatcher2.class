' Gambas class file

Create Static

Property Read Max As Integer
Property Read Count As Integer

Private $watcher As DesktopWatcher
Private $windows As New NagatoDesktopWindowsTypeC
Private $titles As New NagatoWindowsTitleChecker As "Titles"

Event Changed
Event VirtualDesktopChanged
Event ListChanged

Public Sub _new()
    
    $watcher = New DesktopWatcher(True) As "DesktopWatcher"
    
End

Public Sub _get(argIndex As Integer) As DesktopWindow
    
    Return $windows[argIndex]
    
End

Public Sub DesktopWatcher_ActiveWindow()
    
    Raise Changed
    
End

Public Sub DesktopWatcher_Windows()
    
    $windows.Refresh()
    
    Raise Changed
    Raise ListChanged
    
End

Public Sub DesktopWatcher_Change()
    
    Raise Changed
    Raise VirtualDesktopChanged
    
End

Public Sub Titles_Changed()
    
    Raise Changed
    Raise ListChanged
    
End

Public Sub DesktopWatcher_Count()
    
    Raise Changed
    Raise VirtualDesktopChanged
    
End

Private Function Max_Read() As Integer

    Return $windows.Max

End

Private Function Count_Read() As Integer

    Return $windows.Max + 1

End
