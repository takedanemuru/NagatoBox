' Gambas class file

Inherits NagatoSettingsCore

Property ClockFormat As String
Property ShowHidden As Boolean
Property SortBy As Integer
Property SortAscent As Boolean
Property ShowClock As Boolean
Property ShowTrashBin As Boolean

Event Changed

Private Function ClockFormat_Read() As String

    Return Me._$settings["clock/format", ("hh:nn:ss")]

End

Private Sub ClockFormat_Write(Value As String)

    Me._$settings["clock/format"] = Value
    Me._$settings.Save()

End

Private Function ShowHidden_Read() As Boolean

    Return Me._$settings["desktop_view/hidden", False]

End

Private Sub ShowHidden_Write(Value As Boolean)

    If Value <> Me._$settings["desktop_view/hidden"] Then
        Me._$settings["desktop_view/hidden"] = Value
        Me._$settings.Save()
        Raise Changed
    End If
    
End

Private Function SortBy_Read() As Integer

    Return Me._$settings["desktop_sort/by", MikuruSort.ByName]

End

Private Sub SortBy_Write(Value As Integer)

    Me._$settings["desktop_sort/by"] = Value

End

Private Function SortAscent_Read() As Boolean

    Return Me._$settings["desktop_sort/ascent", True] 

End

Private Sub SortAscent_Write(Value As Boolean)

    Me._$settings["desktop_sort/ascent"] = Value
    Me._$settings.Save()

End

Private Function ShowClock_Read() As Boolean
    
    Return Me._$settings["desktop_view/show_clock", True]
    
End

Private Sub ShowClock_Write(Value As Boolean)

    If Value <> Me._$settings["desktop_view/show_clock"] Then
        Me._$settings["desktop_view/show_clock"] = Value
        Me._$settings.Save()
        Raise Changed
    End If

End

Private Function ShowTrashBin_Read() As Boolean

    Return Me._$settings["desktop_view/show_trash_bin", True]

End

Private Sub ShowTrashBin_Write(Value As Boolean)

    If Value <> Me._$settings["desktop_view/show_trash_bin"]
        Me._$settings["desktop_view/show_trash_bin"] = Value
        Me._$settings.Save()
        Raise Changed
    End If

End
