' Gambas class file

Inherits NagatoSubMenu

Private Sub addCreateFileMenu()
    
    Dim yukiMenu As Menu
    Dim yukiPath As String
    
    For Each yukiPath In Dir(NagatoXdg.UserDirs.Templates, "*", gb.File)
        yukiMenu = New Menu(Me._$rootMenu) As "CreateFileMenu"
        yukiMenu.Text = yukiPath
        yukiMenu.Tag = NagatoXdg.UserDirs.Templates &/ yukiPath
        yukiMenu.Picture = MikuruIconMono.GetFromPath(NagatoXdg.UserDirs.Templates &/ yukiPath)
    Next
    
End

Public Sub _InitializeParentMenu(argRootMenu As Menu) ' override
    
    Me._$rootMenu = New Menu(argRootMenu)
    
    With Me._$rootMenu
        .Text = ("Create")
        .Picture = MikuruIcon.Get("magic-wand")
    End With
    
End

Public Sub _InitializeMenu() ' override
    
    Me._AddMenu(("New Directory"), NagatoMenuPipe.DirCreate, "folder")
    Me._AddMenu("", 0) ' add dummy menu
    addCreateFileMenu()
    
End

Public Sub MenuItem_Click()
    
    Raise MenuEvent(Last.Tag)
    
End

Public Sub CreateFileMenu_Click()
    
   Raise MenuEventWithArg(NagatoMenuPipe.FileCreate, Last.Tag)
    
End
