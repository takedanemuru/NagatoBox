' Gambas class file

Inherits NagatoFilerEvent

Private Sub callRequestNewSelection(argNewSelection As String[])
    
    Raise Request(NagatoFilerEvent.RequestNewSelection, [argNewSelection])
    
End

Public Sub _call(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case NagatoObject.ViewChangeThumbnail
            HaruhiThumbnailSelector.SetThumbnails(argValues[0])
            Raise Request(NagatoFilerEvent.RequestRefresh, [Me._$log.Current])
        Case NagatoObject.ViewNewTab
            TFEI.AddNewDirectory(User.Home)
        Case NagatoObject.ViewForceReload
            NagatoDBThumbnailer.ForceCleanUp(Me._$log.Current)
            Raise Request(NagatoFilerEvent.RequestRefresh, [Me._$log.Current])
        Case NagatoObject.ViewSelectAll
            callRequestNewSelection(MikuruDirectory.GetAll(Me._$log.Current))
        Case NagatoObject.ViewUnselectAll
            Clipboard.Clear()
            Raise Request(NagatoFilerEvent.RequestSurfaceRefresh, [Me._$log.Current])
        Case NagatoObject.ViewInvertSelection
            callRequestNewSelection(MikuruDirectory.GetInverted(Me._$log.Current, Me._$userInput.Selection))
        Case NagatoObject.ViewOpenTerminalHere
            NagatoOpen.OpenTerminal(Me._$log.Current)
        Case NagatoObject.ViewFiltering
            Raise Request(NagatoFilerEvent.RequestFiltering, argValues)
        Case NagatoObject.ViewContextMenu
            NagatoFilerContextMenu.PopUp(Me._$log.Current)
    End Select
    
End
