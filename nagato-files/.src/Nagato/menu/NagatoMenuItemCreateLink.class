' Gambas class file

Inherits NagatoMenuItem

Public Sub _InitializeItem() 'override
    
    Dim yukiMenu As New Menu(Me._$parentMenu) As "MenuItem"
    
    With yukiMenu
        .Text = ("Create Symbolic Link")
        .Picture = MikuruIcon.Get("link")
        .Tag = Me._$path
    End With
    
End

Public Sub MenuItem_Click()
    
    Dialog.Path = File.Dir(Me._$path) &/ File.Name(Me._$path)
    Dialog.Title = ("Create Symbolic Link")
    
    If Dialog.SaveFile() Then Return
    
    Try Link Me._$path To MikuruPath.GetSafePathName(Dialog.Path)
    
End
