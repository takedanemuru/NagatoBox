' Gambas class file

Inherits NagatoPaths

Property Read LastPath As String

Private $lastPath As String = ""

Event Changed

Public Sub ClearAll()
    
    Me._$paths.Clear()
    
    Raise Changed
    
End

Public Sub PushPath(argPath As String)
    
    If Not Me._$paths.Exist(argPath) Then
        Me._$paths.Add(argPath)
        $lastPath = argPath
    End If
    
    Raise Changed
    
End

Public Sub RemovePath(argPath As String)
    
    Try Me._$paths.Remove(Me._$paths.Find(argPath))
    
    Raise Changed
    
End

Public Sub Toggle(argPath As String)
    
    If Me._$paths.Exist(argPath) Then
        Me.RemovePath(argPath)
    Else
        Me.PushPath(argPath)
    End If
    
End

Public Sub ClearWithoutLastSelection()
    
    Dim yukiPath As String
    
    For Each yukiPath In Me._$paths
        If yukiPath <> $lastPath Then Me._$paths.Remove(Me._$paths.Find(yukiPath))
    Next
    
End

Public Sub Push(argPath As String, argLeftClick As Boolean)
    
    If argLeftClick Then 
        Me.Toggle(argPath)
    Else
        Me.PushPath(argPath)
    End If

End

Public Sub SetPaths(argPaths As String[])
    
    Dim yukiFirstPath As String = Me.Reset(argPaths)
    
    If argPaths.Exist($lastPath) Then $lastPath = yukiFirstPath
    
End

Private Function LastPath_Read() As String

    Return $lastPath

End
