' Gambas class file

Inherits NagatoObject

Private Sub popUpRootDesktopMenu()
    
    Dim yukiMenu As New NagatoContextMenuRootDesktop(HaruhiDesktop, "") As "TFEI"
    
    yukiMenu.Popup()
    
End

Private Sub popUpSpecialTileMenu(argPath As String)
    
    Dim yukiContextMenu As Object
    
    If argPath = NagatoDesktopSpecialKey.Clock Then
        yukiContextMenu = New NagatoContextMenuDesktopClock(HaruhiDesktop, "")
    Else If argPath = NagatoDesktopSpecialKey.TrashBin Then
        yukiContextMenu = New NagatoContextMenuDesktopTrashBin(HaruhiDesktop, "")
    Else
        Return
    End If
    
    yukiContextMenu.PopUp()
    
End

Private Sub popUpContextMenu(argPath As String)
    
    Dim yukiMenu As New NagatoIconviewContextMenu2(HaruhiDesktop, argPath) As "TFEI"
    
    yukiMenu.Popup()
    
End

Public Sub PopUp(argPath As String, argRoot As Boolean, argCount As Integer)
    
    If argPath = "NOTFOUND" Then 
        Return
    Else If argRoot Then 
        popUpRootDesktopMenu()
    Else If NagatoDesktopSpecialKey.IsSpecialKey(argPath) Then
        popUpSpecialTileMenu(argPath)
    Else If argPath = "" Or If argCount = 0 Then 
        popUpRootDesktopMenu()
    Else If Exist(argPath) Then 
        popUpContextMenu(argPath)
    End If
    
End
