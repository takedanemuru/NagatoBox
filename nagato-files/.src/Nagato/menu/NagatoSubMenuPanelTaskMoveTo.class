' Gambas class file

Inherits NagatoSubMenu

Event MoveTo(argDesktopIndex As Integer)

Public Sub _InitializeParentMenu(argRootMenu As Menu) ' override
    
    Me._$rootMenu = New Menu(argRootMenu)
    
    With Me._$rootMenu
        .Text = ("Move To...")
        .Picture = MikuruIcon.Get("navigation-right")
    End With
    
End

Public Sub _InitializeMenu() ' this method is protected/virtual. MUST be overridden
    
    Dim yukiDesktopIndex As Integer
    Dim yukiIcon As String
    
    For yukiDesktopIndex = 0 To Desktop.Count - 1
        yukiIcon = IIf(Me._$path = yukiDesktopIndex, "button-check", Null)
        Me._AddMenu(yukiDesktopIndex + 1, yukiDesktopIndex, yukiIcon)
    Next
    
End

Public Sub MenuItem_Click()
    
    Raise MoveTo(Last.Tag)
    
End
