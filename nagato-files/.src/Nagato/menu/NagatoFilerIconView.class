' Gambas class file

Inherits NagatoIconViewHandler

Private $searchResult As New String[]
Private $surface As NagatoIconViewSurface
Private $actions As NagatoIconViewAction

Public Sub ResetIcon(argPath As String, argSelected As Boolean)
    
    $surface.ResetIcon(argPath, argSelected)
    
End

Public Sub Refresh(argDirectory As String, argSelection As String[], argLastSelected As String)
    
    $surface.RefreshIconView(argDirectory, argSelection, argLastSelected)
    
End

Public Sub RefreshWithSearchResult(argSearchResult As String[], argSelection As String[])
    
    $searchResult = argSearchResult.Copy()
    $surface.RefreshWithSearchResult(argSearchResult, argSelection)
    
End

Public Sub RefreshKeepQuery(argDirectory As String, argSelection As String[], argLastSelected As String)
    
    If $searchResult.Count > 0 Then
        Me.RefreshWithSearchResult($searchResult, argSelection)
    Else
        Me.Refresh(argDirectory, argSelection, argLastSelected)
    End If
    
End

Public Sub Ensure(argPath As String)
    
    $surface.Ensure(argPath)
    
End

Public Sub ClearSelection(argSelection As String[])
    
    $surface.ClearSelection(argSelection)
    
End

Public Sub ShowLostDirectory()
    
    $surface.ShowLostDirectory()
    
End

Public Function Delete(argPath As String) As Boolean
    
    Return $actions.Delete(argPath)
    
End

Public Function Exist(argPath As String) As Boolean
    
    Return $actions.Exist(argPath)
    
End

Public Sub _OptionalOnInitialize()
    
    $surface = New NagatoIconViewSurface(Me._$iconView)
    $actions = New NagatoIconViewAction(Me._$iconView)
    
End
