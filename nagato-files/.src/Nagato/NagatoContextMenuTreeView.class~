' Gambas class file

Inherits NagatoContextMenu

Public Enum ContextNone, ContextExecute, ContextRefresh

Private Sub addExecuteMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "ExecuteMenu"
    
    With yukiMenu
        .Text = ("Execute")
        .Picture = MikuruIcon.Get("gear")
        .Tag = Last.Key
    End With
    
End

Private Sub addOpenWithMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    Dim yukiOpenWithMenu As New NagatoOpenWithApplicationMenu(yukiMenu, Last.Key)
    
    With yukiMenu
        .Text = ("Open with ...")
    End With
    
End

Public Sub _AddChildMenus()
    
    
    
    If DesktopMime.FromFile(Last.Key).Type = "application/x-desktop" Then
        addExecuteMenu()
        Me._AddContextMenu("", Me.ContextNone)
    End If
    
    If Not IsDir(Last.Key) Then addOpenWithMenu()
    
    Me._AddContextMenu(("Refresh"), Me.ContextRefresh, MikuruIcon.Get("button-rotate-cw"))
    
End

Public Sub ExecuteMenu_Click()
    
    Dim yukiDesktop As New DesktopFile(Last.Tag)
    
    yukiDesktop.Run("")
    
End
