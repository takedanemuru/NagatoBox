' Gambas class file

Property Read Text As String

Private $observer As NagatoDirectoryObserver

Event Changed

Private Function getRichText() As String
    
    If NagatoTrash.Count = 0 Then
        Return "Empty"
    Else If NagatoTrash.Count = 1 Then
        Return Subst$("1 item<br>&1", NagatoTrash.Size)
    Else
        Return Subst$("&1 items<br>&2", NagatoTrash.Count, NagatoTrash.Size)
    End If
    
End

Public Sub Stop()
    
    Object.Lock($observer)
    
End

Public Sub _new()
    
    $observer = New NagatoDirectoryObserver As "DirectoryObserver"

    With $observer
        .Directory = MikuruTrashPath.Files
    End With
    
End

Public Sub DirectoryObserver_Deleted(argFileName As String)
    
    Raise Changed
    
End

Public Sub DirectoryObserver_Modefied(argFileName As String)
    
    Raise Changed
    
End

Private Function Text_Read() As String

    Return getRichText()

End
