' Gambas class file

Inherits NagatoDesktopHandler

Private $iconView As IconView
Private $clock As NagatoDesktopTile2Clock
Private $rss As NagatoDesktopTile2RssFeeds
Private $systemMonitor As NagatoDesktopTile2SystemMonitor
Private $weather As NagatoDesktopTile2Weather
Private $trashBin As NagatoDesktopTile2TrashBin
'Private $music As NagatoDesktopTile2Music

Private Sub setIcon(argDirectory As String, argSelection As String[], argType As Integer)
    
    Dim yukiPath As String

    For Each yukiPath In NagatoSortDesktop.Get(argDirectory, argType)
        If Not Access(yukiPath, gb.Read) Then Continue
        $iconView.Add(yukiPath, "", MikuruTile(yukiPath, argSelection.Exist(yukiPath)))
    Next
    
End

Private Sub refreshTiles(argSelectedPaths As String[])
    
    $clock.Reload()
    $systemMonitor.Reload()
    $rss.Reload()
    $weather.Reload()
    '$music.Reload()
    
    setIcon(Desktop.Path, argSelectedPaths, gb.Directory)
    setIcon(Desktop.Path, argSelectedPaths, gb.File)
    
    $trashBin.Reload()
    
End

Public Sub Refresh(argSelectedPaths As String[])
    
    $iconView.Clear()
    refreshTiles(argSelectedPaths)
    $iconView.Refresh()

End

Public Sub _new(argIconView As IconView)
    
    $iconView = argIconView
    $clock = New NagatoDesktopTile2Clock($iconView)
    $systemMonitor = New NagatoDesktopTile2SystemMonitor($iconView)
    $rss = New NagatoDesktopTile2RssFeeds($iconView)
    $weather = New NagatoDesktopTile2Weather($iconView)
    $trashBin = New NagatoDesktopTile2TrashBin($iconView)
    '$music = New NagatoDesktopTile2Music($iconView)
    
    refreshTiles([""])
        
End
