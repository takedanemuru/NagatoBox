' Gambas class file

Private $timer As Timer

Event Timer

Public Sub _new()
    
    $timer = New Timer As "Timer"
    
    With $timer
        .Delay = 1000
        .Enabled = True
    End With
    
End

Public Sub Timer_Timer()
    
    If $timer.Delay = 10 Then
        If 20 > CFloat(Format$(Now(), "u")) Then $timer.Delay = 1000
        Return 
    Endif
     
     Raise Timer
    
End




