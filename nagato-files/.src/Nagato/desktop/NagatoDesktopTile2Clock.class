' Gambas class file

Inherits NagatoDesktopTile2

Private Const FontSize As Integer = 16

Public Function getIcon() As Picture
    
    Dim yukiImage As Image = MikuruTileBaseImage[Color.Orange, 128]
    Dim yukiText As String = Format$(Now(), NagatoSettingsDesktopTile.ClockFormat)
    
    Paint.Begin(yukiImage)
        Paint.Brush = Paint.Color(Color.White)
        Paint.Font.Size = FontSize
        Paint.DrawRichText(yukiText, 0, 0, NagatoSettingsTile.Size, NagatoSettingsTile.Size, Align.Center)
        Paint.Fill()
    Paint.End()
    
    Return yukiImage.Picture
    
End

Public Sub _onReload()
    
    Try Me._$iconView.Remove(NagatoDesktopSpecialKey.Clock)
    
    If Not NagatoSettingsDesktopTile.ShowClock Then Return
    
    Me._$iconView.Add(NagatoDesktopSpecialKey.Clock, "", getIcon())
    
End

Public Sub _OnTimer() ' override
    
    If Not Me._$iconView.Exist(NagatoDesktopSpecialKey.Clock) Then Return
    
    Try Me._$iconView[NagatoDesktopSpecialKey.Clock].Picture = getIcon()
    
End
