' Gambas class file

Inherits NagatoDesktopTile

Private Const FontSize As Integer = 16

Private $iconView As IconView
Private $observer As Observer

Public Function getIcon() As Picture
    
    Dim yukiImage As Image = MikuruTileBaseImage[Color.Orange, 128]
    Dim yukiText As String = Format$(Now(), NagatoSettingsDesktopTile.ClockFormat)
    
    Paint.Begin(yukiImage)
        Paint.Brush = Paint.Color(Color.White)
        Paint.Font.Size = FontSize
        Paint.RichText(yukiText, 0, 0, NagatoSettingsTile.Size, NagatoSettingsTile.Size, Align.Center)
        Paint.Fill()
    Paint.End()
    
    Return yukiImage.Picture
    
End

Public Sub Stop()
    
    
    
End

Public Sub _new(argIconView As IconView)
    
    $iconView = argIconView
    $iconView.Add(NagatoDesktopSpecialKey.Clock, "", getIcon())
    
    $observer = New Observer(HaruhiDesktop) As "Asakura"
    
End

Public Sub Asakura_Timer()
    
    If Not $iconView.Exist(NagatoDesktopSpecialKey.Clock) Then Return
    
    $iconView[NagatoDesktopSpecialKey.Clock].Picture = getIcon()
    
End
