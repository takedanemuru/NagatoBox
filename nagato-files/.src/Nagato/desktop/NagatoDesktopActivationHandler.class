' Gambas class file

Inherits NagatoDesktopHandler

Private $iconView As IconView
Private $observer As Observer

Private Sub activate(argPath As String)
    
    If IsDir(argPath) Then
        Try Shell Subst$("nagato-files &1", Quote$(argPath))
    Else If MikuruMimeType.IsDesktopEntry(argPath) Then
        MikuruDesktopEntry.Execute(argPath)
    Else ' for files
        MikuruFile.Exec(argPath)
    End If
    
End

Public Sub _new(argIconView As IconView)
    
    $iconView = argIconView
    $observer = New Observer($iconView) As "Asakura"
    
End

Public Sub Asakura_Activate()
    
    If $iconView.FindAt(Mouse.ScreenX, Mouse.ScreenY) Then
        $iconView.Current.Selected = False
    Else If Exist($iconView.Key) Then
        activate($iconView.Key)
    End If
    
End
