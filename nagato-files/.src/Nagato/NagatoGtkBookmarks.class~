' Gambas class file

Inherits NagatoLeftPaneContent

Public Const SeparatorKey As String = "NagatoSeparatorKey"
Public Const TrashBinKey As String = "NagatoTrashBinKey"

Private $initializer As NagatoGtkBookmarksInitializer
Private $actionHandler As NagatoGtkBookmarksAction
Private $mouseHandler As NagatoGtkBookmarksMouse
Private $surfaceHandler As NagatoGtkBookmarksSurface
Private $observer As NagatoGtkBookmarksObserver 

Public Sub _new(argContainer As Container)
    
    $initializer = New NagatoGtkBookmarksInitializer(argContainer)
    $surfaceHandler = New NagatoGtkBookmarksSurface($initializer.ListView)
    $surfaceHandler.AddBookmarkItems()
    Me._$mainContent = $initializer.ListView
    $actionHandler = New NagatoGtkBookmarksAction($initializer.ListView)
    $mouseHandler = New NagatoGtkBookmarksMouse($initializer.ListView) As "MouseHandler"
    $observer = New NagatoGtkBookmarksObserver As "BookmarksObserver"
    
End

Public Sub BookmarksObserver_Change()
    
    $surfaceHandler.Refresh()
    
End

Public Sub MouseHandler_Signal(argEvent As Integer, argValues As Variant[])
    
    If argValues[0] = "NagatoTrashBinKey" Then 
        HaruhiMain.SetNewTrashBin()
        Return
    End If
    
    With NagatoContextMenuGtkBookmarks
        If argEvent = .ContextOpen Then HaruhiMain.SetNewDirectory(argValues[0])
        If argEvent = .ContextOpenInNewTab Then HaruhiMain.AddNewDirectory(argValues[0])
        If argEvent = .ContextDelete Then Debug "delete" & argValues[0] 
    End With
    
End
