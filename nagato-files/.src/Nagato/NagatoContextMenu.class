' Gambas class file

Inherits NagatoMenuPipe

Public _$rootMenu As Menu
Public _$path As String

Public Sub _ClickAction()
    
    Raise MenuEventWithArg(Last.Tag, Me._$path)
    
End

Public Sub _AddContextMenu(argText As String, argTag As Integer, Optional argIcon As Picture)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "ContextMenu"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIcon Then .Picture = argIcon
    End With
    
End

Public Sub _AddContextMenu2(argText As String, argTag As Integer, argIcon As String, argEnable As Boolean)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "ContextMenu"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        .Picture = MikuruIcon.Get(argIcon)
        .Enabled = argEnable
    End With
    
End

Public Sub _SetOptionalVariant(argVariant As Variant)
    
    
    
End

Public Sub _AddChildMenus()
    
    'virtual
    
End

Public Sub Popup()
    
    Me._$rootMenu.Popup()
    
End

Public Sub _new(argForm As Form, argPath As String, Optional argOptionalVariant As Variant)
    
    Me._$rootMenu = New Menu(argForm)
    Me._$path = argPath
    If argOptionalVariant Then Me._SetOptionalVariant(argOptionalVariant)
    
    Me._AddChildMenus()
    
End

Public Sub ContextMenu_Click()
    
    Me._ClickAction()
    
End
