' Gambas class file

Inherits NagatoMenuPipe

Property Read Path As String

Private $pathBar As ButtonBox

Private Sub initializeButtonBox(argContainer As Container)
    
    $pathBar = New ButtonBox(argContainer) As "PathBar"
    
    With $pathBar
        .Expand = True
        .Picture = MikuruIcon.Get("button-rotate-ccw")
    End With
    
End

Private Sub isAccessable(argPath As String) As Boolean
    
    If Not Exist($pathBar.Text) Then Return False
    
    If Not Access($pathBar.Text) Then
        Message.Warning(("YUKI.N > Access forbidden."))
        Return False
    End If
    
    Return True
    
End

Public Sub SetPath(argPath As String)
    
    If Not Exist(argPath) Then Return
    
    Object.Lock($pathBar)
        $pathBar.Text = argPath
    Object.Unlock($pathBar)
    
End

Public Sub _new(argContainer As Container)
    
    initializeButtonBox(argContainer)
    
End

Public Sub PathBar_Activate()
    
    If Not isAccessable($pathBar.Text) Then Return
    
    Raise MenuEventWithArg(NagatoMenuPipe.PathNew, $pathBar.Text)
    
End

Public Sub PathBar_Click()
    
    PathBar_Activate()
    
End

Private Function Path_Read() As String

    Return $pathBar.Text

End
