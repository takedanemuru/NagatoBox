' Gambas class file

Private Const Command As String = "ffmpegthumbnailer -s 512 -t &1% -i &2 -o &3"

Private Function getThumbnailImageForDB(argImage As Image) As Picture
    
    Dim yukiRate As Float = Max(128 / argImage.H, 128 / argImage.W)

    Return argImage.Stretch(argImage.W * yukiRate, argImage.H * yukiRate).Picture
    
End

Public Sub Push(argSourcePath As String, argSelectedPath As String)
    
    Dim yukiNewThumbnail As Picture = getThumbnailImageForDB(Image.Load(argSelectedPath))
    
    NagatoDBThumbnailer.Delete(argSourcePath)
    NagatoDBThumbnailer.Push(argSourcePath, 128, yukiNewThumbnail)
    
End

Public Sub GenerateThumbnails(argWorkingDirectory As String, argPath As String)
    
    Dim yukiPosition As Float = Rnd(10)
    Dim yukiResult As String
    Dim yukiTargetPath As String
    
    Do
        yukiTargetPath = argWorkingDirectory &/ yukiPosition & ".png"
        Shell Subst$(Command, yukiPosition, Quote$(argPath), yukiTargetPath) To yukiResult
        Print yukiResult
        yukiPosition += 5
        If yukiPosition > 100 Then Break
    Loop
    
End
