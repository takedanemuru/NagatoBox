' Gambas class file

Inherits NagatoDefaultActionMenu

Private Function getCommand(argExec As String, argAsSuperUser As Boolean) As String
    
    Dim yukiReturn As String = IIf(argAsSuperUser, "gksu", "")
    Dim yukiCommand As String
    
    For Each yukiCommand In Split(argExec, " ", "")
        If yukiCommand Begins "%" Then Continue
        yukiReturn &= (" " & yukiCommand)
    Next
        
    Return yukiReturn
    
End

Public Sub _InitializeMenu(argRootMenu As Menu)
   
    Me._$menu = New Menu(argRootMenu) As "DesktopEntryMenu"
    
    With Me._$menu
        .Text = ("Execute")
        .Picture = MikuruIcon.Get("gear")
    End With
   
End

Public Sub DesktopEntryMenu_Click()
    
    Dim yukiDesktopFile As New DesktopFile(Me._$path)
    Dim yukiCommand As String = getCommand(yukiDesktopFile.Exec, False)
    
    Try Shell yukiCommand
    
End
