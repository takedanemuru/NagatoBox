' Gambas class file

Inherits NagatoSignal

Private $container As Container
Private $drawingArea As DrawingArea
Private $currentPath As String
Private $iconPainter As NagatoPainterIcon
Private $pathPainter As NagatoPainterPath
Private $propertyPainter As NagatoPainterProperty

Private Sub initializeContainer(argContainer As Container)
    
    $container = New VBox(argContainer)
    
    With $container
        .Expand = True
    End With
    
End

Private Sub initializeDrawingArea()
    
    $drawingArea = New DrawingArea($container) As "DrawingArea"
    
    With $drawingArea
        .Expand = True
        .Background = Color.Pink
        .Font.Bold = True
    End With
    
End

Public Sub SetProperty(argPath As String)
    
    If Exist(argPath) Then
        $currentPath = argPath
        $drawingArea.Refresh()
    End If

End

Public Sub _new(argContainer As Container)
    
    initializeContainer(argContainer)
    initializeDrawingArea()
    
    $iconPainter = New NagatoPainterIcon
    $pathPainter = New NagatoPainterPath($drawingArea)
    $propertyPainter = New NagatoPainterProperty($drawingArea)
    
End

' Private Function drawPath(argY As Integer) As Integer
'     
'     Dim yukiRect As New Rect(16, argY, IconSize + 32, $drawingArea.Font.RichTextHeight(File.Name($currentPath)))
'     
'     Paint.Brush = Paint.Color(Color.White)
'     Paint.RichText(File.Name($currentPath), yukiRect.X, yukiRect.Y, yukiRect.W, yukiRect.H, Align.Center)
'     Paint.Fill()
'     
'     Return argY + yukiRect.H + 16
'     
' End
' 
' Private Function drawRichText(argY As Integer, argText As String) As Integer
'     
'     Dim yukiRect As New Rect(16, argY, IconSize + 32, $drawingArea.Font.RichTextHeight(argText))
'     
'     Paint.Brush = Paint.Color(Color.White)
'     Paint.RichText(argText, yukiRect.X, yukiRect.Y, yukiRect.W, yukiRect.H, Align.Center)
'     Paint.Fill()
'     
'     Return argY + yukiRect.H + 16
'     
' End

Public Sub DrawingArea_Draw()
    
    Dim yukiY As Integer
    
    Paint.Begin($drawingArea)
        yukiY = $iconPainter.Paint($currentPath)
        yukiY = $pathPainter.Paint(yukiY, $currentPath)
        ' yukiY = drawPath(yukiY)
        ' yukiY = drawRichText(yukiY, DesktopMime.FromFile($currentPath).Type)
        $propertyPainter.Paint(yukiY, $currentPath)
    Paint.End()
    
Catch
    Debug Error.Text
    Try Paint.End()
    
End
