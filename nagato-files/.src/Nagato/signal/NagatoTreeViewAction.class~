' Gambas class file

Inherits NagatoTreeViewHandler

Event Expand(argKey As String)

Public Function getParentDirectories(argDirectory As String) As String[]
    
    Dim yukiDirectory As String = argDirectory
    Dim yukiResult As New String[]
    
    Do
        yukiDirectory = File.Dir(yukiDirectory)
        If yukiDirectory = "/" Then Break
        yukiResult.Add(yukiDirectory, 0)
        If yukiDirectory = User.Home Then Break
    Loop
    
    Return yukiResult
    
End

Public Sub ExpandHomeDirectory()
    
    Object.Lock(Me._$treeView)
        Me._$treeView[User.Home].Expanded = True
    Object.Unlock(Me._$treeView)
    
End

Public Sub ExpandDirectory(argDirectory As String)
    
    Dim yukiDirectory As String
    
    Object.Lock(Me._$treeView)
        For Each yukiDirectory In getParentDirectories(argDirectory)
            Debug yukiDirectory
            Try Me._$treeView[yukiDirectory].Expanded = True
        Next
    Object.Unlock(Me._$treeView)
    
End

Public Sub Asakura_Activate()
    
    If IsDir(Me._$treeView.Key) Then
        HaruhiMain.SetNewDirectory(Me._$treeView.Key)
    End If
    
End

Public Sub Asakura_Expand()
    
    If Me._$treeView.Exist(Me._$treeView.Key & "dummy") Then 
        Me._$treeView[Me._$treeView.Key & "dummy"].Delete()
        'Me._$treeViewSurface.SetDirectory(Me._$treeView.Key)
        Raise Expand(Me._$treeView.Key)
    End If
    
End
