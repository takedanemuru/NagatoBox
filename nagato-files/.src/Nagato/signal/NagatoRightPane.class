' Gambas class file

Inherits NagatoSignal

Private $container As Container
Private $switch As NagatoChmodSwitch
Private $audioPreview As NagatoAudioPreview
Private $propertyPainter As NagatoPropertyPainterFacade

Private Sub initializeContainer(argContainer As Container)
    
    $container = New VBox(argContainer)
    
    With $container
        .Expand = True
    End With
    
End

Public Sub SetProperty(argPath As String)
    
    If Exist(argPath) Then
        $propertyPainter.SetProperty(argPath)
        $switch.Set(argPath)
        $audioPreview.Set(argPath)
    End If

End

Public Sub SetTrashProperty(argTrashName As String)
    
    If Exist(argTrashName) Then
        $propertyPainter.SetTrashProperty(argTrashName)
    Endif
    
End

Public Sub _new(argContainer As Container)
    
    initializeContainer(argContainer)
    $propertyPainter = New NagatoPropertyPainterFacade($container, Color.Pink)
    $switch = New NagatoChmodSwitch($container) As "Switch"
    $audioPreview = New NagatoAudioPreview($container) As "AudioPreview"
    
End

Public Sub Switch_Changed()
    
    $propertyPainter.Refresh()
    
End
