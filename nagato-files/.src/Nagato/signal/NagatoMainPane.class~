' Gambas class file

Inherits NagatoSignal

Private $filersHandler As New NagatoFilersHandler As "FilersHandler"
Private $tabStripHandler As NagatoTabStripHandler
Private $observer As Observer

Event ShowProperty(argPath As String)
Event AppQuit

Private Sub addTab(Optional argPath As String = User.Home)
    
    $tabStripHandler.AddNewTab()
    $filersHandler.AddFiler($tabStripHandler.TabStrip, argPath)
    
End

Public Sub SetMainTabStrip(argTitle As String, argPicture As Picture)
    
    $tabStripHandler.SetTabTextAndPicture(argTitle, argPicture)
    
End

Public Sub SetNewDirectory(argDirectory As String)
    
    $filersHandler.SetNewDirectory($tabStripHandler.Index, argDirectory)
    
End

Public Sub SetNewTrashBin()
    
    $tabStripHandler.AddNewTab()
    $filersHandler.AddTrashBin($tabStripHandler.TabStrip)
    $tabStripHandler.SetTabTextAndPicture(("TrashBin"), MikuruIcon.Get("bin"))
    
End

Public Sub SetInitialPath(argPath As String)
    
    $filersHandler.SetInitialPath($tabStripHandler.TabStrip, argPath)
    $tabStripHandler.InitializeTabStrip()
    
End

Public Sub SearchQuery(argQuery As String, argRecursive As Boolean)
    
    $filersHandler.SearchQuery($tabStripHandler.Index, argQuery, argRecursive)
    
End

Public Sub Refresh()
    
    $filersHandler.Refresh($tabStripHandler.Index)
    
End

Public Sub _new(argTabStrip As TabStrip)
    
    $tabStripHandler = New NagatoTabStripHandler(argTabStrip)
    $observer = New Observer(argTabStrip) As "Asakura"
    
End

Public Sub Asakura_Close(argIndex As Integer)

    If $tabStripHandler.Count > 1 Then 
        $tabStripHandler.Delete(argIndex)
        $filersHandler.Remove(argIndex)
    End If

End

Public Sub FilersHandler_ShowProperty(argPath As String)
    
    Raise ShowProperty(argPath)
    
End

Public Sub FilersHandler_AddTab(argPath As String)
    
    addTab(argPath)
    
End

Public Sub FilersHandler_AppQuit()
    
    Raise AppQuit
    
End
