' Gambas class file

Inherits NagatoSignal

Private Const LabelHeight As Integer = 24

Private $vBox As VBox
Private $radioButtons As New RadioButton[]

Private Sub initializeVBox(argContainer As Container)
    
    $vBox = New VBox(argContainer)
    $vBox.Expand = True
    
End

Public Sub SetRadioButton(argTag As String, argText As String)
    
    Dim yukiRadioButton As New RadioButton($vBox) As "RadioButton"
    
    With yukiRadioButton
        .Text = argText
        .H = LabelHeight
        .NoTabFocus = True
        .Tag = argTag
    End With
    
    $radioButtons.Add(yukiRadioButton)
    
End

Public Sub SetPermission(argAuthTag As String)
    
    Dim yukiRadioButton As RadioButton
    
    For Each yukiRadioButton In $radioButtons
        If yukiRadioButton.Tag = argAuthTag Then yukiRadioButton.Value = True
    Next
    
End

Public Function GetAuthTag() As String
    
    Dim yukiRadioButton As RadioButton
    
    For Each yukiRadioButton In $radioButtons
        If yukiRadioButton.Value Then Return yukiRadioButton.Tag
    Next
    
    Return "-"
    
End

Public Sub _new(argContainer As Container, argColor As Integer)
    
    initializeVBox(argContainer)
    
End

Public Sub RadioButton_Click()
    
    Raise Signal(MikuruSignal.DialogChanged, Null)
    
End
