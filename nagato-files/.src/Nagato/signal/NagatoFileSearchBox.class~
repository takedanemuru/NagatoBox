' Gambas class file

Inherits NagatoFileSearchHandler

Private $searchBox As ButtonBox

Event Query(argQuery As String)

Public Sub _Initialize()
    
    $searchBox = New ButtonBox(Me._$container) As "QueryBox"
    
    With $searchBox
        .Expand = False
        .Height = 32
        .Picture = MikuruIcon.Get("search")
    End With
    
End

Public Sub SetFocus()
    
    $searchBox.SetFocus()
    
End

Public Sub QueryBox_Click()
    
    ' Dim yukiValues As New Variant[]
    ' 
    ' yukiValues.Add($searchBox.Text)
    ' 
    ' If $searchBox.Text <> "" Then Raise Signal(MikuruSignal.LeftSearch, yukiValues)
     
    If $searchBox.Text <> "" Then Raise Query($searchBox.Text) 
    
End

Public Sub QueryBox_Activate()
    
    Me.QueryBox_Click()
    
End
