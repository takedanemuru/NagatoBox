' Gambas class file

Inherits NagatoFileSearchHandler

Private $searchBox As ButtonBox

Event Query(argQuery As String)
Event Refresh

Public Sub _Initialize()
    
    $searchBox = New ButtonBox(Me._$container) As "QueryBox"
    
    With $searchBox
        .Expand = False
        .Height = Me.Height
        .Picture = MikuruIcon.Get("search")
    End With
    
End

Public Sub SetFocus()
    
    $searchBox.SetFocus()
    
End

Public Sub QueryBox_Click()
    
    Dim yukiArgs As New Variant[]
        Raise Query($searchBox.Text) 
    Else
        Raise Refresh
    End If
    
End

Public Sub QueryBox_Activate()
    
    Me.QueryBox_Click()
    
End
