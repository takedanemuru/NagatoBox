' Gambas class file

Inherits NagatoObject

Property Directory As String

Private $directory As String
Private $iconView As IconView
Private $selection As NagatoSelection

Private Sub setIcons(argType As Integer, Optional argQuery As String)
    
    Dim yukiPath As String
    Dim yukiFullPath As String
    
    For Each yukiPath In Dir(MikuruTrashPath.Files, "*", argType).Sort(gb.IgnoreCase)
        yukiFullPath = MikuruTrashPath.Files &/ yukiPath
        If Not Exist(yukiFullPath) Then Continue
        If argQuery And If (yukiPath Not Like "*" & argQuery & "*") Then Continue
        $iconView.Add(yukiFullPath, "", MikuruTile(yukiFullPath, $selection.Exist(yukiFullPath)))
    Next
    
End

Public Sub Filter(argQuery As String)
    
    $iconView.Clear()
    setIcons(gb.Directory, argQuery)
    setIcons(gb.File, argQuery)
    
End

Public Sub Refresh()
    
    $iconView.Clear()
    setIcons(gb.Directory)
    setIcons(gb.File)
    
End

Public Sub _new(argIconView As IconView, argSelection As NagatoSelection)
    
    $iconView = argIconView
    $selection = argSelection
    $directory = User.Home
    
End

Private Function Directory_Read() As String

    Return $directory

End

Private Sub Directory_Write(Value As String)

    $directory = Value

End
