' Gambas class file

Inherits NagatoSignal

Create Private

Public Const LabelHeight As Integer = 24

Public _$HBox As HBox
Public _$Label As Label
Public _$VBox As VBox
Public _$radioButtons As New RadioButton[]

Public Function _GetlabelText() As String ' virtual interface
    
    Return ""
    
End

Public Function _GetLabelCount() As Integer
    
    Return 2
    
End

Public Function _GetBackground() As Integer
    
    Return Color.White
    
End

Public Sub _InitializeHBox(argContainer As Container)
    
    Me._$HBox = New HBox(argContainer)
    
    With Me._$HBox
        .H = Me.LabelHeight * Me._GetLabelCount()
        .Background = Me._GetBackground()
    End With
    
End

Public Sub _SetRadioButton(argTag As String, argText As String)
    
    Dim yukiRadioButton As New RadioButton(Me._$VBox) As "RadioButton"
    
    With yukiRadioButton
        .Text = argText
        .H = Me.LabelHeight
        .NoTabFocus = True
        .Tag = argTag
    End With
    
    Me._$radioButtons.Add(yukiRadioButton)
    
End

Public Sub _SetRadioButtons() ' virtual interface
    
    
    
End

Public Sub _InitializeLabel()
    
    Me._$Label = New Label(Me._$HBox)
    
    With Me._$Label
        .W = 48
        .Text = Me._GetlabelText()
        .Alignment = Align.Center
    End With
    
End

Public Sub _InitializeVBox() 
    
    Me._$VBox = New VBox(Me._$HBox)
    Me._$VBox.Expand = True
    
End

Public Sub SetPermission(argAuthTag As String)
    
    Dim yukiRadioButton As RadioButton
    
    For Each yukiRadioButton In Me._$radioButtons
        If yukiRadioButton.Tag = argAuthTag Then yukiRadioButton.Value = True
    Next
    
End

Public Function GetAuthTag() As String
    
    Dim yukiRadioButton As RadioButton
    
    For Each yukiRadioButton In Me._$radioButtons
        If yukiRadioButton.Value Then Return yukiRadioButton.Tag
    Next
    
    Return "-"
    
End

Public Sub _new(argContainer As Container)
    
    Me._InitializeHBox(argContainer)
    Me._InitializeLabel()
    Me._InitializeVBox()
    Me._SetRadioButtons()
    
End

Public Sub RadioButton_Click()
    
    Raise Signal(MikuruSignal.DialogChanged, Null)
    
End
