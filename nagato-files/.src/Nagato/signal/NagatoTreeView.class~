' Gambas class file

Inherits NagatoLeftPaneContent

Private $treeView As TreeView
Private $treeViewAction As NagatoTreeViewAction
Private $treeViewMouse As NagatoTreeViewMouse
Private $treeViewSurface As NagatoTreeViewSurface

Private Sub initializeTreeView(argContainer As Container)
    
    $treeView = New TreeView(argContainer) As "TreeView"
    
    With $treeView
        .Expand = True
        .Background = Color.Lighter(Color.Lighter(Color.Violet))
        .Foreground = Color.White
        .Visible = False
        .Drop = True
        .Mode = Select.Single
    End With
    
End

Public Sub Refresh()
    
    ' $treeView.Clear()
    $treeViewSurface.SetDirectory(User.Home)
    $treeViewAction.ExpandHomeDirectory()
    
End

Public Sub _new(argContainer As Container)
    
    initializeTreeView(argContainer)
    $treeViewSurface = New NagatoTreeViewSurface($treeView)
    $treeViewSurface.SetDirectory(User.Home)
    $treeViewMouse = New NagatoTreeViewMouse($treeView) As "MouseHandler"
    $treeViewAction = New NagatoTreeViewAction($treeView) As "ActionHandler"
    $treeViewAction.ExpandHomeDirectory()
    
    Me._$mainContent = $treeView
    
End

Public Sub ActionHandler_Expand(argKey As String)
    
    $treeViewSurface.SetDirectory(argKey) 
    
End

Public Sub MouseHandler_Move()
    
    Me.Refresh()
    
End
