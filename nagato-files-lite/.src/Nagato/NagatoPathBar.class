' Gambas class file

Inherits NagatoPathWidget

Private $completion As FileCompletion
Private $buttonBox As NagatoPathBarButtonBox

Public Sub SetPath(argPath As String)
    
    If Not Exist(argPath) Then Return
    
    Object.Lock($completion)
        $buttonBox.SetPathWithNoEvent(argPath)
    Object.Unlock($completion)
    
End

Public Sub _OnInitializeWidgets(argPath As String)
    
    $buttonBox = New NagatoPathBarButtonBox(Me._$container, argPath, Me._$groupName) As "TFEI"
    $completion = New FileCompletion($buttonBox.Editor) As "FileCompletion"
    
End

Public Sub FileCompletion_Activate()
    
    Raise Signal(MikuruSignal.ToolsNewAddress, [$buttonBox.Path])
    
End
