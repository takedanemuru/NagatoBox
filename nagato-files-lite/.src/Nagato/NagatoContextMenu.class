' Gambas class file

Inherits NagatoObject

Private $rootMenu As Menu
Private $primaryPath As String
Private $paths As String[]

Private Sub addMenuItem(argText As String, argTag As Integer, Optional argIconName As String)
    
    Dim yukiMenu As New Menu($rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIconName Then .Picture = MikuruIcon[argIconName]
    End With
    
End

Private Sub initializeChildMenus()
    
    Object.New("NagatoMenuFile", [$rootMenu, $primaryPath])
    addMenuItem(("Rename"), 0, "button-rotate-cw")
    addMenuItem(("Copy File Path"), 0, "clipboard")
    addMenuItem(("Create Symbolic Link"), 0, "link")
    addMenuItem(("Properties"), 0, "information-balloon")
        addMenuItem("", 0) ' as spacer
    addMenuItem(("Archive"), 0, "hard-drive-download")
    Object.New("NagatoMenuCopyTo", [$rootMenu, $paths])
    addMenuItem(("Move To..."), 0)
    addMenuItem(("Delete"), 0, "bin")
    
End

Public Sub PopUp(argPrimaryPath As String, argPaths As String[])
    
    $primaryPath = argPrimaryPath
    $paths = argPaths
    $rootMenu.Children.Clear()
    initializeChildMenus()
    $rootMenu.Popup()
    
End

Public Sub _new()
    
    $rootMenu = New Menu(HaruhiMain) As "RootMenu"
    
    MikuruMenuDummy($rootMenu)
    
End
