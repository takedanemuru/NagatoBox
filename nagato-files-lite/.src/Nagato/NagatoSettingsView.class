' Gambas class file

Inherits NagatoSettings

Private Function getDefault(argProperty As Integer) As Variant
    
    Select Case argProperty
        Case MikuruProperty.ViewShowPane
            Return True
        Case MikuruProperty.ViewShowHidden
            Return False
    End Select
    
End

Public Sub _get(argUniqueName As String, argProperty As Integer) As Variant
    
    Dim yukiKey As String = Subst$("&1/&2", argUniqueName, CStr(argProperty))
    Dim yukiProperty As Variant = Me._$settings[yukiKey, getDefault(argProperty)]
    
    If yukiProperty <> Null Then Return yukiProperty
    
End

Public Sub Set(argUniqueName As String, argProperty As Integer, argValue As Variant)
    
    Dim yukiKey As String = Subst$("&1/&2", argUniqueName, CStr(argProperty))

    Me._$settings[yukiKey] = argValue
    Me._$settings.Save()
    
End

Public Sub Toggle(argUniqueName As String, argProperty As Integer)
    
    Dim yukiKey As String = Subst$("&1/&2", argUniqueName, CStr(argProperty))

    If Me._$settings[yukiKey] = Null Then Me._$settings[yukiKey] = getDefault(argProperty)
    Me._$settings[yukiKey] = Not Me._$settings[yukiKey]
    Me._$settings.Save()
    
End
