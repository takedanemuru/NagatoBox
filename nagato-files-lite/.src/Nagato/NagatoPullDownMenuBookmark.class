' Gambas class file

Inherits NagatoPullDownMenu

Private Sub addDirectoryMenu(argPath As String, Optional argIconName As String)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "DirectoryMenu"
    
    With yukiMenu
        .Text = File.Name(argPath)
        .Tag = argPath
        If argIconName Then .Picture = MikuruIcon[argIconName]
    End With
    
End

Private Sub addXdgUserDirs()
    
    addDirectoryMenu(Desktop.GetDirectory("DESKTOP"), "desktop")
    addDirectoryMenu(Desktop.GetDirectory("DOCUMENTS"), "document")
    addDirectoryMenu(Desktop.GetDirectory("DOWNLOAD"), "hard-drive-download")
    addDirectoryMenu(Desktop.GetDirectory("MUSIC"), "music")
    addDirectoryMenu(Desktop.GetDirectory("PICTURES"), "image")
    addDirectoryMenu(Desktop.GetDirectory("PUBLICSHARE"), "users")
    addDirectoryMenu(Desktop.GetDirectory("TEMPLATES"), "ruler")
    addDirectoryMenu(Desktop.GetDirectory("VIDEOS"), "video")
    
End

Private Sub addGtkBookmark()
    
    Dim yukiPath As String
    
    For Each yukiPath In NagatoGtkBookmarks.List
        addDirectoryMenu(yukiPath, "folder")
    Next
    
End

Public Sub _OnRefreshChildMenus()
    
    addXdgUserDirs()
    Object.New("NagatoMenuItemSpacer", [Me._$rootMenu])
    addGtkBookmark()
    
End

Public Sub DirectoryMenu_Click()
    
    Raise Signal(MikuruSignal.DirectoryMoveTo, [Last.Tag])
    
End
