' Gambas class file

Inherits NagatoTableView

Private Sub getSelected() As Variant[]
    
    Dim yukiActiveRow As Integer = Me._$tableView.Rows.Selection[0]
    
    Return [yukiActiveRow]
    
End

Public Sub Asakura_Activate()
    
    Raise Signal(MikuruSignal.TableViewActivate, getSelected())
    
End

Public Sub Asakura_MouseDown()
    
    If Mouse.Right Then Return
    
    Raise Signal(MikuruSignal.TableViewSelect, getSelected())
    
End

Public Sub Asakura_Menu()
    
    Raise Signal(MikuruSignal.TableViewContext, getSelected())

End

Public Sub Asakura_MouseMove()
    
    If Not Mouse.Left Then Return
    
    Drag.Icon = MikuruIcon["balloon", 64]
    Try Me._$tableView.Drag("yuki.n", "text/plain")

     Try Me._$tableView.Select(Me._$tableView.RowAt(Drag.Y), 1)
    
End

Public Sub Asakura_Drop()
    
    Debug Me._$tableView[Me._$tableView.RowAt(Drag.Y), 1].Text
    Debug Drag.Data
    
End
