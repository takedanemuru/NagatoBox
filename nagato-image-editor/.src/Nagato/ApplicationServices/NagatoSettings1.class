' Gambas class file

Create Static

Property Read RecentPath As String[]
Property LastDirectory As String

Private Const HistoryMax As Integer = 30

Private $settings As New Settings

Private Sub overwriteRecentPaths(argPath As String)
    
    Dim yukiRecents As String[] = Me.RecentPath.Copy()
    Dim yukiTargetIndex As Integer = yukiRecents.Find(argPath) ' .Find(value) returns -1 if value not found.
    
    If yukiTargetIndex > -1 Then yukiRecents.Remove(yukiTargetIndex)
    yukiRecents.Add(argPath, 0)
    yukiRecents.Resize(HistoryMax)
    
    $settings["background/recent"] = yukiRecents.Copy()
    $settings.Save()
    
End

Public Sub PushToRecentPaths(argPath As String)
    
    overwriteRecentPaths(argPath)
    
End

Private Function RecentPath_Read() As String[]

    Return $settings["background/recent", [""]]

End

Private Function LastDirectory_Read() As String

    Return $settings["recent/directory", Desktop.GetDirectory("PICTURES")]

End

Private Sub LastDirectory_Write(Value As String)

    $settings["recent/directory"] = Value

End
