' Gambas class file

Inherits NagatoMenuPipe

Private $button As MenuButton
Private $rootMenu As Menu

Private Sub setRootMenu()
    
    $rootMenu = New Menu(HaruhiImageView)
    
    $rootMenu.Name = "UniqueName"
    $button.Menu = $rootMenu.Name
    
End

Private Sub addMenuItem(argText As String, argTag As Integer, Optional argIconName As String)
    
    Dim yukiMenu As New Menu($rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIconName Then .Picture = MikuruIcon.Get(argIconName)
    End With
    
End

Private Sub setSubMenu()
    
    addMenuItem(("Edit"), MikuruEvent.StarEdit, "brush")
    addMenuItem(("Try & Error"), MikuruEvent.StarEdit, "brush")
        addMenuItem("", 0)
    addMenuItem(("About nagato-image-view"), MikuruEvent.StarAbout, "star")
    addMenuItem(("Quit"), MikuruEvent.StarQuit, "button-power")
    
End

Public Sub _new(argMenuButton As MenuButton)
    
    $button = argMenuButton
    setRootMenu()
    setSubMenu()
    
End

Public Sub MenuItem_Click()
    
    Select Case Last.Tag
        Case MikuruEvent.StarAbout
            HaruhiAbout.ShowDialog()
        Case MikuruEvent.StarQuit
            HaruhiImageView.Close()
        Case MikuruEvent.StarEdit
            Raise MenuEvent(Last.Tag)
    End Select
    
End
