' Gambas class file

Property Read BeforeImage As Image
Property Read AfterImage As Image

Private $images As NagatoTwinViewHandlerImages
Private $zooms As NagatoTwinViewHandlerZooms

Public Sub Rotate(argAngle As Float)
    
    $zooms.ReserveZoom()
        $images.Rotate(argAngle)
    $zooms.RestoreZoom()
    
End

Public Sub SetZoom(argZoom As Float)
    
    $zooms.SetZoom(argZoom)
    
End

Public Sub SetZoomNormal()
    
    $zooms.SetZoomNormal()
    
End

Public Sub SetZoomFit()
    
    $zooms.SetZoomFit()
    
End

Public Sub Toggle()
    
    $zooms.EnsureVisible()
    '$images.Toggle
    
End

Public Sub SetPath(argPath As String)
    
    $images.SetPath(argPath)
    
End

Public Sub ApplyEffect()
    
    $images.ApplyEffect()
    
End

Public Sub PreviewEffect(argEffect As Integer, argValues As Variant[])
    
    $zooms.EnsureVisible()
        $images.PreviewEffect(argEffect, argValues)
    $zooms.RestoreZoom()
    
End

Public Sub _new(argViewBefore As ImageView, argViewAfter As ImageView)
    
    $images = New NagatoTwinViewHandlerImages(argViewBefore, argViewAfter)
    $zooms = New NagatoTwinViewHandlerZooms(argViewBefore, argViewAfter)
    
End

Private Function BeforeImage_Read() As Image

    Return $images.BeforeImage

End

Private Function AfterImage_Read() As Image

    Return $images.AfterImage

End
