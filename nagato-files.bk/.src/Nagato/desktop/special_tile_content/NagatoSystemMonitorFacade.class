' Gambas class file

Create Static

Property Read Label As String
Property Read Content As String
Property Read Text As String

Private $systemMonitor As New NagatoDBusAccessSystemMonitor
Private $observer As Observer
Private $buffer As New NagatoSystemStatusBuffer

Public Function EnsureActivation(argId As String) As Boolean
    
    If Not $systemMonitor.Activated Then $systemMonitor.Activate(argId)
    If Not Object.IsValid($observer) Then $observer = New Observer(HaruhiDesktop) As "Asakura"
    
    Return $systemMonitor.Activated
    
End

Private Function Label_Read() As String

    Dim yukiText As String
    
    yukiText &= "CPU<br>"
    yukiText &= "Mem.<br>"
    yukiText &= "Swap<br>"
    yukiText &= "Proc.<br>"
    yukiText &= "Temp."
    
    Return yukiText

End

Private Function Content_Read() As String

    Return $buffer.List

End

Private Function Text_Read() As String

    Return $buffer.Inline

End

Public Sub Asakura_SystemTimer()
    
    If Not $systemMonitor.Activated Then Return
    
    With $systemMonitor
        $buffer.SetStatus(.CpuUsage, .MemoryUsage, .SwapUsage, .ProcessCount, .Thermal)
    End With
    
End
