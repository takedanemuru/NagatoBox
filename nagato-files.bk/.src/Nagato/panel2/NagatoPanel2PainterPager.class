' Gambas class file

Inherits NagatoPanel2Painter

Private Const BoxSize As Integer = 22

Private $startX As Integer

Private Function getRectangleBackgroundColor(argCount As Integer) As Integer
    
    If Desktop.Current = argCount Then Return NagatoSettingsPanel.Highlight
    
    Return NagatoSettingsPanel.Foreground
    
End

Private Sub paintRectangle(argIndex As Integer)
    
    Paint.Brush = Paint.Color(getRectangleBackgroundColor(argIndex))
    Paint.Rectangle($startX + 22 * argIndex + 2, 2, 20, 20)
    
End

Private Sub paintText(argIndex As Integer)
    
    Paint.Brush = Paint.Color(NagatoSettingsPanel.Background)
    Paint.DrawText(argIndex + 1, $startX + 22 * argIndex + 2, 2, 20, 20, Align.Center)
    
End

Public Sub _OnLeftClick(argX As Integer)
    
    Desktop.Current = (argX - $startX) Div 22 
    
End

Public Sub _OnRightClick(argX As Integer)
    
    Dim yukiMenu As New NagatoContextMenuPanelPager(HaruhiDesktop, "")
    
    yukiMenu.Popup()
    
End

Public Sub Paint(Optional argX As Integer) As Integer
    
    Dim yukiIndex As Integer
    Dim yukiW As Integer = BoxSize * Desktop.Count + 4
    
    $startX = argX - yukiW
    
    For yukiIndex = 0 To Desktop.Count - 1
        paintRectangle(yukiIndex)
        Paint.Fill()
        paintText(yukiIndex)
        Paint.Fill()
    Next
    
    Return $startX
    
End
