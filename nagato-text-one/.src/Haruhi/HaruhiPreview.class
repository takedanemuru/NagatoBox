' Gambas class file

Public Sub SetText(argText As String)
    
    PreviewTextArea.Text = argText
    
    StatusLabel.Text = Subst$(("Converted &1 to UTF-8. Save this ?"), MikuruCharactorCode.CharactorCode)
    
End


Public Sub CancelButton_Click()

    Me.Close()

End


Public Sub SaveButton_Click()

    Dialog.Path = User.Home &/ "your_file.txt"
    Dialog.Title = ("Save File")

    If Dialog.SaveFile() Then Return
    
    File.Save(Dialog.Path, PreviewTextArea.Text)
    
    Message.Info(("YUKI.N > File successfully saved."), ("OK"))
    
    Me.Close()
    
End
