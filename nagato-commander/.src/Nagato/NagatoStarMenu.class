' Gambas class file

Inherits NagatoObject

Private $rootMenu As Menu

Private Sub initializeRootMenu(argMenuMenu As String)
    
    $rootMenu = New Menu(HaruhiMain)
    
    With $rootMenu
        .Text = ""
        .Name = argMenuMenu
    End With
    
End

Private Sub addChildMenu(argText As String, argTag As Integer, Optional argIcon As String)
    
    Dim yukiMenu As New Menu($rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIcon Then .Picture = MikuruIcon.Get(argIcon)
    End With
    
End

Public Sub _new(argMenuMenu As String)
    
    initializeRootMenu(argMenuMenu)
    addChildMenu("Add New Tab", MikuruSignal.TarminalAdd)
    addChildMenu("", 0)
    addChildMenu("About", MikuruSignal.ApplicationAbout, "star")
    addChildMenu("Quit", MikuruSignal.ApplicationQuit, "button-power")
    
End

Public Sub MenuItem_Click()
    
    Raise Signal(Last.Tag, Null)
    
End
