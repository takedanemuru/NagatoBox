' Gambas class file

Private $menuButton As NagatoMenuButton
Private $mainContainer As NagatoMainContainer

Public Sub _new()
    
    $menuButton = New NagatoMenuButton(VBox2) As "MenuButton"
    $mainContainer = New NagatoMainContainer(Me)
    
End

Public Sub Form_Open()
    
    NagatoSettings.LoadFormSettings(Me)
    Application.MainWindow = Me
    
End

Public Sub Form_Close()
    
    Dim yukiMessage As String = ("YUKI.N > We are going to kill All Tabs. Are you sure ?")
    
    If Message.Question(yukiMessage, ("Cancel"), ("Close")) <> 2 Then
        Stop Event
        Return
    Endif
    
    $mainContainer.KillAll()
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub MenuButton_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.TarminalAdd
            $mainContainer.AddTerminal()
        Case MikuruSignal.ApplicationQuit
            Me.Close()
    End Select
    
End
