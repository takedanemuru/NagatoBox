' Gambas class file

Private $processes As New NagatoProcesses

Private Sub incrementTab()
    
    Inc TabStrip1.Count
    TabStrip1.Index = TabStrip1.Count - 1
    
End

Private Sub insertTerminal()
    
    Dim yukiTerminal As New NagatoTerminal(TabStrip1)
    
    $processes.Add(yukiTerminal.ProcessId)
    TabStrip1[TabStrip1.Count - 1].Text = "Terminal-#" & yukiTerminal.ProcessId
    
End

Private Sub addTerminal(Optional argInitial As Boolean = False)
    
    If Not argInitial Then incrementTab()
    insertTerminal()
    
End

Public Sub Form_Open()
    
    NagatoSettings.LoadFormSettings(Me)
    Application.MainWindow = Me
    addTerminal(True)
    
End

Public Sub Form_Close()
    
    $processes.KillAll()
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub TabStrip1_Close(argIndex As Integer)

    $processes.Kill(argIndex)

    TabStrip1[argIndex].Children[0].Delete()
    TabStrip1[argIndex].Delete()

End
