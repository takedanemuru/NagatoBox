' Gambas class file

Property Read Count As Integer

Private $order As New Integer[]
Private $position As Integer = 0

Private Sub setNumber(argMax As Integer, Optional argBlockedNumber As Integer)
    
    Dim yukiNumber As Integer
    
    Do
        yukiNumber = Int(Rnd(0, argMax + 1))
        If $order.Exist(yukiNumber) Then Continue
        If argBlockedNumber And If yukiNumber = argBlockedNumber Then Continue
        $order.Add(yukiNumber)
        Break
    Loop
    
End

Public Sub Refresh(argMax As Integer)
    
    Dim yukiCount As Integer
    
    $position = 0
    $order.Clear()
    
    For yukiCount = 0 To argMax
        setNumber(argMax)
    Next
    
End

Public Sub RefreshOnSort(argFixedIndex As Integer, argMax As Integer)
    
    Dim yukiCount As Integer
    
    $position = 0
    $order.Clear()
    
    For yukiCount = 0 To argMax
        If yukiCount = argFixedIndex Then $order.Add(argFixedIndex)
        If yukiCount <> argFixedIndex Then setNumber(argMax, argFixedIndex)
    Next
    
End

Public Function Next() As Integer
    
    Inc $position
    If $position > $order.Max Then $position = 0
    
    Return $order[$position]
    
End

Public Function Back() As Integer
    
    Dec $position
    If 0 > $position Then $position = $order.Max
    
    Return $order[$position]
    
End

Public Function FindIndex(argIndex As Integer) As Integer
    
    Return $order.Find(argIndex)
    
End

Public Function _get(argIndex As Integer) As Integer
    
    Return $order.Find(argIndex)
    
End

Private Function Count_Read() As Integer

    Return $order.Count

End
