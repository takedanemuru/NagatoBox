' Gambas class file

Inherits NagatoQueueAssistant

Private $coverArt As Picture

Private Function getDurationData() As NagatoDurationData
    
    Dim yukiDurationData As NagatoDurationData = Me._$player.GetDurationData()

    yukiDurationData.OverrideDuration(Me._$musicList[Me._$musicList.CurrentIndex].Duration)

    Return yukiDurationData
    
End

Public Sub Reload()
    
    $coverArt = MikuruEyeD3.GetPicture(Me._$musicList[Me._$musicList.CurrentIndex].Path, MikuruUx.CoverArt.Size)
    
End

Public Sub _OptionalOnInitialize()
    
    Me.Reload()
    
End

Public Sub GetProperty(argProperty As Integer) As Variant
    
    Select Case argProperty
        Case MikuruProperty.PlayState
            Return Me._$player.State
        Case MikuruProperty.SoftwareVolume
            Return Me._$player.SoftwareVolume
        Case MikuruProperty.CoverArt
            Return $coverArt
        Case MikuruProperty.CurrentTitle
            Return Me._$musicList[Me._$musicList.CurrentIndex].Title
        Case MikuruProperty.CurrentArtist
            Return Me._$musicList[Me._$musicList.CurrentIndex].Artist
        Case MikuruProperty.CurrentAlbum
            Return Me._$musicList[Me._$musicList.CurrentIndex].Album
        Case MikuruProperty.CurrentIndex
            Return Me._$musicList.CurrentIndex
        Case MikuruProperty.CurrentUrl
            Return Media.URL(Me._$musicList[Me._$musicList.CurrentIndex].Path)
        Case MikuruProperty.CurrentDurationData
            Return getDurationData()
        Case MikuruProperty.CurrentDurationText
            Return getDurationData().Text
        Case MikuruProperty.ListCount
            Return Me._$musicList.Max + 1
        Case MikuruProperty.ListMax
            Return Me._$musicList.Max
    End Select
    
End
