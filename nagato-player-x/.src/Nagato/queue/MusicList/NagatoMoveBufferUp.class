' Gambas class file

Property Read Buffer As NagatoMusicElement[]
Property Read NewSelection As Integer[]
Property Read NewPosition As Integer

Private $buffer As New NagatoMusicElement[]
Private $insertPosition As Integer 
Private $newCurrentPosition As Integer
Private $newSelection As New Integer[]

Private $position As Integer

Public Sub AddSelected(argIndex As Integer, argElement As NagatoMusicElement)
    
    $buffer.Insert([argElement], $insertPosition)
    If argIndex = $position Then $newCurrentPosition = $insertPosition
    $newSelection.Add($insertPosition)
    Inc $insertPosition
    
End

Public Sub AddUnselected(argIndex As Integer, argElement As NagatoMusicElement)
    
    $buffer.Add(argElement)
    If argIndex = $position Then $newCurrentPosition = argIndex
    
End

Public Sub _new(argSelection As Integer[], argPosition As Integer)
    
    $insertPosition = Max(0, argSelection.Sort()[0] - 1)
    $position = argPosition
    
End

Private Function Buffer_Read() As NagatoMusicElement[]

    Return $buffer

End

Private Function NewSelection_Read() As Integer[]

    Return $newSelection

End

Private Function NewPosition_Read() As Integer

    Return $newCurrentPosition

End
