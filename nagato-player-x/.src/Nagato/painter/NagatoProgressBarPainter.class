' Gambas class file

Inherits NagatoWidgetPainter

Private Sub paintProgressBarOnMouse()
    
    Dim yukiRate As Float = MikuruMouseRate(MikuruUx.ProgressBar, MikuruMousePosition.X)
    Dim yukiBarRectangle As Rect = Me._GetBarRectangle(MikuruUx.ProgressBar, yukiRate)
    Dim yukiDurationData As NagatoDurationData = NagatoQueue.GetProperty(MikuruProperty.CurrentDurationData)
    Dim yukiText As String = yukiDurationData.GetTextByRate(yukiRate)
    
    Me._PaintClipRectangle(MikuruUx.ProgressBar, 2 * MikuruUx.Grid)
    Me._PaintRectangle(MikuruUx.ProgressBar, MikuruColor.WidgetOnMouseLight) 'frame
    Me._PaintRectangle(yukiBarRectangle, MikuruColor.WidgetOnMouse, 2 * MikuruUx.Grid) 'bar
    Me._PaintRichText(MikuruUx.ProgressBar, Subst$("<b>&1</b>", yukiText))
    Paint.Restore() 'restore clip rectangle
    
End

Private Sub paintProgressBarNormal()
    
    Dim yukiData As NagatoDurationData = NagatoQueue.GetProperty(MikuruProperty.CurrentDurationData)
    Dim yukiBarRectangle As Rect = Me._GetBarRectangle(MikuruUx.ProgressBar, yukiData.Rate)
    
    Me._PaintClipRectangle(MikuruUx.ProgressBar, 2 * MikuruUx.Grid)
    Me._PaintRectangle(MikuruUx.ProgressBar, MikuruColor.WidgetLight) 'frame
    Me._PaintRectangle(yukiBarRectangle, MikuruColor.Widget, 2 * MikuruUx.Grid) 'bar
    Me._PaintRichText(MikuruUx.ProgressBar, Subst$("<b>&1</b>", yukiData.Text))
    Paint.Restore() 'restore clip rectangle
    
End

Public Sub Draw()
    
    If MikuruUx.ProgressBar.Contains(MikuruMousePosition.X, MikuruMousePosition.Y) Then
        paintProgressBarOnMouse()
    Else
        paintProgressBarNormal()
    Endif
    
End
