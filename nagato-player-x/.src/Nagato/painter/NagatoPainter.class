' Gambas class file

Private $timer As New Timer As "Timer"
Private $drawingArea As DrawingArea
Private $observer As Observer
Private $painterWidget As New NagatoPainterWidgets
Private $background As New NagatoPainterBackground

Public Sub SetMessage(argMessage As String, argDuration As Integer)
    
    $painterWidget.SetMessage(argMessage, argDuration)
    
End

Public Sub Refresh()
    
    $drawingArea.Refresh()
    
End

Public Sub ChangeImage()
    
    $background.SetBackgroundImage()
    
End

Public Sub _new(argDrawingArea As DrawingArea)
    
    $background.SetBackgroundImage()
    $drawingArea = argDrawingArea
    $observer = New Observer($drawingArea) As "Asakura"
    $timer.Enabled = True
    
End

Public Sub Asakura_Draw()
    
    Paint.Begin(Draw.Device)
        $background.Draw()
        $painterWidget.Paint(MikuruMousePosition.Entered)
    Paint.End()

    HaruhiPlayer.Title = NagatoQueue.GetProperty(MikuruProperty.CurrentTitle)
    
End

Public Sub Asakura_Enter()

    MikuruMousePosition.Entered = True
    
End

Public Sub Askura_Leave()
    
    MikuruMousePosition.Entered = False
    
End

Public Sub Asakura_MouseMove()

    MikuruMousePosition.SetMousePosition(Mouse.X, Mouse.Y)
    $drawingArea.Refresh()

End

Public Sub Timer_Timer()
    
    $drawingArea.Refresh()
    
End
