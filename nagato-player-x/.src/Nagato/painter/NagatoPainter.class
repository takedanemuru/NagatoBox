' Gambas class file

Private $timer As New Timer As "Timer"
Private $drawingArea As DrawingArea
Private $observer As Observer
Private $painterWidget As New NagatoPainterWidgets
Private $background As New NagatoPainterBackground
Private $surface As New NagatoSurface As "Surface"

Public Sub SetMessage(argMessage As String, argDuration As Integer)
    
    $painterWidget.SetMessage(argMessage, argDuration)
    
End

Public Sub Refresh()
    
    $drawingArea.Refresh()
    
End

Public Sub _new(argDrawingArea As DrawingArea)
    
    $background.SetBackgroundImage()
    $drawingArea = argDrawingArea
    $drawingArea.Refresh()
    $observer = New Observer($drawingArea) As "Asakura"
    
    $timer.Enabled = True
    
End

Public Sub Asakura_Draw()
    
    Paint.Begin(Draw.Device)
        $background.Draw()
        $painterWidget.Paint(Mouse.Inside($drawingArea))
    Paint.End()
    
End

Public Sub Asakura_MouseMove()

    MikuruMousePosition.SetMousePosition(Mouse.X, Mouse.Y)
    $drawingArea.Refresh()

End

Public Sub Asakura_Drop()
    
    'Image data is NOT acceptable.
    If Drag.Type = Drag.Text Then $surface.Drop(Drag.Data)
    
    $background.SetBackgroundImage()
    
End

Public Sub Asakura_MouseDown()
    
    $surface.MouseDown(Mouse.X, Mouse.Y)
    
End

Public Sub Surface_RequestRefresh()
    
    $drawingArea.Refresh()
    
End
