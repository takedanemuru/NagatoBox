' Gambas class file

Private $timer As New Timer As "Timer"
Private $drawingArea As DrawingArea
Private $observer As Observer
Private $painterWidget As New NagatoPainterWidgets
Private $background As New NagatoPainterBackground
Private $observer2 As Observer
Private $timerCount As Integer

Public Sub SetMessage(argMessage As String, argDuration As Integer)
    
    $painterWidget.SetMessage(argMessage, argDuration)
    
End

Public Sub Refresh()
    
    $drawingArea.Refresh()
    
End

Public Sub ChangeImage()
    
    $background.SetBackgroundImage()
    
End

Public Sub _new(argDrawingArea As DrawingArea)
    
    $background.SetBackgroundImage()
    $drawingArea = argDrawingArea
    $drawingArea.Refresh()
    $observer = New Observer($drawingArea) As "Asakura"
    $observer2 = New Observer(NagatoQueue) As "Kimidori"
    
    $timer.Enabled = True
    
End

Public Sub Asakura_Draw()
    
    Paint.Begin(Draw.Device)
        $background.Draw()
        $painterWidget.Paint(Mouse.Inside($drawingArea))
    Paint.End()

    HaruhiPlayer.Title = NagatoQueue.GetProperty(MikuruProperty.CurrentTitle)
    
End

Public Sub Asakura_MouseMove()

    MikuruMousePosition.SetMousePosition(Mouse.X, Mouse.Y)
    $drawingArea.Refresh()

End

Public Sub Timer_Timer()
    
     $drawingArea.Refresh()
    
End

Public Sub Kimidori_Broadcast(argBroadcast As Integer, argValues As Variant[])
    
    If argBroadcast = MikuruSignal.BroadcastIndexMoved Then $drawingArea.Refresh()
    
End
