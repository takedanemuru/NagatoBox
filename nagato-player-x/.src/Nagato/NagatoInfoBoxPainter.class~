' Gambas class file

Inherits NagatoWidgetPainter

Private $messageDuration As Integer = 0
Private $message As String = ""

Private Function getInfoText() As String
    
    If NagatoQueue.Count = 0 Then
        Return Subst$("<b>YUKI.N > Can you see this ?</b>")
    Else
        Return Subst$("<b>&1</b>", NagatoQueue.Title)
    Endif
    
End

Private Sub drawMessage(argRect As Rect)
    
     If $messageDuration > 0 Then
        Me._PaintRichText(argRect, $message)
    Else
        Me._PaintRichText(argRect, getInfoText())
    End If
    
End

Private Sub drawCoverArt()
    
    With MikuruUx.CoverArt
        Me._PaintClipRectangle(MikuruUx.CoverArt, 1 * MikuruUx.Grid)
        Draw.Picture(NagatoQueue.CoverArt, .X, .Y)
        Paint.Fill(False)
    End With
    
End

Public Sub SetMessage(argText As String, argDuration As Integer)
    
    $message = argText
    $messageDuration = argDuration
    
End

Public Sub Draw()
    
    Dim yukiRect As Rect = MikuruUx.InfoBoxInternal
    
    Me._PaintRectangle(MikuruUx.InfoBox, Me._GetWidgetColor(MikuruUx.InfoBox), 1.5 * MikuruUx.Grid)
    
    If NagatoQueue.CoverArt Then
        drawCoverArt()
        yukiRect.X += (MikuruUx.CoverArtSize + MikuruUx.Grid)
        yukiRect.W -= (MikuruUx.CoverArtSize + MikuruUx.Grid)
    Endif

    drawMessage(yukiRect)
    
    Dec $messageDuration
    
End
