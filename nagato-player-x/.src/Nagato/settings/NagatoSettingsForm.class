' Gambas class file

Create Static

Inherits NagatoSettings

Property Read BackgroundHeight As Integer
Property Read BackgroundWidth As Integer

Public Sub Load(argForm As Form)
    
    argForm.X = Me._$settings[Subst$("&1/x", argForm.Name), argForm.X]
    argForm.Y = Me._$settings[Subst$("&1/y", argForm.Name), argForm.Y]
    argForm.H = Me._$settings[Subst$("&1/h", argForm.Name), argForm.H]
    argForm.W = Me._$settings[Subst$("&1/w", argForm.Name), argForm.W]
    
End

Public Sub Save(argForm As Form)
    
    Me._$settings[Subst$("&1/x", argForm.Name)] = argForm.X
    Me._$settings[Subst$("&1/y", argForm.Name)] = argForm.Y
    Me._$settings[Subst$("&1/h", argForm.Name)] = argForm.H
    Me._$settings[Subst$("&1/w", argForm.Name)] = argForm.W
    Me._$settings.Save()
    
End

Public Sub SetMainFormSize(argForm As Form)
    
    argForm.Height = 48 * MikuruUx.Grid
    argForm.Width = 36 * MikuruUx.Grid

End

Public Function GetBackgroundPath() As String

    Return Me._$settings["bg/last_path", "Pictures/nagato_window_side.png"]

End

Public Sub SaveBackgroundPath(Value As String)

    Me._$settings["bg/last_path"] = Value
    Me._$settings.Save()

End

Private Function BackgroundHeight_Read() As Integer

    Return 48 * MikuruUx.Grid

End

Private Function BackgroundWidth_Read() As Integer

    Return 36 * MikuruUx.Grid

End
