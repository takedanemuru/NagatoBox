' Gambas class file

Inherits NagatoGridHandler

Private Sub adjustWidth(argData As String, argColumn As Integer)
    
    Dim yukiWidth As Integer = HaruhiPlayList.Font.RichTextWidth(argData) + MikuruUx.Padding
    
    If yukiWidth > Me._$gridView.Columns[argColumn].W Then
        Me._$gridView.Columns[argColumn].W = yukiWidth
    Endif
    
End

Public Sub SetGridData(argColumn As Integer, argData As String, Optional argExpand As Boolean = True)
    
    Me._$gridView[Me._$gridView.Rows.Max, argColumn].Text = argData
    If argExpand Then adjustWidth(argData, argColumn)
    
End

Public Sub SetGridDataRight(argColumn As Integer, argData As String, Optional argExpand As Boolean = True)
    
    Me._$gridView[Me._$gridView.Rows.Max, argColumn].Text = argData
    Me._$gridView[Me._$gridView.Rows.Max, argColumn].Alignment = Align.Right
    If argExpand Then adjustWidth(argData, argColumn)
    
End

Public Function GetSelectionText(argColumnIndex As Integer) As String[]
    
    Dim yukiRowIndex As Integer
    Dim yukiResult As New String[]
    
    For Each yukiRowIndex In Me._$gridView.Rows.Selection
        yukiResult.Add(Me._$gridView[yukiRowIndex, argColumnIndex].Text)
    Next
    
    Return yukiResult
    
End
