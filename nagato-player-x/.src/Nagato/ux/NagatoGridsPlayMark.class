' Gambas class file

Private Const ColumnIcon As Integer = 0

Private $grids As GridView

Public Sub Refresh(argRow As Integer)
    
    Dim yukiRow As Integer
    
    For yukiRow = 0 To $grids.Rows.Max
        $grids[yukiRow, ColumnIcon].Picture = IIf(yukiRow = argRow, MikuruIcon.Get("button-play"), Null)
    Next
    
End

Public Function Set(argRowIndex As Integer) As Boolean
    
    If argRowIndex <> NagatoQueue.ChannelCurrent.Index Then Return False
        
    If NagatoQueue.ChannelPlayer.State = Media.Playing Then
        $grids[argRowIndex, ColumnIcon].Picture = MikuruIcon.Get("button-play")
    Else
        $grids[argRowIndex, ColumnIcon].Picture = MikuruIcon.Get("button-pause")
    End If
    
    Return True

End

Public Sub _new(argGrids As GridView)
    
    $grids = argGrids
    
End
