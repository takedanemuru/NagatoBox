' Gambas class file

Private Const ColumnIcon As Integer = 0

Private $grids As GridView

Private Function getIcon(argIndex As Integer) As Picture
    
    If argIndex <> NagatoQueue.GetProperty(MikuruProperty.CurrentIndex) Then 
        Return Null
    Else If MikuruState.CheckState(MikuruState.Play) Then
        Return MikuruIcon.Get("button-play")
    Else
        Return MikuruIcon.Get("button-pause")
    End If
    
End

Public Sub Refresh()
    
    Dim yukiRow As Integer
    
    For yukiRow = 0 To $grids.Rows.Max
        $grids[yukiRow, 0].Picture = getIcon(yukiRow)
    Next
    
    $grids[NagatoQueue.GetProperty(MikuruProperty.CurrentIndex), 0].EnsureVisible()

Catch
    Return

End

Public Sub _new(argGrids As GridView)
    
    $grids = argGrids
    
End
