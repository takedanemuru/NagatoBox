' Gambas class file

Inherits NagatoMenuBar

Public Sub _AddStarMenu() 'override
    
    Dim yukiMenu As New NagatoNowPlayingMenu As "NagatoMenu"
     
    Me._$starButton.Menu = yukiMenu.Name
    
End

Public Sub _Initialize() 'override
    
    Me._AddButton(MikuruSignal.QueueBack, "button-rew", ("Back"))
    Me._AddButton(MikuruSignal.QueuePlay, "button-play", ("Play"))
    Me._AddButton(MikuruSignal.QueuePause, "button-pause", ("Pause"))
    Me._AddButton(MikuruSignal.QueueNext, "button-ff", ("Forward"))
        Me._AddSeparator()
    Me._AddButton(MikuruSignal.QueueShuffle, "button-shuffle", ("Shuffle"))
    Me._AddButton(MikuruSignal.QueueRepeat, "button-synchronize", ("Repeat"))
        Me._AddSeparator()
    Me._AddButton(MikuruSignal.ListDown, "arrow-down", ("Down"))
    Me._AddButton(MikuruSignal.ListUp, "arrow-up", ("Up"))
    Me._AddButton(MikuruSignal.ListAddMusic, "music", ("Add Music"))
    Me._AddButton(MikuruSignal.ListAddDirectory, "folder", ("Add Folder"))
    Me._AddButton(MikuruSignal.ListClear, "bin", ("Clear"))
        Me._AddPanel()
    Me._AddStarButton()
    
End

Public Sub MenuButton_Click()
    
    Select Case Last.Tag
        Case MikuruSignal.QueuePlay
            NagatoQueue.ChannelPlayControl.Play()
        Case MikuruSignal.QueuePause
            NagatoQueue.ChannelPlayControl.Pause()
        Case MikuruSignal.QueueNext
            NagatoQueue.ChannelPlayControl.Next()
        Case MikuruSignal.QueueBack
            NagatoQueue.ChannelPlayControl.Back()
        Case MikuruSignal.QueueShuffle
            NagatoSettingsMusic.Shuffle = Not NagatoSettingsMusic.Shuffle
        Case MikuruSignal.QueueRepeat
            NagatoSettingsMusic.Repeat = Not NagatoSettingsMusic.Repeat
        Case MikuruSignal.ListDown, MikuruSignal.ListUp
            Raise Signal(Last.Tag, [""])
        Case MikuruSignal.ListAddMusic
            MikuruDialog.AddMusic()
        Case MikuruSignal.ListAddDirectory
            MikuruDialog.AddDirectory()
        Case MikuruSignal.ListClear
            NagatoQueue.ClearAll()
    End Select
    
End
