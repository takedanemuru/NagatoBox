' Gambas class file

Inherits NagatoSignal

Private $menuBar As NagatoMenuBarNowPlaying
Private $grids As NagatoGridsNowPlaying
Private $queueObserver As Observer

Event NewPlaylist

Public Sub MoveTo(argUrl As String)
    
    $grids.MoveTo(argUrl)
    
End

Public Sub _new(argContainer As Container, argGrids As GridView)
    
    $menuBar = New NagatoMenuBarNowPlaying(argContainer)
    $grids = New NagatoGridsNowPlaying(argGrids) As "Grids"
    $queueObserver = New Observer(NagatoQueue) As "Asakura"
    
End

Public Sub StarMenu_SavePlaylist()
    
    If $grids.GetPaths().Count = 0 Then Return
    
    NagatoDBMedia.SaveAsPlaylist(MikuruDialog.PlaylistName, $grids.GetPaths())
    
    Raise NewPlaylist
    
End

Public Sub Asakura_Changed()
    
    If Not Object.IsValid($grids) Then Return
    
    $grids.Refresh()
    
End

Public Sub Asakura_State()
    
    If Not Object.IsValid($grids) Then Return
    
    $grids.RefreshPlaymark()
    
End
