' Gambas class file

Inherits NagatoTab

Private $menuBar As NagatoMenuBarQueue
Private $grids As NagatoGridsQueue
Private $queueObserver As Observer

Event NewPlaylist

Public Sub _OnInitialize(argContainer As Container, argGrids As GridView)
    
    $menuBar = New NagatoMenuBarQueue(argContainer) As "MenuBar"
    $grids = New NagatoGridsQueue(argGrids) As "Grids"
    $queueObserver = New Observer(NagatoBroadCast) As "Asakura"
    
End

Public Sub MenuBar_Signal(argSignal As Integer, argVariables As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.ListSaveAs
            NagatoQueue.SaveAsPlaylist()
            Raise NewPlaylist
        Case MikuruSignal.ListUp
            NagatoQueue.ChannelList.MoveUp($grids.Selection)
        Case MikuruSignal.ListDown
            NagatoQueue.ChannelList.MoveDown($grids.Selection)
    End Select
    
End

Public Sub Asakura_Changed()
    
    If Object.IsValid($grids) Then $grids.Refresh()
    
End

Public Sub Asakura_Moved()
    
    If Object.IsValid($grids) Then $grids.Refresh()
    
End

Public Sub Asakura_SelectionMoved(argSelection As Integer[])
    
    If Not Object.IsValid($grids) Then Return
    
    $grids.Refresh()
    $grids.RefreshSelection(argSelection)
    
End

Public Sub Asakura_TagChanged()
    
    $grids.Refresh()
    
End
