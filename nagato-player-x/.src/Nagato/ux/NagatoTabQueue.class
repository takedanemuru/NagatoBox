' Gambas class file

Inherits NagatoTab

Private $menuBar As NagatoMenuBarQueue
Private $grids As NagatoGridsQueue
Private $queueObserver As Observer

Public Sub _OnInitialize(argContainer As Container, argGrids As GridView)
    
    $menuBar = New NagatoMenuBarQueue(argContainer) As "MenuBar"
    $grids = New NagatoGridsQueue(argGrids) As "Grids"
    $queueObserver = New Observer(NagatoQueue) As "Asakura"
    
End

Public Sub MenuBar_Signal(argSignal As Integer, argVariables As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.ListUp, MikuruSignal.ListDown
            NagatoQueue(argSignal, $grids.Selection)
    End Select
    
End

Public Sub Asakura_Broadcast(argSignal As Integer, argValues As Variant[])
    
    If Not Object.IsValid($grids) Then Return
    
    Select argSignal
        Case MikuruSignal.BroadcastQueueChanged
            $grids.Refresh()
        Case MikuruSignal.BroadcastIndexMoved, MikuruSignal.BroadcastStateChanged
            $grids.RefreshPlaymark()
        Case MikuruSignal.BroadcastId3TagChanged
            $grids.RefreshRows(argValues)
        Case MikuruSignal.BroadcastSelectionChanged
            $grids.Refresh()
            $grids.RefreshSelection(argValues)
    End Select
    
End
