' Gambas class file

Private $coverArtPictureBox As PictureBox
Private $observer As Observer
Private $coverArtPath As String
Private $hasChanged As Boolean = False

Event Change

Public Sub Reset(argMusicPath As String)
    
    Dim yukiCoverArtPath As String = MikuruEyeD3.GetPicturePath(argMusicPath)
    
    $coverArtPictureBox.Picture = MikuruCroppedImage(yukiCoverArtPath, MikuruUx.CoverArt.H)
    $coverArtPath = ""
    
End

Public Sub SetCoverArt(argIndexes As String[])
    
    If $coverArtPath Then NagatoQueue.ChangeCoverArtByIndexes(argIndexes, $coverArtPath)
    
End

Public Sub _new(argSelectButton As Button, argPictureBox As PictureBox)
    
    Dim yukiObserverButton As New Observer(argSelectButton) As "Asakura"
    Dim yukiObserverPictureBox As New Observer(argPictureBox) As "Asakura"
    
    $coverArtPictureBox = argPictureBox
    
End

Public Sub Asakura_MouseDown()
    
    HaruhiAlbumArtSelect.Show()
    $observer = New Observer(HaruhiAlbumArtSelect) As "Asakura"
    
End

Public Sub Asakura_Select(argFullPath As String)
    
    $coverArtPath = argFullPath
    $coverArtPictureBox.Picture = MikuruCroppedImage(argFullPath, $coverArtPictureBox.H)
    If Not Error Then Raise Change
    
Catch
    Return
    
End
