' Gambas class file

Inherits NagatoSignal

Private $menuBar As NagatoMenuBarNowPlaying
Private $grids As NagatoGridsNowPlaying
Private $queueObserver As Observer

Event NewPlaylist

Private Sub saveAsPlaylist()
    
    If $grids.GetPaths().Count = 0 Then Return
    
    NagatoDBMedia.SaveAsPlaylist(MikuruDialog.PlaylistName, $grids.GetPaths())
    
    Raise NewPlaylist
    
End

Public Sub _new(argContainer As Container, argGrids As GridView)
    
    $menuBar = New NagatoMenuBarNowPlaying(argContainer) As "MenuBar"
    $grids = New NagatoGridsNowPlaying(argGrids) As "Grids"
    $queueObserver = New Observer(NagatoQueue) As "Asakura"
    
End

Public Sub MenuBar_Signal(argSignal As Integer, argVariables As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.ListSaveAs
            saveAsPlaylist()
    End Select
    
End

Public Sub Asakura_Changed()
    
    If Not Object.IsValid($grids) Then Return
    
    $grids.Refresh()
    
End

Public Sub Asakura_Moved()
    
    If Not Object.IsValid($grids) Then Return
    
    $grids.Refresh()
    
End

Public Sub Asakura_State()
    
    If Not Object.IsValid($grids) Then Return
    
    $grids.RefreshPlaymark()
    
End
