' Gambas class file

Inherits NagatoSignal

Private $grids As NagatoGridsNowPlaying
Private $queueObserver As Observer

Event NewPlaylist

Private Sub initializeStarMenu(argButton As MenuButton)
    
    Dim yukiMenu As New NagatoNowPlayingMenu As "StarMenu"
    
    argButton.Menu = yukiMenu.Name
    
End

Public Sub MoveTo(argUrl As String)
    
    $grids.MoveTo(argUrl)
    
End

Public Sub _new(argButton As MenuButton, argGrids As GridView)
    
    initializeStarMenu(argButton)
    $grids = New NagatoGridsNowPlaying(argGrids) As "Grids"
    $queueObserver = New Observer(NagatoQueue) As "Asakura"
    
End

Public Sub StarMenu_SavePlaylist()
    
    If $grids.GetPaths().Count = 0 Then Return
    
    NagatoDBMedia.SaveAsPlaylist(MikuruDialog.PlaylistName, $grids.GetPaths())
    
    Raise NewPlaylist
    
End

Public Sub Asakura_Changed()
    
    If Not Object.IsValid($grids) Then Return
    
    Debug "changed"
    
    $grids.Refresh()
    
End

Public Sub Asakura_State()
    
    If Not Object.IsValid($grids) Then Return
    
    $grids.RefreshPlaymark()
    
End
