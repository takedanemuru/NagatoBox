' Gambas class file

Inherits NagatoGrids

Property Read Selection As Integer[]

Private Enum ColumnIcon, ColumnTitle, ColumnDescription, ColumnCount, ColumnSpacer

Private Sub refreshData()
    
    Dim yukiResult As Result = NagatoDBPlaylists.GetAllIdResult()
    
    For Each yukiResult
        Inc Me._$grids.Rows.Count
        Me._SetGridData(ColumnTitle, yukiResult[NagatoDB.Column.PlaylistName])
        Me._SetGridDataRight(ColumnCount, NagatoDBPlaylists.GetCountByPlaylistId(yukiResult[NagatoDB.Column.Id]))
    Next
    
    Me._SetBackgroundStripe(Color.Lighter(Color.Pink))
    
End

Public Sub _InitializeGrids() 'override
    
    With Me._$grids
        .Columns.Count = 5
        .Columns[ColumnIcon].W = MikuruUx.Padding
        .Columns[ColumnTitle].Text = ("Name")
        .Columns[ColumnDescription].Text = ("Description")
        .Columns[ColumnCount].Text = ("Musics")
    End With
    
    If NagatoDBPlaylists.HasPlaylist() Then refreshData()

End

Public Sub Refresh()
    
    Me._$grids.Clear()
    Me._InitializeGrids()
    
End

Public Sub Asakura_Activate()
    
    Dim yukiPaths As String[]
    
    If Me._$grids.Rows.Selection.Count > 0 Then
        yukiPaths = NagatoDBPlaylists.GetMusicPathsInPlaylist(Me._GetSelectionText(ColumnTitle)[0])
        NagatoQueue.AddMusics(yukiPaths)
    Endif
    
End

Private Function Selection_Read() As Integer[]

    Return Me._$grids.Rows.Selection
    
Catch
    Return [-1]

End
