' Gambas class file

Inherits NagatoGrids

Private Enum ColumnIcon, ColumnTitle, ColumnDescription, ColumnCount, ColumnSpacer

Private Sub refreshData()
    
    Dim yukiResult As Result = NagatoDBPlaylists.GetAllIdResult()
    Dim yukiCount As Integer
    
    Debug yukiResult.Count
    
    For Each yukiResult
        Inc Me._$grids.Rows.Count
        Me._SetGridData(ColumnTitle, yukiResult[NagatoDB.Column.PlaylistName])
        yukiCount = NagatoDBPlaylists.GetCountByPlaylistId(yukiResult[NagatoDB.Column.Id])
        Me._SetGridDataRight(ColumnCount, yukiCount)
    Next
    
    Me._SetBackgroundStripe(MikuruColor.GridBackgroundPink)
    
End

Public Sub _InitializeGrids() 'override
    
    Me._SetColumns("", ("Name"), ("Description"), ("Musics"), "")
    Me._ResizeColumns(MikuruUx.Padding)
    
    If NagatoDBPlaylists.HasPlaylist() Then refreshData()

End

Public Sub Refresh()
    
    Me._$grids.Clear()
    Me._InitializeGrids()
    
End

Public Sub Asakura_Activate()
    
    Dim yukiPaths As String[]
    
    If Me._$grids.Rows.Selection.Count > 0 Then
        yukiPaths = NagatoDBPlaylists.GetMusicPathsInPlaylist(Me._GetSelectionText(ColumnTitle)[0])
        NagatoQueue.AddMusics(yukiPaths)
    Endif
    
End
