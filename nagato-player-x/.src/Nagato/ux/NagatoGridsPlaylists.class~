' Gambas class file

Inherits NagatoGrids

Private Enum ColumnIcon, ColumnTitle, ColumnDescription, ColumnCount, ColumnSpacer

Private Sub refreshData()
    
    Dim yukiResult As Result = NagatoDBPlaylists.GetAllIdResult()
    Dim yukiRow As Integer
    Dim yukiCount As Integer
    
    Me._$grids.Rows.Count = yukiResult.Count
    
    For Each yukiResult
        Me._SetGridData2(yukiRow, ColumnTitle, yukiResult[NagatoDB.Column.PlaylistName], Align.Left)
        yukiCount = NagatoDBPlaylists.GetCountByPlaylistId(yukiResult[NagatoDB.Column.Id])
        Me._SetGridData2(yukiRow, ColumnCount, yukiCount, Align.Right)
        Inc yukiRow
    Next
    
    Me._SetBackgroundStripe(MikuruColor.GridBackgroundPink)
    
End

Public Sub _InitializeGrids() 'override
    
    Me._SetColumns("", ("Name"), ("Description"), ("Musics"), "")
    Me._ResizeColumns(MikuruUx.Padding)
    
    If NagatoDBPlaylists.HasPlaylist() Then refreshData()

End

Public Sub Refresh()
    
    Me._$grids.Clear()
    Me._InitializeGrids()
    
End

Public Sub Asakura_Activate()
    
    Dim yukiPaths As String[]
    
    If Me._$grids.Rows.Selection.Count > 0 Then
        yukiPaths = NagatoDBPlaylists.GetMusicPathsInPlaylist(Me._GetSelectionText(ColumnTitle)[0])
        NagatoQueue(MikuruSignal.ListAddMusic, yukiPaths)
    Endif
    
End
