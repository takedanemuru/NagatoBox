' Gambas class file

Private $drawingArea As DrawingArea
Private $observer As Observer
Private $coverArt As New NagatoPainterGloobusCoverArt
Private $textMain As New NagatoPainterGloobusTextMain
Private $widgets As New NagatoPainterGloobusWidgets
Private $progressBar As New NagatoPainterGloobusProgressBar
Private $mouseTracker As NagatoGloobusMouseTracker

Public Sub _call(argSignal As Integer, argValues As Variant[])
    
    Select argSignal
        Case MikuruSignal.BroadcastIndexMoved, MikuruSignal.BroadcastNewCoverArt
            $coverArt.ResetCoverArt()
    End Select
    
    $drawingArea.Refresh()
    
End

Public Sub _new(argDrawinArea As DrawingArea)
    
    $coverArt.ResetCoverArt()
    $drawingArea = argDrawinArea
    $drawingArea.Tracking = True
    $observer = New Observer($drawingArea) As "DrawingArea"
    $mouseTracker = New NagatoGloobusMouseTracker($drawingArea) As "MouseTracker"
    
End

Public Sub MouseTracker_MouseMove()
    
    $drawingArea.Refresh()
    
End

Public Sub DrawingArea_Draw()
    
    Draw.Begin($drawingArea)
        $coverArt()
        If $mouseTracker.OnMouse Then $widgets($mouseTracker.Point.X, $mouseTracker.Point.Y)
        If Not $mouseTracker.OnMouse Then $textMain()
        $progressBar()
    Draw.End()
    
End
