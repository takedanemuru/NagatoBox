' Gambas class file

Inherits NagatoContextMenu

Private Enum MenuNone, MenuEdit, MenuAdd, MenuReplace, MenuDelete

Event Add
Event Replace
Event Edit

Public Sub _InitializeRootMenu()
    
    Me._$rootMenu = New Menu(HaruhiPlayList)
    Me._$rootMenu.Visible = False
    
End

Public Sub _InitializeChildMenus()
    
    Me._AddMenu(("Delete"), MenuDelete, "bin")
        Me._AddMenu("", MenuNone)
    Me._AddMenu(("Add to queue"), MenuAdd)
    Me._AddMenu(("Replace queue"), MenuReplace)
    
End

Public Sub PopUp()
    
    Me._$rootMenu.Popup()
    
End

Public Sub _new()
    
    Me._InitializeRootMenu()
    Me._InitializeChildMenus()
    
End

Public Sub MenuItem_Click()
    
    Select Case Last.Tag
        Case MenuEdit
            Raise Edit
        Case MenuAdd
            Raise Add
        Case MenuReplace
            Raise Replace
    End Select
    
End
