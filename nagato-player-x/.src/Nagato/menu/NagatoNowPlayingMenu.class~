' Gambas class file

Inherits NagatoStarMenu

Private Enum MenuAddMusic, MenuAddDirectory, MenuSaveAsPlaylist, MenuClear

Event SavePlaylist

Private Sub saveAsPlaylist()
    
    If HaruhiSaveAsPlaylist.ShowDialog() = MikuruDialog.ResponseApply Then
        Raise Signal(MikuruSignal.ListSaveAs, [""])
    End If
    
End

Public Sub _new()
    
    Me._InitializeRootMenu()
    Me._AddMenuItem(("Add music"), MenuAddMusic, "music")
    Me._AddMenuItem(("Add directory"), MenuAddDirectory, "folder")
    Me._AddMenuItem(("Save as playlist"), MenuSaveAsPlaylist, "hard-drive-download")
        Me._AddSpacer()
    Me._AddMenuItem(("Clear queue"), MenuClear, "bin")
        Me._AddSpacer()
    Me._AddAboutMenu()
        Me._AddSpacer()
    Me._AddClosePlaylistMenu()
    
End

Public Sub MenuItem_Click()
    
    Select Case Last.Tag
        Case MenuAddMusic
            MikuruDialog.AddMusic()
        Case MenuAddDirectory
            MikuruDialog.AddDirectory()
        Case MenuSaveAsPlaylist
            saveAsPlaylist()
        Case MenuClear
            NagatoQueue.ClearAll()
    End Select
    
End

Private Function Name_Read() As String

    Return "NowPlayingMenu"

End
