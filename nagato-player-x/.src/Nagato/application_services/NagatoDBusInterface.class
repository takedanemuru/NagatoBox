' Gambas class file

Inherits DBusObject

Create Static

Property Read ProgressInText As String

Public Sub AddMusics(argPaths As String[])
    
    NagatoQueue(MikuruSignal.ListAddMusic, argPaths)
    
End

Public Sub Play() 
    
    NagatoQueue(MikuruSignal.QueuePlay, Null)
    
End

Public Sub Pause() 
    
    NagatoQueue(MikuruSignal.QueuePause, Null)
    
End

Public Sub Back() 
    
    NagatoQueue(MikuruSignal.QueueBack, Null)
    
End

Public Sub Next() 
    
    NagatoQueue(MikuruSignal.QueueNext, Null)
    
End

Public Sub ToggleShuffle() 
    
    NagatoSettingsMusic.Shuffle = Not NagatoSettingsMusic.Shuffle
    
End

Public Sub ToggleRepeat()
    
    NagatoSettingsMusic.Repeat = Not NagatoSettingsMusic.Repeat
    
End

Public Sub PlayIndex(argIndex As Integer)
    
    NagatoQueue(MikuruSignal.QueSetIndexAndPlay, [argIndex])
    
End

Public Sub MoveToCurrentDesktop() 
    
    HaruhiPlayer.MoveToCurrentDesktop()
    
End

Public Function GetTitles(argMaxIndex As Integer) As String[]

    Dim yukiIndex As Integer
    Dim yukiTitles As New String[]
    
    For yukiIndex = 0 To NagatoQueue.GetProperty(MikuruProperty.ListMax) - 1
        If yukiIndex > argMaxIndex Then Break
        ' all titles must be quoted.
        ' because some charactors (for example "!") cause fatal error on DBus.
        yukiTitles.Add(Quote$(NagatoQueue[yukiIndex].Title))
    Next

    Return yukiTitles

End

Private Function ProgressInText_Read() As String

    Return NagatoQueue.GetProperty(MikuruProperty.CurrentDurationText)

End
