' Gambas class file

Inherits DBusObject

Create Static

Property Read Ready As String
Property Read Title As String
Property Read Artist As String
Property Read Album As String
Property Read ProgressInText As String
Property Read Paths As String[]
Property Read Queue As Collection
Property Read Shuffle As Boolean
Property Read Repeat As Boolean

Public Function AddMusics(argMusics As String[]) As Boolean
    
    NagatoQueue.AddMusics(argMusics)
    
    Return True
    
End

Public Function Play() As Boolean
    
    NagatoQueue.ChannelPlayControl.Play()
    
    Return True
    
End

Public Function Pause() As Boolean
    
    NagatoQueue.ChannelPlayControl.Pause()
    
    Return True
    
End

Public Function Back() As Boolean
    
    NagatoQueue.ChannelPlayControl.Back()
    
    Return True
    
End

Public Function Next() As Boolean
    
    NagatoQueue.ChannelPlayControl.Next()
    
    Return True
    
End

Public Function ToggleShuffle() As Boolean
    
    NagatoSettingsMusic.Shuffle = Not NagatoSettingsMusic.Shuffle
    
    Return True
    
End

Public Function ToggleRepeat() As Boolean
    
    NagatoSettingsMusic.Repeat = Not NagatoSettingsMusic.Repeat
    
    Return True
    
End

Public Function PlayPathInQueue(argPath As String) As Boolean
    
    If Not NagatoQueue.ChannelList.Paths.Exist(argPath) Then Return False

    NagatoQueue.ChannelPlayControl.SetPathAndPlay(argPath)
    Return True
    
End

Public Function MoveToCurrentDesktop() As Boolean
    
    Dim yukiDesktopWindow As DesktopWindow
    
    yukiDesktopWindow = New DesktopWindow(HaruhiPlayer.Id)
    yukiDesktopWindow.Desktop = Desktop.Current
    
    Return True
    
Catch
    Return False
    
End

Public Function GetTitle(argPath As String) As String
    
    Return NagatoQueue.ChannelList.Collection[argPath]
    
End

Private Function Ready_Read() As String

    Return "Can you see this ?"

End

Private Function Title_Read() As String

    Return NagatoQueue.ChannelTags.Get(MikuruTag.Title)

End

Private Function ProgressInText_Read() As String

    Return NagatoQueue.ChannelPlayState.ProgressText

End

Private Function Artist_Read() As String

    Return NagatoQueue.ChannelTags.Get(MikuruTag.Artist)

End

Private Function Album_Read() As String

    Return NagatoQueue.ChannelTags.Get(MikuruTag.Album)

End

Private Function Paths_Read() As String[]

    Return NagatoQueue.ChannelList.Paths

End

Private Function Queue_Read() As Collection

    Return NagatoQueue.ChannelList.Collection

End

Private Function Shuffle_Read() As Boolean

    Return NagatoSettingsMusic.Shuffle

End

Private Function Repeat_Read() As Boolean

    Return NagatoSettingsMusic.Repeat

End
