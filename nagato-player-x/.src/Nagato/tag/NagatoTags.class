' Gambas class file

Property Read Path As String
Property Read Title As String
Property Read Artist As String
Property Read Album As String
Property Read Duration As Float

Private $path As String
Private $duration As Float
Private $id3TagInfo As NagatoId3TagInfo

Private Sub setTagFromDatabase(argPath As String)
    
    Dim yukiResult As Result = NagatoDBMedia.GetMusicResultByPath(argPath)
    
    With NagatoDB
        $id3TagInfo.Title = yukiResult[.Column.Title]
        $id3TagInfo.Artist = yukiResult[.Column.Artist]
        $id3TagInfo.Album = yukiResult[.Column.Album]
        $duration = yukiResult[.Column.Duration]
    End With
    
End

Private Sub setId3Tags()
    
    If NagatoDBMedia.HasLibrary($path) Then 
        $id3TagInfo = New NagatoId3TagInfo
        setTagFromDatabase($path)
    Else
        $id3TagInfo = MikuruId3TagInfo($path)
    End If
    
End

Public Sub SetTag(argPath As String)
    
    $path = argPath
    setId3Tags()
    If $duration = 0 Then $duration = MikuruDuration.GetDuration(argPath)
    
End

Private Function Title_Read() As String

    If Not $id3TagInfo.Title Then Return File.BaseName($path)

    Return $id3TagInfo.Title

End

Private Function Artist_Read() As String

    Return $id3TagInfo.Artist

End

Private Function Album_Read() As String

    Return $id3TagInfo.Album

End

Private Function Duration_Read() As Float

    Return $duration

End

Private Function Path_Read() As String

    Return $path

End
