' Gambas module file

Private Sub activateMusicQueue()
    
    Dim yukiPaths As String[] = NagatoArguments.Paths
    
    If yukiPaths.Count > 0 Then
        NagatoQueue.Activate(yukiPaths)
        HaruhiPlayer.Show()
        NagatoQueue.Play()
        Return
    Endif
    
Finally
    NagatoQueue.Activate()
    HaruhiPlayer.Show() 
    
End

Public Sub Main()
    
    MikuruMediaStatus()
    
    If NagatoDBus.IsUnique() Then
        NagatoArguments.Parsing()
        activateMusicQueue() 'and show HaruhiPlayer 
    Else
        NagatoDBus.Proxy.MoveToCurrentDesktop()
    End If
    
End
