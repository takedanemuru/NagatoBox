' Gambas class file

Private $coverArtPath As String
Private $observer As Observer
Private $element As NagatoMusicElement
Private $index As Integer
Private $handlerCoverArt As NagatoTagEditHandlerCoverArt

Private Sub setTags()
    
    TitleTextBox.Text = $element.Title
    ArtistTextBox.Text = $element.Artist
    AlbumTextBox.Text = $element.Album
    
End

Private Function getNewTag() As NagatoId3TagInfo
    
    Dim yukiTags As New NagatoId3TagInfo
    
    yukiTags.Title = TitleTextBox.Text
    yukiTags.Artist = ArtistTextBox.Text
    yukiTags.Album = AlbumTextBox.Text
    
    Return yukiTags
    
End

Public Sub EditByTagIndex(argIndex As Integer)
    
    $index = argIndex
    $element = NagatoQueue[argIndex]
    setTags()
    $handlerCoverArt.Reset($element.Path)
    Me.Center()
    ApplyButton.Enabled = False
    Me.ShowDialog()
    
End

Public Sub _new()
    
    $handlerCoverArt = New NagatoTagEditHandlerCoverArt(IconSelectButton, AlbumArtPictureBox) As "Asakura"
    
End

Public Sub CancelButton_Click()

    Me.Close()

End

Public Sub ApplyButton_Click()
    
    NagatoQueue.EditTagsByTagIndexes([$index], getNewTag())
    If $handlerCoverArt.CoverArtPath Then NagatoQueue.ChangeCoverArtByIndexes([$index], $handlerCoverArt.CoverArtPath)
    
    Me.Close()
    
End

Public Sub TextBox_Change()

    ApplyButton.Enabled = True

End

Public Sub Asakura_Change()
    
    ApplyButton.Enabled = True
    
End
