' Gambas class file

Private $nowPlayingTab As NagatoTabNowPlaying
Private $playlistsTab As NagatoTabPlaylists
Private $albumsTab As NagatoTabAlbums
Private $libraryTab As NagatoTabLibrary
Private $observer As Observer

Public Sub _new()

    NagatoSettingsForm.Load(Me)
    
    $nowPlayingTab = New NagatoTabNowPlaying(StarButtonNowPlaying, NowPlayingGrid) As "NowPlayingTab"
    $playlistsTab = New NagatoTabPlaylists(StarButtonPlaylists, PlaylistsGrid) As "PlaylistsGrids"
    $albumsTab = New NagatoTabAlbums(AlbumsStarButton, AlbumsIconView) As "AlbumsTab"
    $libraryTab = New NagatoTabLibrary(LibraryStarButton, LibraryGrids) As "LibraryTab"
    
    $observer = New Observer(NagatoQueue) As "Asakura"
    
End

Public Sub Form_Show()
    
    Dim yukiDesktopWindow As New DesktopWindow(Me.Id)
    
    yukiDesktopWindow.Desktop = Desktop.Current
    
End

Public Sub Form_Close()
    
    NagatoQueue.SavePaths()
    NagatoSettingsForm.Save(Me)
    
End

Public Sub Asakura_Moved()
    
    $nowPlayingTab.MoveTo(NagatoQueue[NagatoQueue.CurrentIndex].Path)
    
End
