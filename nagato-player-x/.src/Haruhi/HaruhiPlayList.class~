' Gambas class file

Private $observer As Observer
Private $gridsPlaylist As NagatoGridsPlaylist
Private $gridsPlaylists As NagatoGridsPlaylists

Public Sub MoveTo(argUrl As String)
    
    $gridsPlaylist.MoveTo(argUrl)
    
End

Public Sub _new()

    Dim yukiMenu As New NagatoPlaylistMenu As "PlaylistMenu"

    MenuButton.Menu = yukiMenu.Name

    $observer = New Observer(NagatoQueue) As "Asakura"
    NagatoSettingsForm.Load(Me)
    
    $gridsPlaylist = New NagatoGridsPlaylist(PlaylistGrid)
    $gridsPlaylists = New NagatoGridsPlaylists(PlaylistsGrid)

End

Public Sub Form_Close()
    
    NagatoSettingsMusic.SavePaths(NagatoQueue.Paths)
    NagatoSettingsForm.Save(Me)
    
End

Public Sub PlaylistGrid_Activate()
    
    Object.Lock($observer)
        NagatoQueue.SetPathAndPlay(NagatoQueue.Paths[PlaylistGrid.Row])
        $gridsPlaylist.SetMark(PlaylistGrid.Row)
    Object.Unlock($observer)
    
End

Public Sub PlaylistMenu_SavePlaylist()
    
    Debug MikuruDialog.PlaylistName
    Debug $gridsPlaylist.GetPaths().Count
    Debug $gridsPlaylist.GetPaths()[3]
    
End

Public Sub Asakura_Changed()
    
    $gridsPlaylist.Refresh()
    
End
