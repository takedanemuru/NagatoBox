' Gambas class file

Private Sub setFormPicture()
    
    Dim yukiImage As Image = Image.Load("Pictures/archive.jpg")
    
    Me.Picture = yukiImage.Stretch(Me.W, Me.H).Picture
    
End

Public Sub Form_Open()
    
    SaveButton.Enabled = False
    
    Me.Center()
    setFormPicture()
    PlaylistNamesComboBox.List = NagatoDBPlaylists.GetAllNames()
    PlaylistNamesComboBox.Add(("Input or select Playlist name"), 0)
    DescriptionTextBox.Text = ""
    
End

Public Sub PlaylistNamesComboBox_Enter()

    Object.Lock(PlaylistNamesComboBox)
        PlaylistNamesComboBox.Text = ""
    Object.Unlock(PlaylistNamesComboBox)

End

Public Sub PlaylistNamesComboBox_Change()
    
    SaveButton.Enabled = True
    
End

Public Sub CancelButton_Click()

    Me.Close()

End

Public Sub SaveButton_Click()

    If PlaylistNamesComboBox.Text = "" Then Return

    NagatoQueue(MikuruSignal.ListSaveAs, [PlaylistNamesComboBox.Text, DescriptionTextBox.Text])
    Me.Close()

End
