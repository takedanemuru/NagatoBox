' Gambas module file

Private Function isLesser(argSortAscend As Boolean, argDataA As String, argDataB As String) As Boolean
    
    If argSortAscend Then
        Return argDataA > argDataB
    Else
        Return argDataB > argDataA
    Endif
    
End

Private Function getData(argType As Integer, argElement As NagatoMusicElement) As String
    
    Select Case argType
        Case 1
            Return argElement.Title
        Case 2
            Return argElement.Artist
        Case 3
            Return argElement.Album
    End Select
    
End

Public Function AddNowPlaying(argType As Integer, argSortAscend As Boolean, argElement As NagatoMusicElement, argElements As NagatoMusicElement[]) As NagatoMusicElement[]
    
    Dim yukiCount As Integer
    Dim yukiResult As New NagatoMusicElement[]
    
    If Not argElements Then
        Debug "return first value"
        yukiResult.Add(argElement)
        Return yukiResult
    Else
        yukiResult = argElements.Copy()
    Endif
    
    For yukiCount = 0 To argElements.Max
        If isLesser(argSortAscend, getData(argType, argElement), getData(argType, argElements[yukiCount])) Then
            yukiResult.Add(argElement, yukiCount)
            Return yukiResult
        Endif
    Next
    
End

