' Gambas class file

Private $painter As NagatoPainterGloobus
Private $observer As Observer
Private $contextMenu As NagatoContextMenuFormCoverArtMode

Public Sub _new()
    
    $contextMenu = New NagatoContextMenuFormCoverArtMode(Me)
    
End

Public Sub SetTitle(argTitle As String)
    
    Dim yukiWindow As New DesktopWindow(Desktop.ActiveWindow)
    
    If Me.SkipTaskbar And If Desktop.Current = yukiWindow.Desktop Then 
        Me.Title = " "
    Else
        Me.Title = argTitle
    End If
    
End

Public Sub Form_Open()
    
    Me.Title = " "
    Me.Resizable = False
    
    $painter = New NagatoPainterGloobus(DrawingArea1)
    $observer = New Observer(NagatoBroadcast) As "Asakura"
    
    NagatoSettingsForm.LoadGloobusForm(Me)
    
End

Public Sub Form_Close()
    
    If NagatoSettingsForm.Main = NagatoSettingsForm.HCoverArt Then NagatoDBus.Unregister()
    NagatoSettingsForm.SaveGloobusForm(Me)
    
End

Public Sub Form_Menu()
    
    $contextMenu.PopUp()
    
End

Public Sub Form_Activate()
    
    Me.SkipTaskbar = True
    
End

Public Sub Form_Deactivate()
    
    Me.SkipTaskbar = False
    
End

Public Sub Asakura_Broadcast(argSignal As Integer, argValues As Variant[])
    
    $painter(argSignal, argValues)
    
End
