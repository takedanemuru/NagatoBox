' Gambas class file

Private $grids As GridView

Private Sub initializeGrids(argContainer As Container)
    
    $grids = New GridView(argContainer)
    
    With $grids
        .Expand = True
        .Columns.Count = 2
        .Columns[0].W = 100
        .Rows.Count = 3
    End With
    
End

Private Sub setRowData(argIndex As Integer, argSubject As String, argData As String)
    
    With $grids
        .[argIndex, 0].Text = argSubject
        .[argIndex, 1].Alignment = Align.Right
        .[argIndex, 1].Text = argData 
    End With
    
End

Private Sub setData()
    
    Dim yukiOutput As String
    Dim yukiData As String[]
    
    Shell "xset q|grep Standby" To yukiOutput
    
    yukiData = Split(Replace$(yukiOutput, "\n", ""), "   ", "", True, False)

    setRowData(0, ("Standby"), yukiData[1])
    setRowData(1, ("Suspend"), yukiData[3])
    setRowData(2, ("Off"), yukiData[5])

    ' With $grids
    '     .[0, 0].Text = ("Standby")
    '     .[0, 1].Alignment = Align.Right
    '     .[0, 1].Text = (yukiData[1]) 
    '     
    '     .[1, 0].Text = ("Suspend")
    '     .[1, 1].Alignment = Align.Right
    '     .[1, 1].Text = (yukiData[3]) 
    '     
    '     .[2, 0].Text = ("Off")
    '     .[2, 1].Alignment = Align.Right
    '     .[2, 1].Text = (yukiData[5])
    ' End With
    
End

Public Sub _new(argContainer As Container)
    
    initializeGrids(argContainer)
    setData()
    
End
