' Gambas class file

Private $grids As GridView

Private Sub initializeGrids(argContainer As Container)
    
    $grids = New GridView(argContainer)
    
    With $grids
        .Expand = True
        .Columns.Count = 2
        .Columns[0].W = 100
        .Rows.Count = 3
    End With
    
End

Private Sub setRowData(argIndex As Integer, argSubject As String, argData As String)
    
    With $grids
        .[argIndex, 0].Text = argSubject
        .[argIndex, 1].Alignment = Align.Right
        .[argIndex, 1].Text = argData 
    End With
    
End

Private Sub setData()
    
    Dim yukiOutput As String
    Dim yukiData As String[]
    
    Shell "xset q|grep Standby" To yukiOutput
    
    yukiData = Split(Replace$(yukiOutput, "\n", ""), "   ", "", True, False)

    setRowData(0, ("Standby"), yukiData[1])
    setRowData(1, ("Suspend"), yukiData[3])
    setRowData(2, ("Off"), yukiData[5])
    
End

Public Sub _new(argContainer As Container)
    
    initializeGrids(argContainer)
    setData()
    
End
