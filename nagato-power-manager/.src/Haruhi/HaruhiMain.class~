' Gambas class file

Private Sub setDisplayTabStrip()
    
    Dim yukiDisplayProperty As NagatoDisplayProperty
    Dim yukiOutput As String
    Dim yukiData As String[]
    
    Shell "xset q|grep Standby" To yukiOutput
    
    yukiData = Split(Replace$(yukiOutput, "\n", ""), "   ", "", True, False)

    Debug yukiData[0]
    Debug yukiData[1]
    Debug yukiData[2]
    Debug yukiData[3]
    Debug yukiData[4]
    Debug yukiData[5]
    
    DeviceTabs.Text = ("Display")
    DeviceTabs.Picture = MikuruIcon.Get("monitor")
    yukiDisplayProperty = New NagatoDisplayProperty(DeviceTabs)
    
End

Private Sub setDevicesTabStrip()
    
    Dim yukiDeviceIndex As Integer
    Dim yukiProperty As NagatoDeviceProperty
    
    For yukiDeviceIndex = 0 To NagatoUPower.Count - 1
        Inc DeviceTabs.Count
        With NagatoUPower.Devices[yukiDeviceIndex]
            DeviceTabs.Index = yukiDeviceIndex + 1
            DeviceTabs.Text = File.Name(.NativePath)
            DeviceTabs.Picture = MikuruDataTypes.GetDeviceIcon(.Type)
            yukiProperty = New NagatoDeviceProperty(DeviceTabs, yukiDeviceIndex)
        End With
    Next
    
End

Public Sub Form_Open()
    
    setDisplayTabStrip()
    setDevicesTabStrip()
    
    Me.Center()
    
End
