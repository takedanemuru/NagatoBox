' Gambas class file

Property Read IsSelected As Boolean

Private $timer As New Timer As "Timer"
Private $starButton As NagatoStarButton
Private $systemGraph As NagatoSystemGraph
Private $systemLabel As NagatoSystemLabel
Private $systemGrids As NagatoGridsProcess

Private Sub initializeUserInterface()
    
    $systemGrids = New NagatoGridsProcess(SystemMonitorGrid) As "UserInterface"
    $starButton = New NagatoStarButton(HBox1) As "UserInterface"
    $systemGraph = New NagatoSystemGraph(GraphArea)
    $systemLabel = New NagatoSystemLabel(SystemLabel)
    
End

Public Sub Form_Open()
    
    Application.MainWindow = Me
    NagatoSettings.LoadFormSettings(Me)
    NagatoObserverFacade.Activated = True
    initializeUserInterface()
    
    $timer.Start()
    
End

Public Sub Form_Close()
    
    NagatoObserverFacade.Activated = False
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub Timer_Timer()
    
    $systemGraph.Refresh()
    $systemLabel.Refresh()
    $systemGrids.Refresh()
    
End

Public Sub UserInterface_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.ProcessUnselect
            $systemGrids.Unselect()
        Case MikuruSignal.ProcessKill
            MikuruKillProcess($systemGrids.LastSelectedId, $systemGrids.LastSelectedName)
        Case MikuruSignal.ApplicationAbout
            HaruhiAbout.ShowDialog()
        Case MikuruSignal.ApplicationQuit
            Me.Close()
    End Select
    
End

Private Function IsSelected_Read() As Boolean

    If $systemGrids.LastSelectedId = "" Then 
        Return False
    Else
        Return True
    Endif

End
