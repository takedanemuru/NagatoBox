' Gambas class file

Inherits NagatoMenu

Private Sub initializeRootMenu(argButton As MenuButton)
    
    Me._$rootMenu = New Menu(HaruhiMain) As "RootMenu"
    
    Me._$rootMenu.Name = "RootMenu"
    argButton.Menu = Me._$rootMenu.Name
    
End

Private Sub addProcessMenu()
    
    Me._AddMenu(("Unselect"), MikuruSignal.ProcessUnselect)
    Me._AddMenu(("Kill selected process"), MikuruSignal.ProcessKill, "exclamation")
    Me._AddMenu((""), MikuruSignal.None)
    
End

Private Sub initializeChildMenus()

    If HaruhiMain.IsSelected Then addProcessMenu()
    Me._AddMenu(("About nagato-taskmanager"), MikuruSignal.ApplicationAbout, "star")
    Me._AddMenu(("Quit"), MikuruSignal.ApplicationQuit, "button-power")
    
End

Public Sub _new(argButton As MenuButton)
    
    initializeRootMenu(argButton)
    initializeChildMenus()
    
End

Public Sub RootMenu_Show()
    
    Me._$rootMenu.Children.Clear()
    initializeChildMenus()
    
End
