' Gambas class file

Inherits NagatoObject

Property Read Lock As Boolean

Public _$gridView As GridView
Public _$observer As Observer

Private $lock As Boolean = False

Event ColumnClick(argColumnIndex As Integer)

Private Sub popUpKillMenu()
    
    Dim yukiMenu As New NagatoContextMenuGrids(HaruhiMain) As "TFEI"
    
    yukiMenu.Popup()
    
End

Public Sub _new(argGridView As GridView)
    
    Me._$gridView = argGridView
    Me._$observer = New Observer(argGridView) As "Asakura"
    
End

Public Sub Asakura_ColumnClick(argColumnIndex As Integer)

    Raise ColumnClick(argColumnIndex)
    
End

Public Sub Asakura_MouseDown()
    
    With Me._$gridView
        If 0 > .RowAt(Mouse.Y) Then Return
        MikuruProcessTemporaryVariables.SetSelectedProcess(.[.Row, 0].Text, .[.Row, 2].Text)
    End With
    
    If Mouse.Right Then popUpKillMenu()

End

Public Sub Asakura_Enter()
    
    $lock = True
    Me._$gridView.ScrollBar = Scroll.Vertical
    
End

Public Sub Asakura_Leave()
    
    $lock = False
    Me._$gridView.ScrollBar = Scroll.None
    
End

Public Sub Asakura_ColumnResize(argColumnIndex As Integer)
    
    NagatoSettings.SaveGridsSettings(Me._$gridView)
    
End

Private Function Lock_Read() As Boolean

    Return $lock

End
