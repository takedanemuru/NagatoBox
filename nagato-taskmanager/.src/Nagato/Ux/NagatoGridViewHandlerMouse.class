' Gambas class file

Inherits NagatoGridViewHandler

Property Read LastSelectedId As String
Property Read LastSelectedName As String
Property Read Lock As Boolean

Private $selection As New NagatoSelection
Private $lock As Boolean = False

Event ColumnClick(argColumnIndex As Integer)

Private Sub popUpKillMenu()
    
    Dim yukiMenu As New NagatoContextMenuGrids(HaruhiMain) As "TFEI"
    
    yukiMenu.Popup()
    
End

Public Sub Unselect()
    
    $selection.Clear()
    
End

Public Sub _new(argGridView As GridView)
    
    Me._Initialize(argGridView)
    
End

Public Sub Asakura_ColumnClick(argColumnIndex As Integer)

    Raise ColumnClick(argColumnIndex)
    
End

Public Sub Asakura_MouseDown()
    
    With Me._$gridView
        If .RowAt(Mouse.Y) > -1 Then $selection.Set(.[.Row, 0].Text, .[.Row, 2].Text)
    End With
    
    If Mouse.Right Then popUpKillMenu()

End

Public Sub Asakura_Enter()
    
    $lock = True
    
End

Public Sub Asakura_Leave()
    
    $lock = False
    
End

Public Sub Asakura_ColumnResize(argColumnIndex As Integer)
    
    NagatoSettings.SaveGridsSettings(Me._$gridView)
    
End

Private Function LastSelectedId_Read() As String

    Return $selection.Id

End

Private Function LastSelectedName_Read() As String

    Return $selection.Name

End

Private Function Lock_Read() As Boolean

    Return $lock

End
