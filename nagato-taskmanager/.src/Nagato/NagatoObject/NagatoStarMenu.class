' Gambas class file

Inherits NagatoMenu

Private Sub initializeRootMenu(argButton As MenuButton)
    
    Me._$rootMenu = New Menu(HaruhiMain) As "RootMenu"
    
    Me._$rootMenu.Name = "RootMenu"
    argButton.Menu = Me._$rootMenu.Name
    
End

Private Sub addProcessMenu()
    
    Object.New("NagatoMenuItemUnselectProcess", [Me._$rootMenu])
    Object.New("NagatoMenuItemKillSelectedProcess", [Me._$rootMenu])
    Me._AddMenu((""), MikuruSignal.None)
    
End

Private Sub initializeChildMenus()

    If MikuruProcessTemporaryVariables.HasSelectedProcess() Then addProcessMenu()
    Object.New("NagatoMenuItemAbout", [Me._$rootMenu])
    Object.New("NagatoMenuItemQuit", [Me._$rootMenu])
    
End

Public Sub _new(argButton As MenuButton)
    
    initializeRootMenu(argButton)
    initializeChildMenus()
    
End

Public Sub RootMenu_Show()
    
    Me._$rootMenu.Children.Clear()
    initializeChildMenus()
    
End
