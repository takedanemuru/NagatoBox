' Gambas class file

Property Activated As Boolean

Private Const SystemSnapShotInterval As Integer = 1000 ' milliseconds

Private $timer As Timer
Private $observationStep As Integer

Event PreparationStep
Event Step

Public Sub _new()
    
    $timer = New Timer As "Timer"
    $timer.Delay = SystemSnapShotInterval
    $timer.Start()
    
End

Public Sub Timer_Timer()
    
    If $observationStep = 0 Then
        Raise PreparationStep
        Inc $observationStep
    Else
        Raise Step
    Endif
    
End

Private Function Activated_Read() As Boolean

    Return $timer.Enabled

End

Private Sub Activated_Write(Value As Boolean)

    $timer.Enabled = Value

End
