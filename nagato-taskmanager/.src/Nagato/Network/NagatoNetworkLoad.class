' Gambas class file

Create Static

Property Read ReceiveTotal As Integer
Property Read ReceiveBps As Float
Property Read ReceiveBpsHistory As Float[]
Property Read TransmitTotal As Integer
Property Read TransmitBps As Float
Property Read TransmitBpsHistory As Float[]
Property Read Max As Float

Private $streamReader As New NagatoNetworkStreamReader
Private $receiveHistory As New NagatoHistory
Private $transmitHistory As New NagatoHistory
Private $timer As New Timer As "Timer"

Private Sub tick()
    
    $streamReader.Refresh()
    
    $receiveHistory.Push($streamReader.ReceiveBytes)
    $transmitHistory.Push($streamReader.TransmitBytes)
    
End

Public Sub Start()
    
    $timer.Delay = 1000
    $timer.Start()
    
End

Public Sub Stop()
    
    $timer.Stop()
    
End

Public Sub Timer_Timer()
    
    tick()
    
End

Private Function ReceiveTotal_Read() As Integer

    Return $streamReader.ReceiveTotal

End

Private Function ReceiveBps_Read() As Float


    Return $streamReader.ReceiveBytes * 8

End

Private Function TransmitTotal_Read() As Integer

    Return $streamReader.TransmitTotal 

End

Private Function TransmitBps_Read() As Float

    Return $streamReader.TransmitBytes * 8

End

Private Function ReceiveBpsHistory_Read() As Float[]

    Return $receiveHistory.History

End

Private Function TransmitBpsHistory_Read() As Float[]

    Return $transmitHistory.History

End

Private Function Max_Read() As Float

    Return Max($receiveHistory.Max, $transmitHistory.Max)

End
