' Gambas class file

Property Read Collection As Collection

Private $downloader As NagatoDownloaderText
Private $xmlParser As NagatoXmlParser 

Event Finished

Public Function GetUrl(argTitle As String) As String
    
    Return $xmlParser.GetUrl(argTitle)
    
End

Public Sub _new()
    
    $xmlParser = New NagatoXmlParser As "XmlParser"
    $downloader = New NagatoDownloaderText(MikuruUrl.Haramaru) As "Downloader"
    
End

Public Sub Downloader_Finished()
    
    $xmlParser.Parse($downloader.Buffer)
    
End

Public Sub XmlParser_Finished()
    
    Raise Finished
    
End

Private Function Collection_Read() As Collection

    Return $xmlParser.Collection

End
