' Gambas class file

Private $downloader As NagatoDownloader
Private $xmlParser As New NagatoXmlParser As "XmlParser"
Private $stream As Process

Public Sub Form_Open()

    If Not Desktop.NetworkAvailable Then
        Message.Warning("YUKI.N > Network not available.")
    Else
        Application.MainWindow = Me
        Me.Center()
        $downloader = New NagatoDownloader As "Downloader"
    Endif

End

Public Sub Form_Close()
    
    Try $stream.Kill()
    
    Quit 0
    
End

Public Sub Downloader_Finished()
    
    $xmlParser.Parse($downloader.Buffer)
    
End

Public Sub XmlParser_Finished()
    
    Dim yukiValue As String
    Dim yukiCollection As Collection = $xmlParser.Collection
    
    For Each yukiValue In yukiCollection
        MainListView.Add(yukiValue, yukiCollection.Key)
    Next
    
End

Public Sub MainListView_DblClick()

    Try $stream.Kill()

    $stream = Exec ["mplayer", MainListView.Key] 

End

Public Sub Process_Read()

    

End
