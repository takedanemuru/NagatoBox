' Gambas class file

Private $iconSizes As String[] = ["huge", "large", "medium", "small"]

Private Sub refreshIconView(argIconSizeIndex As Integer)
        
        Dim yukiItemName As String
        
        IconView1.Clear()
        
        For Each yukiItemName In Stock.List
                IconView1.Add(yukiItemName, yukiItemName, Stock[Subst$("&1/&2", $iconSizes[argIconSizeIndex], yukiItemName)])
        Next
        
End

Public Sub _new()

End

Public Sub Form_Open()

        NagatoSettings.LoadFormSettings(Me)
        NagatoSettings.LoadIconSizeSettings(ComboBox1)
        refreshIconView(ComboBox1.Index)

End

Public Sub Form_Close()
        
        NagatoSettings.SaveFormSettings(Me)
        
End

Public Sub ComboBox1_Change()
        
        Debug ComboBox1.Index
        
        refreshIconView(ComboBox1.Index)
        NagatoSettings.SaveIconSizeSettings(ComboBox1)
        
End
