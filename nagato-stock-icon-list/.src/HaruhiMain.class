' Gambas class file

Private $iconSizes As String[] = ["huge", "large", "medium", "small"]

Private Sub refreshIconView(argIconSizeIndex As Integer)
    
    Dim yukiItemName As String
    
    IconView1.Clear()
    
    For Each yukiItemName In Stock.Icons
            IconView1.Add(yukiItemName, yukiItemName, Stock[Subst$("&1/&2", $iconSizes[argIconSizeIndex], yukiItemName)])
    Next
        
End

Private Sub refreshNagatoIconView()
    
    Dim yukiName As String
    
    NagatoIconView.Clear()
    
    For Each yukiName In MikuruIcon.List
        NagatoIconView.Add(yukiName, yukiName, MikuruIcon.Get(yukiName, 48))
    Next
    
End

Public Sub Form_Open()

        NagatoSettings.LoadFormSettings(Me)
        NagatoSettings.LoadIconSizeSettings(ComboBox1)
        refreshIconView(ComboBox1.Index)
        refreshNagatoIconView()

End

Public Sub Form_Close()
        
    NagatoSettings.SaveFormSettings(Me)
        
End

Public Sub ComboBox1_Click()

    refreshIconView(ComboBox1.Index)
    NagatoSettings.SaveIconSizeSettings(ComboBox1)

End
