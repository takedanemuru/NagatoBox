' Gambas class file

Private $pictureSelector As NagatoPictureSelector
Private $picture As Picture

Private Sub initializeStockIconView()
    
    Dim yukiKey As String 
    
    StockIconView.Clear()
    
    For Each yukiKey In Stock.Icons.Sort()
        StockIconView.Add(yukiKey, yukiKey, Stock[Subst$("huge/&1", yukiKey)])
    Next
    
End

Public Sub addSelectIconView()
    
    TabStrip1.Index = 1
    $pictureSelector = New NagatoPictureSelector(TabStrip1) As "PictureSelector"
    
End

Public Sub Form_Open()
    
    initializeStockIconView()
    addSelectIconView()
    TabStrip1.Index = 0
    Me.Center()
    
End

Public Sub StockIconView_Activate()
    
    $picture = Stock[Subst$("huge/&1", StockIconView.Key)]
    
    MikuruDialogResponse.NewPicture = $picture
    
    Me.Close(MikuruDialogResponse.ResponseApply)
    
End

Public Sub PictureSelector_Select(argFullPath As String)
    
    $picture = Image.Load(argFullPath).Stretch(128, 128).Picture
    
    MikuruDialogResponse.NewPicture = $picture
    
    Me.Close(MikuruDialogResponse.ResponseApply)
    
End
