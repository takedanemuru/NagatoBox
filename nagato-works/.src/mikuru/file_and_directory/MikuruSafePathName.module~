' Gambas module file

Private Function getNewName(argPath As String, argCounter As String) As String
    
    Dim yukiDirectory As String = File.Dir(argPath)
    Dim yukiBaseName As String = File.BaseName(argPath)
    Dim yukiExtention As String = File.Ext(argPath)
    
    Return Subst$("&1/&2(&3).&4", yukiDirectory, yukiBaseName, argCounter, yukiExtention)
    
End

Public Function GetName(argParentDirectoryName As String, argTargetFileName As String) As String 
    
    Dim yukiCounter As Integer = 0
    Dim yukiPath As String = argParentDirectoryName &/ argTargetFileName
    
    If Not Exist(yukiPath) Then Return (yukiPath)

    Do 
        Inc yukiCounter
        yukiNewName = getNewName(yukiPath, yukiCounter)
        If Not Exist(yukiNewName) Then Return yukiNewName
    Loop
    
End

