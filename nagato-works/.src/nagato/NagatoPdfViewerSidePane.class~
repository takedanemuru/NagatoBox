' Gambas class file

Inherits NagatoMainPane

Private $listView As ListView

Event PageJump(argPage As Integer)

Private Sub addListView()
    
    $listView = New ListView(Me._$parent) As "ListView"
    
    With $listView
        .Expand = True
        .Background = Color.Background
    End With
    
End

Private Function getThumbnail(argImage As Image) As Picture
    
    Dim yukiRate As Float = Max(128 / argImage.H, 128 / argImage.W)
    
    Return argImage.Stretch(argImage.W * yukiRate, argImage.H * yukiRate).Picture
    
End

Public Sub SetThumbnails(argPdfDocument As PdfDocument)
    
    Dim yukiCount As Integer
    
    For yukiCount = 1 To argPdfDocument.Count
        '$listView.Add(yukiCount, Subst$("page &1", yukiCount), getThumbnail(argPdfDocument[yukiCount].Image))
        $listView.Add(yukiCount, Subst$("page &1", yukiCount))
    Next
    
End

Public Sub _Initialize(argPath As String) 'override.
    
    Dim yukiPdfDocument As New PdfDocument
    
    yukiPdfDocument.Open(argPath)
    
    addListView()
    SetThumbnails(yukiPdfDocument)
    
End

Public Sub ListView_Activate()
    
    Raise PageJump(CInt($listView.Key))
    
End
