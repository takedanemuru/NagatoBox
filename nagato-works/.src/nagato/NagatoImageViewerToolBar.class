' Gambas class file

Inherits NagatoToolBar

Property Read EffectIndex As Integer

Private $effectsButton As ComboBox

Event SetWallpaper(argType As Integer)

Private Sub addFileActionButtons()
    
    Dim yukiButtons As NagatoFileActionButtons
    
    yukiButtons = New NagatoFileActionButtons(Me._$parent) As "Menu"
    
End

Private Sub addRotateLeftButton()
    
    Dim yukiButton As ToolButton
    
    yukiButton = New ToolButton(Me._$parent) As "MenuButton"
    
    With yukiButton
        .Width = 32
        .Picture = Stock["medium/rotate-left"]
        .Tag = MikuruMenuEventImageEffect.RotateLeft
    End With
    
End

Private Sub addRotateRightButton()
    
    Dim yukiButton As ToolButton
    
    yukiButton = New ToolButton(Me._$parent) As "MenuButton"
    
    With yukiButton
        .Width = 32
        .Picture = Stock["medium/rotate-right"]
        .Tag = MikuruMenuEventImageEffect.RotateRight
    End With
    
End

Private Sub addZoomButtons()
    
    Dim yukiButtons As NagatoZoomButtons
    
    yukiButtons = New NagatoZoomButtons(Me._$parent) As "Menu"
    
End

Private Sub addEffectSelector()
        
    $effectsButton = New ComboBox(Me._$parent)
    
    With $effectsButton
        .Width = 200
        .ReadOnly = True
        .List = NagatoImageEffect.EffectList
    End With
    
End

Private Sub addExecuteButton()
    
    Dim yukiButton As New ToolButton(Me._$parent) As "MenuButton"
    
    With yukiButton
        .Width = Me._$parent.Height
        .Tooltip = ("exectute image effect")
        .Picture = Stock["medium/color"]
        .Tag = MikuruMenuEventImageEffect.Execute
    End With
    
End

Private Sub addSeparator()
    
    Dim yukiSeparator As NagatoSeparator
    
    yukiSeparator = New NagatoSeparator(Me._$parent)
    
End

Private Sub addImageEffectButton()
    
    Dim yukiGearButton As New NagatoImageEffectButton(Me._$parent) As "GearButton"
    Dim yukiMenu As NagatoSubMenuImageEffect
    
    yukiMenu = New NagatoSubMenuImageEffect(yukiGearButton.RootMenu) As "Menu"
    
End

Private Sub addGearButton()
    
    Dim yukiGearButton As New NagatoGearButton(Me._$parent) As "GearButton"
    Dim yukiMenu As NagatoImageViewerMenu
    
    yukiMenu = New NagatoImageViewerMenu(yukiGearButton.RootMenu) As "Menu"
    
End

Public Sub _Initialize() 'Override
    
    addFileActionButtons()
    addRotateLeftButton()
    addRotateRightButton()
    addZoomButtons()
    addEffectSelector()
    addExecuteButton()
    addSeparator()
    addImageEffectButton()
    addGearButton()
   
End

Public Sub MenuButton_Click()
    
    Raise MenuEvent(Last.Tag)
    
End

Public Sub Menu_SetWallpaper(argType As Integer)
    
    Raise SetWallpaper(argType)
    
End

Private Function EffectIndex_Read() As Integer

    Return $effectsButton.Index

End
