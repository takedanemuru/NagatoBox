' Gambas class file

Create Static

Private $result As New String[]

Private Sub search(argTargetDirectory As String, argQuery As String)
    
    Dim yukiPath As String
    Dim yukiJointPath As String
    
    For Each yukiPath In Dir(argTargetDirectory)
         If Not NagatoSettingsFileSearch.Hidden And If yukiPath Begins "." Then Continue
         yukiJointPath = argTargetDirectory &/ yukiPath
         If IsDir(yukiJointPath) And If NagatoSettingsFileSearch.Recursive Then
            search(yukiJointPath, argQuery)
         Else
             If NagatoSettingsFileSearch.ExactMatch Then
                 If yukiPath == argQuery Then $result.Add(yukiJointPath)
             Else
                If yukiPath Like NagatoSearchKey.Get(argQuery) Then $result.Add(yukiJointPath)
             End If
         End If
    Next
    
End

Public Sub GetResult(argTargetDirectory As String, argQuery As String) As String[]
    
    $result.Clear()
    
    search(argTargetDirectory, argQuery)
    
    Return $result.Sort()
    
End

