' Gambas class file

Property Read CurrentFullPath As String
Property Read PreviousFullPath As String

Private $current As Integer 'current cursor index on $dir
Private $dirs As New String[]

Public Sub _new(argPath As String)
    
    $current = 0
    $dirs.Add(argPath, 0)
    
End

Public Sub Move(argPath As String)
    
    $dirs.Resize($current + 1)
    $dirs.Add(argPath)
    Inc $current
    
End

Public Function Back() As String
    
    ' This function has no failsafe.
    
    Dec $current
    
    Return $dirs[$current]
    
End

Public Function Forward() As String
    
    ' This function has no failsafe.

    Inc $current
    
    Return $dirs[$current]
    
End

Public Function getCurrentFullPath() As String
    
    Return $dirs[$current]
    
End

Public Function IsHome() As Boolean
    
    If $dirs[$current] = User.Home Then
        Return True
    Else
        Return False
    Endif
    
End

Public Function HasBack() As Boolean
    
    If $current <> 0 Then
        Return True
    Else
        Return False
    Endif
    
End

Public Function HasForward() As Boolean
    
   If $dirs.Max <> $current Then
        Return True
   Else
        Return False
   Endif 
    
End

Private Function CurrentFullPath_Read() As String

    Return $dirs[$current]

End

Private Function PreviousFullPath_Read() As String
    
    If $current = 0 Then
        Return ""
    Else
        Return $dirs[$current - 1]
    Endif

End
