' Gambas class file

Inherits NagatoFileSelectorContextMenu

Event Unarchive
Event DeleteFile

Private Sub addUnarchiveMenu()
    
    Dim yukiMenu As New Menu(Me._$parent) As "UnarchiveMenu"
    
    With yukiMenu
        .Text = ("Unarchive here")
        .Picture = Stock["medium/archive"]
    End With
    
End

Public Sub _InitializeChildMenus()
    
    If NagatoArchiver.CanUnarchive(Me._$currentPath) Then
        addUnarchiveMenu()
    Else
        Me.addOpenMenu()
    End If

    Me.addOpenWithMenu()
    Me.addMoveMenu()
    Me.addCopyMenu()
    Me.addCreateLinkMenu()
    Me.addRenameMenu()
    Me.addDeleteMenu()
    Me.addPropertyMenu()
    
End

Public Sub UnarchiveMenu_Click()
    
    Raise Unarchive
    
End
