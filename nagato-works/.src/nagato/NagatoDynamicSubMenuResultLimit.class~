' Gambas class file

Inherits NagatoDynamicSubMenu

Private Sub addUnlimitedMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "Menu"
    
    With yukiMenu
        .Text = ("Unlimited")
        .Tag = -1
        .Toggle = True
        .Checked = (NagatoSettingsFileSearch.Limit = -1)
    End With
    
End

Private Sub addLimitedMenu()
    
    Dim yukiArray As Integer[] = [10, 20, 50, 100, 200, 500, 1000]
    Dim yukiLimit As Integer
    Dim yukiMenu As Menu
    
    For Each yukiLimit In yukiArray
        yukiMenu = New Menu(Me._$rootMenu) As "Menu"
        With yukiMenu
            .Text = yukiLimit
            .Tag = yukiLimit
            .Toggle = True
            .Checked = (NagatoSettingsFileSearch.Limit = yukiLimit)
        End With
    Next
    
End

Public Sub _RefreshMenu()
    
    addUnlimitedMenu()
        MikuruMenuSeparator.Set(Me._$rootMenu)
    addLimitedMenu()
    
End

Public Sub Menu_Click()
    
    With NagatoSettingsFileSearch
        .Limit = Last.Tag
    End With
    
End
