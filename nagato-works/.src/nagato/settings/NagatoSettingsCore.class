' Gambas class file

Inherits NagatoSettings

Create Static

Property TabPosition As Integer
Property StartUpFunction As Integer

Private $megane As Boolean = True

Public Sub LoadFormSettings(argForm As Form)
    
    argForm.X = Me._$settings[Subst$("&1/X", argForm.Name), argForm.X]
    argForm.Y = Me._$settings[Subst$("&1/Y", argForm.Name), argForm.Y]
    argForm.Height = Me._$settings[Subst$("&1/Height", argForm.Name), argForm.Height]
    argForm.Width = Me._$settings[Subst$("&1/Width", argForm.Name), argForm.Width]
    
End

Public Sub SaveFormSettings(argForm As Form)
    
    Me._$settings[Subst$("&1/X", argForm.Name)] = argForm.X
    Me._$settings[Subst$("&1/Y", argForm.Name)] = argForm.Y
    Me._$settings[Subst$("&1/Height", argForm.Name)] = argForm.Height
    Me._$settings[Subst$("&1/Width", argForm.Name)] = argForm.Width
    
End

Public Sub LoadWebSettings()
    
    WebSettings[WebSettings.JavaEnabled] = True
    WebSettings[WebSettings.JavascriptEnabled] = True
    WebSettings[WebSettings.PluginsEnabled] = True
    WebSettings[WebSettings.JavascriptCanOpenWindows] = True
    WebSettings[WebSettings.LocalStorageDatabaseEnabled] = True
    WebSettings[WebSettings.OfflineStorageDatabaseEnabled] = True
    WebSettings[WebSettings.OfflineWebApplicationCacheEnabled] = True
    WebSettings.Cache.Path = NagatoHiddenDirectory.WebCacheDir
    WebSettings.Cache.Enabled = True
    WebSettings.IconDatabase.Path = File.Dir(Temp$())
    
End

Public Function IsMegane() As Boolean
    
    Return $megane
    
End

Public Sub changeMeganeSettings()
    
    $megane = Not $megane
    
End


Private Function TabPosition_Read() As Integer

    Return Me._$settings["core/tab_position", Align.Top]

End

Private Sub TabPosition_Write(Value As Integer)

    Me._$settings["core/tab_position"] = Value
    Me._$settings.Save()

End

Private Function StartUpFunction_Read() As Integer

    Return Me._$settings["core/startup_function", MikuruFunctionType.FileSelector]

End

Private Sub StartUpFunction_Write(Value As Integer)

    Me._$settings["core/startup_function"] = Value
    Me._$settings.Save()

End
