' Gambas class file

Private $mediaPlayer As MediaPlayer
Private $visualizers As New MediaControl[]
Private $visualizerNames As New String[] 

Private Sub initializeVisualizerNames()
    
    With $visualizerNames
        .Add("goom")
        .Add("libvisual_corona")
        .Add("libvisual_jakdaw")
        .Add("libvisual_jess")
        .Add("libvisual_infinite")
    End With
    
End

Private Sub addVisualizer()
        
        Dim yukiName As String
        Dim yukiVisualizer As MediaControl
        
        For Each yukiName In $visualizerNames
                 yukiVisualizer = New MediaContainer($mediaPlayer, yukiName)
                 $visualizers.Add(yukiVisualizer)
        Next
        
End

Public Sub _new(argMediaPlayer As MediaPlayer)
        
        $mediaPlayer = argMediaPlayer
        initializeVisualizerNames()
        addVisualizer()
        
End

Public Function GetVisualizer(argIndex As Integer) As MediaControl
        
        If argIndex > $visualizers.Max Then argIndex = 0
        
        Return $visualizers[argIndex]
        
End
