' Gambas class file

Create Static

Property Read LatestMessage As String
Property Read TimeStamp As Date

Private $timeStamp As Date
Private $messages As New String[]

Event NewMessage

Public Sub SetMessage(argMessage As String)
    
    $timeStamp = Now
    $messages.Add(argMessage)
    
    Raise NewMessage
    
End

Public Sub ShowVersion()
    
    Dim yukiVersion As String = Subst$(("Activate &1 version &2"), Application.Name, Application.Version)
    
    $timeStamp = Now
    $messages.Add(yukiVersion)
    
    Raise NewMessage
    
End

Private Function LatestMessage_Read() As String

    If Object.IsValid($messages) Then
        Return $messages[$messages.Max]
    Else
        Return ""
    Endif

End

Private Function TimeStamp_Read() As Date

    Return $timeStamp

End
