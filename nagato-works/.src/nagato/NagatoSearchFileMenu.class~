' Gambas class file

Inherits NagatoToolButtonMenu

Private $observer As Observer

Private Sub addMenu(argText As String, argTag As String)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "Menu"
    
    With yukiMenu
        .Text = argText
        .Toggle = True
        .Checked = Object.GetProperty(NagatoSearchFileMenuConfig, argTag)
        .Tag = argTag
    End With
    
End

Private Sub addLimitResultMenu()
    
    Dim yukiMenu As NagatoLimitResultMenu
    
    yukiMenu = New NagatoLimitResultMenu(Me._$rootMenu)
    
End

Private Sub addMimeTypeFilterMenu()
    
    Dim yukiMenu As NagatoMimeTypeFilterMenu
    
    yukiMenu = New NagatoMimeTypeFilterMenu(Me._$rootMenu)
    
End

Private Sub addDummyMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    yukiMenu.Visible = False
    
End

Public Sub _new(argMenu As Menu)
    
    Me._$rootMenu = argMenu
    $observer = New Observer(Me._$rootMenu) As "Asakura"
    addDummyMenu()
    
End

Public Sub Asakura_Show()
    
    Me._$rootMenu.Children.Clear()
    addMenu(("ExactMatch"), "ExactMatch")
    addMenu(("RecursiveSearch"), "RecursiveSearch")
    addMenu(("HiddenFile"), "HiddenFile")
    addLimitResultMenu()
    addMimeTypeFilterMenu()
    
End

Public Sub Menu_Click()
    
    Object.SetProperty(NagatoSearchFileMenuConfig, Last.Tag, Not Object.GetProperty(NagatoSearchFileMenuConfig, Last.Tag))
    
End
