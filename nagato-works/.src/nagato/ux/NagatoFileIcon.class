' Gambas class file

Create Static

Private Function getImageIcon(argPath As String, argSize As Integer) As Picture
    
    Return NagatoImageThumbnailer.Get(argPath, argSize)
    
End

Private Function getMimeIcon(argPath As String, argSize As Integer) As Picture
    
    If Desktop.GetFileIcon(argPath, argSize, False) Then
        Return Desktop.GetFileIcon(argPath, argSize, False)
    Else
        Return Stock[Subst$("&1/file", argSize)]
    Endif
    
End

Public Function Get(argPath As String, argSize As Integer) As Picture
    
    Dim yukiMime As String = NagatoMimeType.GetMineType(argPath)
    
    If yukiMime Begins "image" Then
        Return getImageIcon(argPath, argSize)
    Else If yukiMime Begins "video" Or If yukiMime = "application/ogg" Then
        Return NagatoVideoThumbnailer.Get(argPath, argSize)
    Else If yukiMime = "application/pdf" Then
        Return NagatoPdfThumbnailer.Get(argPath, argSize)
    Else
        Return getMimeIcon(argPath, argSize / 2)
    Endif
    
End
