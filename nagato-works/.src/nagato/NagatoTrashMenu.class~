' Gambas class file

Inherits NagatoToolButtonMenu

Private _$parentMenu As Menu

Private Sub addParentMenu()
    
    _$parentMenu = New Menu(Me._$rootMenu)
    
    With _$parentMenu
        .Text = ("Trash")
        .Picture = Stock["medium/trash"]
    End With
    
End

Private Sub addItemsMenu()
    
    Dim yukiMenu As New Menu(_$parentMenu) 
    
    yukiMenu.Text = (Subst$("Items: &1", MikuruDirectory.GetItems(NagatoTrashHandler.FilesPath)))
    
End

Private Sub addSizeMenu()
    
    Dim yukiMenu As New Menu(_$parentMenu) 
    Dim yukiSize As Float = MikuruDirectory.GetSize(NagatoTrashHandler.FilesPath)
    
    yukiMenu.Text = Subst$("size: &1 Byte", yukiSize)
    
End

Private Sub addShowTrashBinMenu()
    
    Dim yukiMenu As New Menu(_$parentMenu) As "ShowTrashBinMenu"
    
    With yukiMenu
        .Text = ("Show Trash Bin")
    End With
    
End

Private Sub addDeleteAllMenu()
    
    Dim yukiMenu As New Menu(_$parentMenu) As "DeleteAllMenu"
    
    yukiMenu.Text = ("delete all")
    
End

Private Sub addSeparatorMenu()
    
    Dim yukiMenu As New Menu(_$parentMenu)
    
    yukiMenu.Text = ""
    
End

Public Sub _new(argParentMenu As Menu)
    
    Me._$rootMenu = argParentMenu
    addParentMenu()
    addItemsMenu()
    addSizeMenu()
    addShowTrashBinMenu()
        addSeparatorMenu()
    addDeleteAllMenu()
    
End


