' Gambas class file

Inherits NagatoMainPane

Private $listView As ListView
Private $cantidates As Collection

Event Selected(argGeoElement As NagatoGeoElement)

Private Sub addListView()
    
    $listView = New ListView(Me._$parent) As "ListView"
    
    With $listView
        .Expand = True
        .Background = Color.Background
    End With
    
End

Public Sub Refresh(argCantidates As Collection)
    
    Dim yukiGeoElement As NagatoGeoElement
    
    $cantidates = argCantidates
    $listView.Clear()
    
    For Each yukiGeoElement In $cantidates
        If $listView.Exist(yukiGeoElement.VisibleName) Then Continue
        $listView.Add(yukiGeoElement.VisibleName, yukiGeoElement.VisibleName)
    Next
    
End

Public Sub _Initialize(argPath As String) 'override.
    
    Debug argPath
    
    addListView()
    
End

Public Sub ListView_Activate()
    
    Raise Selected($cantidates[$listView.Key])
    
End
