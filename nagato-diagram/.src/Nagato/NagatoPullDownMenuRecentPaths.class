' Gambas class file

Inherits NagatoPullDownMenu

Private Sub addRecentButton(argPath As String)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "RecentFileMenu"
    
    With yukiMenu
        .Text = File.Name(argPath)
        .Tag = argPath
    End With
    
End

Private Sub addRecentButtons()
    
    Dim yukiPath As String
    
    For Each yukiPath In MikuruSettings.LoadRecentPaths()
        addRecentButton(yukiPath)
    Next
    
End

Public Sub _OnRootMenuShow()
    
    Me._addMenuItem("Clear", MikuruSignal.FileRecentClear, "bin")
        Me._addMenuItem("", 0)
    addRecentButtons()
    
End

Public Sub RecentFileMenu_Click()
    
    Raise Signal(MikuruSignal.FileRecent, [Last.Tag])
    
End
