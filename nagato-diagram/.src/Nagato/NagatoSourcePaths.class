' Gambas class file

Inherits NagatoObject

Private $currentPath As String

Public Sub NewPath(argPath As String)
    
    $currentPath = argPath
    
End

Public Sub Open()
    
    Dialog.Title = ("Select file")
    Dialog.Path = Desktop.GetDirectory("DOCUMENTS") 
    Dialog.Filter = ["*.gv;*.dot", "dot file"]
    
    If Dialog.OpenFile(False) Then Return
    
    Raise Signal(MikuruSignal.SourceNew, [Dialog.Path])
    
End

Public Sub SaveAs(argSource As String)
    
    Dialog.Title = ("Save As...")
    Dialog.Path = Desktop.GetDirectory("DOCUMENTS") &/ ("your_file.gv")
    
    If Dialog.SaveFile() Then Return

    File.Save(Dialog.Path, argSource)
    $currentPath = Dialog.Path
    
End
