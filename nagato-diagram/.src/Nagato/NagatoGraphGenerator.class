' Gambas class file

Property Read Image As Image

Private $image As Image
Private $temporaryPaths As New NagatoTemporaryPaths

Private Sub resetImage()
    
    Dim yukiOutput As String

    Exec ["dot", "-Tpng", $temporaryPaths.SourcePath, "-o", $temporaryPaths.TargetPath] To yukiOutput
    
    If Not yukiOutput Then
        Try $image = Image.Load($temporaryPaths.TargetPath)
    Else
        Message.Error("YUKI.N > " & yukiOutput, ("OK"))
    End If
    
End

Public Sub Refresh(argSourceText As String)
    
    $temporaryPaths.Reset()
    File.Save($temporaryPaths.SourcePath, argSourceText)
    resetImage()
    
End

Public Sub _new()
    
    $image = New Image(16, 16, Color.White) ' just a dummy to avoid error
    
End

Private Function Image_Read() As Image

    Return $image

End
