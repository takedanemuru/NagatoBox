' Gambas class file

Private $timer As New Timer As "Timer"
Private $painter As New IrohaPaint

Public Sub Form_Open()
    
    Application.MainWindow = Me
    IrohaSettings.LoadFormSettings(Me)
    Me.SkipTaskbar = IrohaSettings.SkipTaskbar
    Me.Sticky = IrohaSettings.Sticky
    $painter.Refresh()
    $timer.Enabled = True

End

Public Sub form_Close()
    
    IrohaSettings.SaveFormSettings(Me)
    IrohaSettings.SkipTaskbar = Me.SkipTaskbar
    IrohaSettings.Sticky = Me.Sticky
    
End

Public Sub Timer_Timer()
    
    $painter.Refresh()
    
End

Public Sub Form_MouseDrag()

    Me.X = Mouse.ScreenX - Mouse.StartX
    Me.Y = Mouse.ScreenY - Mouse.StartY

End

Public Sub Form_Menu()
    
   Dim yukiMenu As New IrohaMenu(Me)
    
    yukiMenu.Popup()
    
End

Public Sub Form_DblClick()
    
    Me.Close()
    
End
