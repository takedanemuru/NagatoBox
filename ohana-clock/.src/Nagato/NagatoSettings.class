' Gambas class file

Create Static

Property Size As Integer
Property SkipTaskbar As Boolean
Property Sticky As Boolean

Private $settings As New Settings

Public Sub LoadFormSettings(argForm As Form)
    
    With argForm
        .X = $settings[Subst$("&1/x", argForm.Name), .X]
        .Y = $settings[Subst$("&1/y", argForm.Name), .Y]
    End With 
    
End

Public Sub SaveFormSettings(argForm As Form)
    
    With argForm
        $settings[Subst$("&1/x", argForm.Name)] = .X
        $settings[Subst$("&1/y", argForm.Name)] = .Y
    End With 
    
    $settings.Save()
    
End

Private Function Size_Read() As Integer

    Return $settings["form/size", 400]

End

Private Sub Size_Write(Value As Integer)

    $settings["form/size"] = Value
    $settings.Save()

End

Private Function SkipTaskbar_Read() As Boolean

    Return $settings["form/skip_taskbar", True]

End

Private Sub SkipTaskbar_Write(Value As Boolean)

    $settings["form/skip_taskbar"] = Value
    $settings.Save()

End

Private Function Sticky_Read() As Boolean

    Return $settings["form/sticky", True]

End

Private Sub Sticky_Write(Value As Boolean)

    $settings["form/sticky"] = Value
    $settings.Save()

End
