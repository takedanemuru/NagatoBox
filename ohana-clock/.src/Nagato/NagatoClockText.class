' Gambas class file

Private Function getBonborimaturiDate() As Integer
    
    Dim yukiFirstWeekdayOfOctober As Integer = WeekDay(Date(Year(Now), 10, 1))
    
    Return (14 - yukiFirstWeekdayOfOctober)
    
End

Private Function getBonborimaturiDateNextYear() As Integer
    
    Dim yukiFirstWeekdayOfOctober As Integer = WeekDay(Date(Year(Now) + 1, 10, 1))
    
    Return (14 - yukiFirstWeekdayOfOctober)
    
End

Private Function getDateDiff() As Integer
    
    If Date(Now) > Date(Year(Now), 10, getBonborimaturiDate()) Then
        Return DateDiff(Now, Date(Year(Now) + 1, 10, getBonborimaturiDateNextYear()), gb.Day)
    Else
        Return DateDiff(Now, Date(Year(Now), 10, getBonborimaturiDate()), gb.Day)
    Endif
    
End

Private Sub getStandardClockText() As String
        
    Dim yukiText As String
        
    yukiText = Format$(Now, ("mm/dd/yyyy")) & "<br>"
    yukiText &= Format$(Now, ("hh:nn:ss"))
    
    Return yukiText
    
End

Public Sub _call() As String
    
    If 5 >= Second(Now) Then
        Return Subst$(("&1 days until <br>Yuwaku Bonbori Matsuri."), getDateDiff())
    Else
        Return getStandardClockText()
    End If
    
End
