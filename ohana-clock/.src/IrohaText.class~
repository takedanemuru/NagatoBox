' Gambas class file

Create Static

Property Read Info As String
Property Read Clock As String

Private Function getBonborimaturiDate() As Integer
    
    Dim yukiFirstWeekdayOfOctober As Integer = WeekDay(Date(Year(Now), 10, 1))
    
    Debug 14 - yukiFirstWeekdayOfOctober
    
    Return (14 - yukiFirstWeekdayOfOctober)
    
End

Private Function getBonborimaturiDateNextYear() As Integer
    
    Dim yukiFirstWeekdayOfOctober As Integer = WeekDay(Date(Year(Now) + 1, 10, 1))
    
    Return (14 - yukiFirstWeekdayOfOctober)
    
End

Private Function getDateDiff() As Integer
    
    If Date(Now) > Date(Year(Now), 10, getBonborimaturiDate()) Then
        Return DateDiff(Now, Date(Year(Now) + 1, 10, getBonborimaturiDateNextYear()), gb.Day)
    Else
        Return DateDiff(Now, Date(Year(Now), 10, getBonborimaturiDate()), gb.Day)
    Endif
    
End

Private Function Info_Read() As String

    Dim yukiText As String = Subst$(File.Load("text/About"), Application.Version)

    Return yukiText

End

Private Function Clock_Read() As String

    Dim yukiText As String
    
    If 5 >= Second(Now) Then
        yukiText = Subst$(("&1 days until <br>Yuwaku Bonbori Matsuri."), getDateDiff())
    Else
        yukiText = Format$(Now, ("mm/dd/yyyy")) & "<br>"
        yukiText &= Format$(Now, ("hh:nn:ss"))
    End If
    
    Return yukiText

End
