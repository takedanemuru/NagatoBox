' Gambas class file

Inherits NagatoObject

Private $rcPath As New NagatoRcPath
Private $xmlDocument As New XmlDocument
Private $tempPath As String

Property Read Document As XmlDocument

Public Sub SaveTemp()
    
    Dim yukiText As String = $xmlDocument.ToString(True)
    
    File.Save($tempPath, MikuruSanitize.RemoveUselessLines(yukiText))
    
End

Public Sub Save()
    
    Dim yukiText As String = $xmlDocument.ToString(True)
    
    File.Save($rcPath.Path, MikuruSanitize.RemoveUselessLines(yukiText))
    
End

Public Sub _new()
    
    $tempPath = Temp() & ".xml"
    Copy $rcPath.Path To $tempPath
    $xmlDocument.Open($tempPath)

End

Private Function Document_Read() As XmlDocument

    Return $xmlDocument

End
