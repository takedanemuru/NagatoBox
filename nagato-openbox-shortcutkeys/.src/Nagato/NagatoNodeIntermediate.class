' Gambas class file

Create Private

Inherits NagatoNode

Public _$children As Collection

Public Sub _SetChild(argXmlElement As XmlElement)
    
    Dim yukiClass As String = MikuruNodeClassSelector[argXmlElement.Name]
    Dim yukiChildObject As Object = Object.New(yukiClass, [Me._$key, argXmlElement, Me._$columnView])
    
    Me._$children.Add(yukiChildObject, yukiChildObject.Key)
    
End

Public Sub _SetChildren(argXmlElements As XmlElement[])
    
    Dim yukiXmlElement As XmlElement
    
    If Not Object.IsValid(Me._$children) Then Me._$children = New Collection
    
    For Each yukiXmlElement In argXmlElements
        Me._SetChild(yukiXmlElement)
    Next
    
    If Me._$children.Count > 0 Then Me._$columnView[Me._$key].Expanded = True
    
End

Public Sub GetChild(argKey As Integer) As XmlElement
    
    Dim yukiChildObject As Object
    Dim yukiResponse As XmlElement
    
    If Me._$key = argKey Then Return Me._$xmlElement
    
    For Each yukiChildObject In Me._$children
        yukiResponse = yukiChildObject.GetChild(argKey)
        If yukiResponse <> Null Then Return yukiResponse
    Next
    
    Return Null
    
End
