' Gambas class file

Inherits NagatoObject

Property Read CurrentValue As String
Property Read List As String[]
Property Read IsText As Boolean

Private $xmlElement As XmlElement
Private $action As String
Private $list As String[]

Public Sub SetValue(argValue As String) As Boolean
    
    $xmlElement.Value = argValue
    
    Return True
    
Catch
    Return False
    
End

Public Sub Reset(argXmlElement As XmlElement)
    
    $xmlElement = argXmlElement
    $action = MikuruAction.GetAction($xmlElement)
    $list = MikuruValueList[$action, $xmlElement.Name]
    
End

Private Function CurrentValue_Read() As String

    Return MikuruSanitize.GetSanitizedValue($xmlElement.Value)

End

Private Function List_Read() As String[]

    Return $list

End

Private Function IsText_Read() As Boolean

    Return $list[0] = "TEXT"

End
