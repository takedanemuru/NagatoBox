' Gambas class file

Private $xmlDocument As New XmlDocument
Private $columnView As ColumnView
Private $keybinds As NagatoKeybinds
Private $mouseContexts As NagatoMouseContexts

Private Sub initializeColumnView()
    
    $columnView = New ColumnView(VBox1) As "ColumnView"
    
    With $columnView
        .AutoResize = True
        .Expand = True
        .Columns.Count = 2
        .Foreground = Color.Gray
        .Columns[0].Background = Color.Merge(Color.White, Color.Violet, 0.1)
        .Columns[1].Title = "Option Value"
    End With
    
End

Public Sub _new()
    
    $xmlDocument.Open(Desktop.ConfigDir &/ "NagatoBox/nagatobox-rc.xml")
    
    initializeColumnView()

End

Public Sub Form_Open()

    Dim yukiKey As Integer = MikuruUniqueIndex()
    Dim yukiXmlElementKeyboard As XmlElement = $xmlDocument.GetElementsByTagName("keyboard")[0]
    Dim yukiXmlElementMouse As XmlElement = $xmlDocument.GetElementsByTagName("mouse")[0]

    $keybinds = New NagatoKeybinds(yukiKey, yukiXmlElementKeyboard, $columnView)
    '$mouseContexts = New NagatoMouseContexts(yukiKey, yukiXmlElementMouse, $columnView)
    
End
