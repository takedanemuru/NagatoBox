' Gambas class file

Private $document As New NagatoXmlDocument
Private $menuBar As NagatoMenuBarContainer
Private $columnView As NagatoColumnView
Private $editor As NagatoEditor

Private Sub confirmReconfigure()
    
    If Message.Question(("YUKI.N > Reconfigure openbox now ?"), ("No"), ("Yes")) = 2 Then
        Try Shell "openbox --reconfigure"
    Endif
    
End

Public Sub _new()
    
    $menuBar = New NagatoMenuBarContainer(VBox1) As "MenuBar"
    $columnView = New NagatoColumnView(VBox1, $document.Document) As "ColumnView"
    $editor = New NagatoEditor(VBox1) As "Editor"

End

Public Sub Form_Open()

    $columnView.Refresh()
    
End

Public Sub ColumnView_Click(argXmlElement As XmlElement)
    
    $editor.Edit(argXmlElement)
    
End

Public Sub MenuBar_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.FileSave
            $document.Save()
            confirmReconfigure()
    End Select
    
End

Public Sub Editor_Signal(argSignal As Integer, argValues As Variant[])
    
    If argSignal = MikuruSignal.ValueChanged Then
        $menuBar.ShowSaveButton()
        $document.SaveTemp()
        $columnView.Refresh()
    End If
    
End
