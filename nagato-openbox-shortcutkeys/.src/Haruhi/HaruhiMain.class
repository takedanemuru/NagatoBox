' Gambas class file

Private $xmlDocument As New XmlDocument
Private $columnView As ColumnView
Private $keybinds As NagatoKeybinds
Private $mouseContexts As NagatoMouseContexts
Private $editor As NagatoEditor

Private Sub initializeColumnView()
    
    $columnView = New ColumnView(VBox1) As "ColumnView"
    
    With $columnView
        .AutoResize = True
        .Expand = True
        .Columns.Count = 2
        .Foreground = Color.Gray
        .Columns[0].Background = Color.Merge(Color.White, Color.Violet, 0.1)
        .Columns[1].Title = "Option Value"
    End With
    
End

Private Sub saveXmlDocument()
    
    Dim yukiText As String = $xmlDocument.ToString(True)
    
    Try Kill User.Home &/ "test-rc.xml"
    File.Save(User.Home &/ "test-rc.xml", MikuruSanitize.RemoveUselessLines(yukiText))
    
End

Public Sub _new()
    
    '$xmlDocument.Open(Desktop.ConfigDir &/ "NagatoBox/nagatobox-rc.xml")
    $xmlDocument.Open(User.Home &/ "test-rc.xml")
    
    initializeColumnView()
    $editor = New NagatoEditor(VBox1) As "Editor"

End

Public Sub Form_Open()

    Dim yukiKey As Integer = MikuruUniqueIndex()
    Dim yukiXmlElementKeyboard As XmlElement = $xmlDocument.GetElementsByTagName("keyboard")[0]
    Dim yukiXmlElementMouse As XmlElement = $xmlDocument.GetElementsByTagName("mouse")[0]

    $keybinds = New NagatoKeybinds(yukiKey, yukiXmlElementKeyboard, $columnView)
    '$mouseContexts = New NagatoMouseContexts(yukiKey, yukiXmlElementMouse, $columnView)
    
End

Public Sub ColumnView_Click()
    
    Dim yukiXmlElement As XmlElement = $keybinds.GetChild($columnView.Current.Key)
    
    $editor.Edit(yukiXmlElement)
    
    ' Try Debug yukiXmlElement.Parent.GetAttribute("name", 1)
    ' Debug yukiXmlElement.Name
    ' 
    'saveXmlDocument()
    
End
