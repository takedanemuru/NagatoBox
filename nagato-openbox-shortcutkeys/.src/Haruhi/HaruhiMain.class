' Gambas class file

Private $document As New NagatoXmlDocument
Private $columnView As NagatoColumnView
Private $editor As NagatoEditor

Public Sub _new()
    
    $columnView = New NagatoColumnView(VBox1, $document.Document) As "ColumnView"
    $editor = New NagatoEditor(VBox1) As "Editor"

End

Public Sub Form_Open()

    $columnView.Refresh()
    
End

Public Sub ColumnView_Click(argXmlElement As XmlElement)
    
    $editor.Edit(argXmlElement)
    
End

Public Sub Editor_Signal(argSignal As Integer, argValues As Variant[])
    
    If argSignal = MikuruSignal.ValueChanged Then
        $document.SaveTemp()
        $columnView.Refresh()
    End If
    
End
