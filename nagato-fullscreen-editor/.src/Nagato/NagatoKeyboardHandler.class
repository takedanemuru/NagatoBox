' Gambas class file

Inherits NagatoObject

Private $observer As Observer

Private Sub keyPressWithShiftAndControl(argKeyCode As Integer)
    
    If argKeyCode = Key["s"] Then Raise Signal(MikuruSignal.FileSaveAs, Null)
    
End

Private Sub keyPressWithControl(argKeyCode As Integer)
    
    If argKeyCode = Key["n"] Then Raise Signal(MikuruSignal.FileNew, Null)
    If argKeyCode = Key["o"] Then Raise Signal(MikuruSignal.FileOpen, Null)
    If argKeyCode = Key["s"] Then Raise Signal(MikuruSignal.FileSave, Null)
    If argKeyCode = Key["h"] Then HaruhiAbout.ShowDialog()
    If argKeyCode = Key["q"] Then Raise Signal(MikuruSignal.ApplicationQuit, Null)
    
End

Public Sub _new(argTextArea As TextArea)
    
    $observer = New Observer(argTextArea) As "Asakura"
    
End

Public Sub Asakura_KeyPress()
    
    If Key.Shift And If Key.Control Then
        keyPressWithShiftAndControl(Key.Code)
    Else If Key.Control Then
        keyPressWithControl(Key.Code)
    Endif
    
End
