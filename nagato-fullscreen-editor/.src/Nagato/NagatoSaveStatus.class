' Gambas class file

Private $path As String
Private $saved As Boolean = True
Private $observer As Observer

Public Function GetPathToSave() As String
    
    If $path Then Return $path
    If Not $path Then Return MikuruDialog.GetPathToSave()
    
End

Public Function SaveToPath(argPath As String) As Boolean
    
    If argPath = "" Then Return False
    
    $path = argPath
    $saved = True
    HaruhiMain.Title = File.Name($path)
    
    Return True
    
End

Public Sub New()
    
    $path = ""
    $saved = True
    
End

Public Function IsClosable() As Boolean
    
    If $saved = True Then Return True
    
    Select Case MikuruDialogEnsureSaved()
        Case MikuruDialogEnsureSaved.ResponseCancel
            Return False
        Case MikuruDialogEnsureSaved.ResponseDiscard
            Return True
        Case MikuruDialogEnsureSaved.ResponseSave
            $path = MikuruDialog.GetPathToSave()
            Return ($path <> "")
    End Select
    
End

Public Sub _new(argTextArea As TextArea)
    
    $observer = New Observer(argTextArea) As "Asakura"
    
End

Public Sub Asakura_Change()
    
    $saved = False
    
End
