' Gambas class file

Private $textArea As TextArea
Private $observer As Observer

Private Sub initializeTextArea()
    
    $textArea.Font.Size = NagatoSettings.FontSize
    $textArea.Background = MikuruTransparent(Color.White, 0.8)
    $textArea.Foreground = NagatoSettings.Foreground
    $textArea.Border = False
    $textArea.ScrollBar = Scroll.Vertical
    $textArea.Wrap = True
    
    Try HaruhiMain.Picture = Picture.Load(NagatoSettings.Background)
    
End

Private Sub setTextAreaSizeAndPosition()
    
    $textArea.H = Screen.H - 48 * 2
    $textArea.W = Screen.H
    $textArea.X = (Screen.W - $textArea.W) / 2
    $textArea.Y = 48
    
End

Public Sub _new(argTextArea As TextArea)
    
    $textArea = argTextArea
    
    initializeTextArea()
    setTextAreaSizeAndPosition()
    
    $observer = New Observer(NagatoSettings) As "Asakura"
    
End

Public Sub Asakura_Changed()
    
    initializeTextArea()
    
End
