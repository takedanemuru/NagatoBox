' Gambas class file

Inherits NagatoObject

Private $rootMenu As Menu

Private Sub addMenu(argText As String, argTag As Integer, Optional argIconName As String)
    
    Dim yukiMenu As New Menu($rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIconName Then .Picture = MikuruIcon[argIconName]
    End With
    
End

Public Sub PopUp()
    
    $rootMenu.Popup()
    
End

Public Sub _new()
    
    $rootMenu = New Menu(HaruhiMain)
    
    addMenu(("New"), MikuruSignal.FileNew, "document")
    addMenu(("Open"), MikuruSignal.FileOpen, "folder")
    addMenu(("Recent"), MikuruSignal.FileNone, "alarm-clock")
    addMenu(("Save"), MikuruSignal.FileSave, "hard-drive-download")
    addMenu(("Save As"), MikuruSignal.FileSaveAs, "documents")
        addMenu("", 0)
    addMenu(("preference"), MikuruSignal.ApplicationPreference, "equalizer")
        addMenu("", 0)
    addMenu(("About"), MikuruSignal.ApplicationAbout, "star")
    addMenu(("Quit"), MikuruSignal.ApplicationQuit, "button-power")
    
End

Public Sub MenuItem_Click()
    
    Select Case Last.Tag
        Case MikuruSignal.ApplicationAbout
            HaruhiAbout.ShowDialog()
        Default 
            Raise Signal(Last.Tag, Null)
    End Select
    
End

