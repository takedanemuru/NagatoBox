' Gambas class file

Property Read Count As Integer

Private $proxies As New DBusProxy[]

Private Const Service As String = "system://org.freedesktop.UPower"
Private Const InterfaceUPowerDevice As String = "org.freedesktop.UPower.Device"
Private Const InterfaceDbusProperties As String = "org.freedesktop.DBus.Properties"

Public Sub GetTimeToEmpty() As Float
    
    Dim yukiProxy As DBusProxy
    
    For Each yukiProxy In $proxies
        If yukiProxy.Get(InterfaceUPowerDevice, "Type") <> MikuruDevice.TypeBattery Then Continue
        Debug yukiProxy.Get(InterfaceUPowerDevice, "Temperature")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "TimeToEmpty")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "TimeToFull")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "Percentage")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "EnergyFull")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "EnergyFullDesign")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "Capacity")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "NativePath")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "Online")
        Debug yukiProxy.Get(InterfaceUPowerDevice, "PowerSupply")
    Next
    
    Return 0
    
End

Public Sub Add(argObjectPath As String)
    
    Dim yukiProxy As DBusProxy = DBus[Service][argObjectPath, InterfaceDbusProperties]
    
    $proxies.Add(yukiProxy)
    
End

Private Function Count_Read() As Integer

    Return $proxies.Count

End
