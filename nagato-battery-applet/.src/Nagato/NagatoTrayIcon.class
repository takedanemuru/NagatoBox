' Gambas class file

Private $trayIcon As TrayIcon
Private $timer As New Timer As "Timer"

Public Sub _new()
    
    $trayIcon = New TrayIcon As "TrayIcon"
    
    With $trayIcon
        .Icon = MikuruPowerManager.GetIcon()
        .Show()
    End With
    
    $timer.Enabled = True
    
End

Public Sub TrayIcon_Click()
    
    Dim yukiMenu As New NagatoContextMenu As "ContextMenu"
    
    yukiMenu.PopUp()
    
End

Public Sub Timer_Timer()
    
    $trayIcon.Tooltip = MikuruPowerManager.GetStatus()
    
End

Public Sub ContextMenu_Signal(argSignal As Integer)
    
    If argSignal = MikuruSignal.SignalKill Then $trayIcon.Delete()
    
End
