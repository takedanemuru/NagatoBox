' Gambas class file

Private Sub initializeTabStrip()
    
    MainTabStrip.Index = 1
    MainTabStrip.Text = Subst$(("For &1"), User.Name)
    
End

Public Sub RefreshTabStrip(argTitle As String, argIcon As Picture)
    
        MainTabStrip.Index = 3
        MainTabStrip.Text = argTitle
        MainTabStrip.Picture = argIcon
    
End

Public Sub _new()
    
    MikuruAutostartDirectory.Ensure()
    NagatoTabContentsHandler.ActivateAll()
    
End

Public Sub Form_Open()
    
    Application.MainWindow = Me
    
    NagatoSettings.LoadFormSettings(Me)
    initializeTabStrip()
    NagatoGridsHandler.Refresh()
    
End

Public Sub Form_Close()
    
    With NagatoSettings
        .SaveGridsSettings(UserAutostartGrid)
        .SaveGridsSettings(GlobalAutostartGrid)
        .SaveFormSettings(Me)
    End With
    
End
