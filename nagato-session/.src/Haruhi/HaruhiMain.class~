' Gambas class file

Private $observerGlobal As NagatoDirectoryObserver
Private $observerUser As NagatoDirectoryObserver

Private Sub initializeTabStrip()
    
    MainTabStrip.Index = 1
    MainTabStrip.Text = Subst$(("For &1"), User.Name)
    
End

Public Sub RefreshTabStrip(argTitle As String, argIcon As Picture)
    
    With MainTabStrip
        .Index = 3
        .Text = argTitle
        .Picture = argIcon
    End With
    
End

Public Sub _new()
    
    MikuruAutostartDirectory.Ensure()
    NagatoTabContentsHandler.ActivateAll()
    
    $observerGlobal = New NagatoDirectoryObserver As "Asakura"
    $observerUser = New NagatoDirectoryObserver As "Asakura"
    
    $observerGlobal.Directory = MikuruAutostartDirectory.Global
    $observerUser.Directory = MikuruAutostartDirectory.User
    
End

Public Sub Form_Open()
    
    Application.MainWindow = Me
    
    NagatoSettings.LoadFormSettings(Me)
    initializeTabStrip()
    NagatoGridsHandler.Refresh()
    
End

Public Sub Form_Close()
    
    With NagatoSettings
        .SaveGridsSettings(UserAutostartGrid)
        .SaveGridsSettings(GlobalAutostartGrid)
        .SaveFormSettings(Me)
    End With
    
End

Public Sub Asakura_Deleted(argFileName As String)
    
    NagatoGridsHandler.Refresh()
    
End

Public Sub Asakura_Modefied(argFileName As String)
    
    NagatoGridsHandler.Refresh()
    
End
