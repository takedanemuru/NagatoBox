' Gambas class file

Private $message As New NagatoMessage 
Private $legend As New NagatoLogoutLegend

Private Sub setMessage(argMessageType As Integer)
    
    $message.Set(argMessageType)
    $legend.Hide()
    
End

Public Sub Form_Open()

    Me.H = Screen.H
    Me.W = Screen.W
    Me.Sticky = True

    $message.Reset()
    MessageScreen.SetFocus()
    MessageTimer.Enabled = True

End

Public Sub MessageTimer_Timer()
    
    MessageScreen.Refresh()
    
End

Public Sub MessageScreen_DblClick()

    Me.Close()

End

Public Sub MessageScreen_KeyPress()
    
    Select Case Key.Code
        Case Key.Esc, Key.Enter, 16777220
            Me.Close()
        Case Key["E"], Key["L"]
            setMessage(NagatoMessage.ModeLogout)
        Case Key["R"]
            setMessage(NagatoMessage.ModeReboot)
        Case Key["S"]
            setMessage(NagatoMessage.ModeShutDown)
    End Select
    
End

Public Sub MessageScreen_Draw()
    
    With Paint
        .Begin(MessageScreen)
        .Brush = .Color(Color.White)
        .Font.Bold = True
        .Text($message.Get(), 120, Screen.H / 2)
        .Text($legend.Legend, (Screen.W - Paint.Font.TextWidth($legend.Legend)) / 2, Screen.H - 36)
        .Fill()
        .End()
    End With
    
End
