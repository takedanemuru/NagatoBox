' Gambas module file

Public Enum TypeExit, TypeReboot, TypeShutdown, TypeLockScreen

Private $logind As New NagatoLogind

Private Function getDesktopSession() As String
    
    Dim yukiOutput As String
    
    Shell "printenv | grep DESKTOP_SESSION" To yukiOutput
    
    Return Replace(yukiOutput, "\n", "")
    
End

Public Function IsOpenbox() As Boolean
    
    Dim yukiDesktop As String = getDesktopSession()
    
    If (yukiDesktop Ends "openbox") Or If (yukiDesktop Ends "NagatoBox") Then
        Return True
    Else
        Return False
    Endif
    
End

Public Function IsNagatoBox() As Boolean
    
    Return (getDesktopSession() Ends "NagatoBox") 

End

Public Sub Logout(argType As Integer)
    
    Select Case argType
        Case TypeExit
            Shell Subst$("openbox --exit && loginctl kill-user &1", User.Id)
        Case TypeReboot
            $logind.Reboot()
        Case TypeShutdown
            $logind.PowerOff()
        Case TypeLockScreen
            Try Shell "nagato-config-screenlocker -l"
    End Select
    
End
