' Gambas class file

Inherits NagatoWidget

Private $comboBox As ComboBox
Private $observer As Observer

Private Sub initializeComboBox()
    
    $comboBox = New ComboBox(Me._$container) As "ComboBox"
    
    With $comboBox
        .Expand = False
        .ReadOnly = True
        .W = NagatoXdgAutostarts.MaxWidth
        .List = NagatoXdgAutostarts.AllTypes
        Try .Index = NagatoXdgAutostarts.AllTypes.Find(MikuruSession.DesktopType)
    End With
    
End

Private Function getNewTargetDEIndex() As Integer
    
    Return NagatoXdgAutostarts.AllTypes.Find(NagatoSettingsSession.TargetDE)
    
End

Public Sub _OnInitializeWidget()
    
    initializeComboBox()
    $observer = New Observer(NagatoSettingsSession) As "Asakura"
    
End

Public Sub ComboBox_Click()
    
    NagatoSettingsSession.TargetDE = $comboBox[$comboBox.Index].Text
    
End

Public Sub Asakura_Changed()
    
    Object.Lock($comboBox)
        Try $comboBox.Index = getNewTargetDEIndex()
    Object.Unlock($comboBox)
    
End
