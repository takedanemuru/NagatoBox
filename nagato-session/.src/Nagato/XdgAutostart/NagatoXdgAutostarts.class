' Gambas class file

Create Static

Property Read GlobalAutoStarts As NagatoAutostarts
Property Read UserAutoStarts As NagatoAutostarts
Property Read AllTypes As String[]

Private $userAutoStarts As NagatoAutoStarts
Private $globalAutoStarts As NagatoAutoStarts
Private $autoStartFilesObserver As NagatoAutostartFilesObserver

Public Sub Execute()
    
    Me.Initialize()
    
    $userAutoStarts.ExecuteAll()
    $globalAutoStarts.ExecuteAll()

End

Public Sub Initialize()
    
    $userAutoStarts = New NagatoAutoStarts(MikuruAutostartDirectory.User)
    $globalAutoStarts = New NagatoAutoStarts(MikuruAutostartDirectory.Global)
    $autoStartFilesObserver = New NagatoAutostartFilesObserver As "Asakura"
    
End

Private Function GlobalAutoStarts_Read() As NagatoAutostarts

    Return $globalAutoStarts

End

Private Function UserAutoStarts_Read() As NagatoAutostarts

    Return $userAutoStarts

End

Private Function AllTypes_Read() As String[]
    
    Dim yukiData As New NagatoUniqueArray
    
    yukiData.Add($userAutoStarts.DesktopTypes)
    yukiData.Add($globalAutoStarts.DesktopTypes)
    
    Return yukiData.Data.Sort(gb.Natural + gb.IgnoreCase)
    
End
