' Gambas class file

Property Read All As NagatoAutostartFile[]

Private $autostartFiles As New NagatoAutostartFile[]

Private Sub execute(argAutostartFile As NagatoAutostartFile)
    
    If argAutostartFile.Exec = "" Then Return
    Try Shell argAutostartFile.Exec
    If Error Then Try Shell argAutostartFile.TryExec
    
End

Public Function ExecuteAll() 
    
    Dim yukiAutostartFile As NagatoAutostartFile
    
    For Each yukiAutostartFile In $autostartFiles
        If yukiAutostartFile.Overridden Then Continue
        If Not yukiAutostartFile.Required Then Continue
        execute(yukiAutostartFile)
    Next
    
End

Public Sub _new(argDirectory As String)
    
    Dim yukiPath As String
    
    For Each yukiPath In Dir(argDirectory)
        $autostartFiles.Add(Object.New("NagatoAutostartFile", [argDirectory &/ yukiPath]))
    Next
    
End

Private Function All_Read() As NagatoAutostartFile[]

    Return $autostartFiles

End
