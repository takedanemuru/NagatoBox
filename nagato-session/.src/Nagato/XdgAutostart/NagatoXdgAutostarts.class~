' Gambas class file

Create Static

Property Read GlobalAutosartDirectory As String
Property Read UserAutostartDirectory As String

Private $userAutoStarts As NagatoAutoStarts
Private $globalAutoStarts As NagatoAutoStarts

Private Sub execAll()
    
    Dim yukiExecuted As String[]
    
    yukiExecuted = $globalAutoStarts.Execute([""], $userAutoStarts)
    $userAutoStarts.Execute(yukiExecuted)
    
End

Public Sub Execute()
    
    $userAutoStarts = New NagatoAutoStarts(Me.UserAutostartDirectory)
    $globalAutoStarts = New NagatoAutoStarts(Me.GlobalAutosartDirectory)
    execAll()

End

Private Function GlobalAutosartDirectory_Read() As String

    Return "/etc/xdg/autostart"

End

Private Function UserAutostartDirectory_Read() As String

    Return User.Home &/ ".config/autostart"

End
