' Gambas class file

Inherits NagatoTabHandler

Private $gridView As GridView 
Private $gridviewHandler As NagatoGridsAutostarts
Private $panel As NagatoMenuPanelGlobalAutoStarts

Private Function getTargetPath() As String
    
    Dim yukiName As String = $gridView[$gridView.Row, NagatoGridsHeadersAutostarts.ColumnName].Text
    Dim yukiPath As String = MikuruAutostartDirectory.User &/ yukiName

    Return yukiPath
    
End

Public Sub _InitializePanel()
    
    $panel = New NagatoMenuPanelGlobalAutoStarts(Me._$container) As "TFEI"
    
End

Public Sub _InitializeGridView()
    
    $gridView = New GridView(Me._$container) As "TFEI"
    
    With NagatoXdgAutostarts
        $gridviewHandler = New NagatoGridsAutostarts($gridView, .GlobalAutoStarts, .UserAutoStarts.Hiddens)
    End With
    
    NagatoSettings.LoadGridsSettings($gridView)
    
End

Public Sub SaveSettings()
    
    NagatoSettings.SaveGridsSettings($gridView)
    
End

Public Sub Asakura_Activate()
    
    'showDetail($gridView.RowAt(Mouse.Y))
    
End

Public Sub TFEI_Menu()
    
    If $gridView.Row = -1 Then Return '$gridView.Row should return -1 when any row is selected.
        
    Debug getTargetPath()
    
End
