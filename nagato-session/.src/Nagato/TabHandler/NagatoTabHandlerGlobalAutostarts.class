' Gambas class file

Inherits NagatoTabHandler

Private $gridView As GridView 
Private $gridviewHandler As NagatoGridsAutostarts
Private $panel As NagatoMenuPanelGlobalAutoStarts

Private Sub showDetail(argRow As Integer)
    
    ' If argRow <> $gridView.Rows.Max Then
    '     NagatoEditorHandler.SetText(MikuruDesktopEntryFile.Get(argRow, $gridView), True)
    ' End If
    
End

Public Sub _InitializePanel()
    
    $panel = New NagatoMenuPanelGlobalAutoStarts(Me._$container) As "TFEI"
    
End

Public Sub _InitializeGridView()
    
    $gridView = New GridView(Me._$container) As "TFEI"
    
    With NagatoXdgAutostarts
        $gridviewHandler = New NagatoGridsAutostarts($gridView, .GlobalAutoStarts, .UserAutoStarts.Hiddens)
    End With
    
    NagatoSettings.LoadGridsSettings($gridView)
    
End

Public Sub SaveSettings()
    
    NagatoSettings.SaveGridsSettings($gridView)
    
End

Public Sub Asakura_Activate()
    
    showDetail($gridView.RowAt(Mouse.Y))
    
End

Public Sub Menu_Show()
    
    If $gridView.Rows.Selection.Count = 0 Then 
        Return
    Else
        showDetail($gridView.Rows.Selection[0])
    End If
    
End

Public Sub Menu_Block()
    
    Dim yukiPath As String
    
    If $gridView.Row = -1 Then Return
    
    yukiPath = MikuruAutostartDirectory.User &/ $gridView[$gridView.Row, 1].Text & ".desktop"
    
    If Not Exist(yukiPath) Then MikuruBlocker.Create($gridView[$gridView.Row, 1].Text)
    
End
