' Gambas class file

Inherits NagatoTabHandler

Private $gridView As TableView
Private $gridviewHandler As NagatoTableAutostarts
Private $panel As NagatoMenuPanelGlobalAutoStarts

Private Function getTargetPath() As String
    
    Dim yukiName As String = $gridView[$gridView.Row, NagatoTableHeadersAutostarts.ColumnName].Text
    Dim yukiPath As String = MikuruAutostartDirectory.User &/ yukiName

    Return yukiPath
    
End

Public Sub _InitializePanel()
    
    $panel = New NagatoMenuPanelGlobalAutoStarts(Me._$container) As "TFEI"
    
End

Public Sub _InitializeGridView()
    
    $gridView = New TableView(Me._$container) As "TFEI"
    
    With NagatoXdgAutostarts
        $gridviewHandler = New NagatoTableAutostarts($gridView, .GlobalAutoStarts, .UserAutoStarts.Hiddens)
    End With
    
    NagatoSettings.LoadGridsSettings($gridView)
    
End

Public Sub SaveSettings()
    
    NagatoSettings.SaveGridsSettings($gridView)
    
End

Public Sub Asakura_Activate()
    
    'showDetail($gridView.RowAt(Mouse.Y))
    
End

Public Sub TFEI_Menu()
    
    If $gridView.Rows.Selection.Count = 0 Then Return
        
    Debug getTargetPath()
    
End
