' Gambas class file

Inherits NagatoTabHandler

Private $gridView As TableView
Private $gridviewHandler As NagatoTableAutostarts
Private $panel As NagatoMenuPanelGlobalAutoStarts

Public Sub _InitializePanel()
    
    $panel = New NagatoMenuPanelGlobalAutoStarts(Me._$container) As "TFEI"
    
End

Public Sub _InitializeGridView()
    
    $gridView = New TableView(Me._$container) As "TableView"
    $gridviewHandler = New NagatoTableAutostarts($gridView, NagatoXdgAutostarts.GlobalAutoStarts)
    NagatoSettingsGridView.Load($gridView)
    
End

Public Sub Reload()
    
    $gridviewHandler.Refresh(NagatoXdgAutostarts.GlobalAutoStarts)
    
End

Public Sub SaveSettings()
    
    NagatoSettingsGridView.Save($gridView)
    
End

Public Sub TableView_Activate()
    
    ' TODO Show detail
    
    If $gridView.Rows.Selection.Count = 0 Then Return

    Debug $gridView.RowAt(Mouse.Y)
    
End

Public Sub TableView_Menu()
    
    Dim yukiContextMenu As NagatoContextMenu
    Dim yukiAutostartFile As NagatoAutostartFile
    
    If $gridView.Rows.Selection.Count = 0 Then Return
    
    yukiAutostartFile = NagatoXdgAutostarts.GlobalAutoStarts.All[$gridView.Row]
    yukiContextMenu = New NagatoContextMenuGlobalAutostarts(yukiAutostartFile)
    yukiContextMenu.Popup()
    
End
