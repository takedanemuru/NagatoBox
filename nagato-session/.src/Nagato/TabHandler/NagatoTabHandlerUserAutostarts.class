' Gambas class file

Inherits NagatoTabHandler

Private $panel As NagatoMenuPanelUserAutostarts
Private $tableView As TableView
Private $tableViewHandler As NagatoTableAutostarts

Public Sub _InitializePanel()
    
    $panel = New NagatoMenuPanelUserAutostarts(Me._$container) As "TFEI"
    
End

Public Sub _InitializeGridView()
    
    $tableView = New TableView(Me._$container) As "TableView"
    $tableViewHandler = New NagatoTableAutostarts($tableView, NagatoXdgAutostarts.UserAutoStarts)
    NagatoSettingsGridView.Load($tableView)
    
End

Public Sub SaveSettings()
    
    NagatoSettingsGridView.Save($tableView)
    
End

Public Sub TableView_Click()
    
    Dim yukiList As String[]
    
    Select Case $tableView.Column
        Case 4, 5
            yukiList = NagatoXdgAutostarts.UserAutoStarts.All[$tableView.Row].OnlyShowIn
            HaruhiDialogOnlyShowIn.Set(yukiList)
    End Select
    
End

Public Sub TableView_Activate()
    
    ' ShowDetail($tableView.RowAt(Mouse.Y))
    
    Debug NagatoXdgAutostarts.UserAutoStarts.All[$tableView.Row].Path
    
End

Public Sub TableView_Menu()
    
    Dim yukiContextMenu As NagatoContextMenuUserAutostarts
    Dim yukiAutostartFile As NagatoAutostartFile
    
    If $tableView.Rows.Selection.Count = 0 Then Return
    
    yukiAutostartFile = NagatoXdgAutostarts.UserAutoStarts.All[$tableView.Row]
    yukiContextMenu = New NagatoContextMenuUserAutostarts(yukiAutostartFile) As "TFEI"
    yukiContextMenu.Popup()
    
End

Public Sub Reload()
    
    $tableViewHandler.Refresh(NagatoXdgAutostarts.UserAutoStarts)
    
End

Public Sub TFEI_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.AutostartsNew
            HaruhiApplications.ShowDialog()
        Case MikuruSignal.AutostartsDelete
            MikuruDialogPortalDeleteAutostart(argValues[0].Path)
    End Select
    
End
