' Gambas class file

Inherits NagatoTabHandler

Private $panel As NagatoMenuPanelUserAutostarts
Private $tableView As TableView
Private $tableViewHandler As NagatoTableAutostarts

Public Sub _InitializePanel()
    
    $panel = New NagatoMenuPanelUserAutostarts(Me._$container) As "TFEI"
    
End

Public Sub _InitializeGridView()
    
    $tableView = New TableView(Me._$container) As "TFEI"
    $tableViewHandler = New NagatoTableAutostarts($tableView, NagatoXdgAutostarts.UserAutoStarts)
    NagatoSettings.LoadGridsSettings($tableView)
    
End

Public Sub SaveSettings()
    
    NagatoSettings.SaveGridsSettings($tableView)
    
End

Public Sub Asakura_Activate()
    
    ' ShowDetail($tableView.RowAt(Mouse.Y))
    
End

Public Sub TFEI_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.AutostartsNew
            HaruhiSelectApplication.ShowDialog()
        Case MikuruSignal.AutostartsShowSource
            
        Case MikuruSignal.AutostartsDelete
            
    End Select
    
End

Public Sub TFEI_Click()
    
    Select Case $tableView.Column
        Case NagatoTableHeadersAutostarts.ColumnExec
            $tableView.Edit()
        Case NagatoTableHeadersAutostarts.ColumnTryExec
            $tableView.Edit()
    End Select
    
End
