' Gambas class file

Inherits NagatoTabHandler

Private $panel As NagatoMenuPanelUserAutostarts
Private $tableView As TableView
Private $tableViewHandler As NagatoTableAutostarts

Public Sub _InitializePanel()
    
    $panel = New NagatoMenuPanelUserAutostarts(Me._$container) As "TFEI"
    
End

Public Sub _InitializeGridView()
    
    $tableView = New TableView(Me._$container) As "TableView"
    $tableViewHandler = New NagatoTableAutostarts($tableView, NagatoXdgAutostarts.UserAutoStarts)
    NagatoSettings.LoadGridsSettings($tableView)
    
End

Public Sub SaveSettings()
    
    NagatoSettings.SaveGridsSettings($tableView)
    
End

Public Sub TableView_Activate()
    
    ' ShowDetail($tableView.RowAt(Mouse.Y))
    
End

Public Sub TableView_Menu()
    
    Dim yukiContextMenu As NagatoContextMenuUserAutostarts
    
    If $tableView.Rows.Selection.Count = 0 Then Return
    
    yukiContextMenu = New NagatoContextMenuUserAutostarts($tableViewHandler[$tableView.Row]) As "TFEI"
    yukiContextMenu.Popup()
    
End

Public Sub Reload()
    
    $tableViewHandler.Refresh(NagatoXdgAutostarts.UserAutoStarts)
    
End

Public Sub TFEI_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.AutostartsNew
            Debug HaruhiDialogProperties.ShowDialog()
        Case MikuruSignal.AutostartsShowSourceReadOnly
            HaruhiDialogProperties.SetProperties(argValues[0])
            HaruhiDialogProperties.ShowDialog()
        Case MikuruSignal.AutostartsDelete
            If Message.Question("YUKI.N > Are you sure ?", ("Cancel"), ("OK")) = 2 Then
                Kill argValues[0].Path
            Endif
    End Select
    
End

Public Sub TFEI_Click()
    
    Select Case $tableView.Column
        Case NagatoTableHeadersAutostarts.ColumnExec
            $tableView.Edit()
        Case NagatoTableHeadersAutostarts.ColumnTryExec
            $tableView.Edit()
    End Select
    
End
