' Gambas class file

Public Enum ModeStartup, ModeLogout, ModeReboot, ModeShutdown

Private $mode As Integer 
Private $position As Integer
Private $messageLines As NagatoMessageLines

Private Sub setPosition()
    
    Inc $position
    
    If $messageLines.LineEnds($position) Then
        $position = 0
        $messageLines.Next()
    Else If $messageLines.MessageEnds($position) And If $mode <> ModeStartup Then
        MikuruSession.Logout($mode)
    End If
    
End

Public Function Get() As String
    
    Dim yukiMessage As String = $messageLines[$position] 
    
    setPosition()
    
    Return yukiMessage
    
End

Public Sub Set(argMode As Integer)
    
    $messageLines.FinalMessage()
    
    $position = 0
    $mode = argMode
    
End

Public Sub Reset()
    
    $messageLines = New NagatoMessageLines
    $position = 0
    $mode = ModeStartup
    
End
