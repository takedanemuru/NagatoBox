' Gambas class file

Property Read Enabled As Boolean

Private $timer As Timer
Private $observationStep As Integer = 0

Event PrepStep
Event Step

Public Sub Stop()
    
    $timer.Stop()
    
End

Public Sub _new(argObservationInterval As Integer)
    
    $timer = New Timer As "Timer"
    $timer.Delay = argObservationInterval * 1000
    $timer.Enabled = True
    
End

Public Sub Timer_Timer()
    
    If $observationStep = 0 Then
        Inc $observationStep
        Raise PrepStep
    Else
        Raise Step
    End If
    
End

Private Function Enabled_Read() As Boolean

    Return $timer.Enabled

End
