' Gambas class file

Inherits NagatoObject

Private $dotText As New NagatoDotText
Private $timeout As New NagatoTimeout As "Timeout"

Private Sub setText(argBaseText As String, argNeedsDots As Boolean, argExplictTimeout As Integer)
    
    $dotText.Reset(argBaseText, argNeedsDots)
    $timeout.Reset(argExplictTimeout)
    
End

Public Sub _OnCall(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.DownloaderStart
            setText("Please wait", True, 0)
        Case MikuruSignal.DownloaderOngoing
            setText("Now Downloading", True, 0)
        Case MikuruSignal.DownloaderEncoding
            setText("Now Encoding", True, 0)
        Case MikuruSignal.DownloaderErrorOccurred
            setText("Error occurred : " & argValues[0], False, 10)
        Case MikuruSignal.DownloaderFinished
            setText("Finished", False, 10)
    End Select
    
End

Public Sub Timeout_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.TimerCount
            Raise Signal(MikuruSignal.TimerBasedTextChanged, [$dotText.Get()])
        Case MikuruSignal.TimerTimeout
            Raise Signal(MikuruSignal.TimerBasedTextTimeout, Null)
    End Select
    
End
