' Gambas class file

Inherits NagatoTableViewHandler

Private Sub paintRow()
    
    Dim yukiColumnIndex As Integer
    
    For yukiColumnIndex = 0 To Me._$tableView.Columns.Max
        Me._$tableView[Me._$tableView.Rows.Max, yukiColumnIndex].Background = MikuruColor.GridBackground
    Next
    
End

Public Sub Asakura_Click()
    
    Me._$tableView.Edit()
    
End

Public Sub Asakura_Save(argRow As Integer, argColumn As Integer, argValue As String)
    
    Me._$tableView[argRow, argColumn].Text = argValue
    
    If IsNumber(argValue) Then Me._$tableView[argRow, argColumn].Alignment = Align.Right
    
    If Me._$tableView.Font.TextWidth(argValue) + 16 > Me._$tableView.Columns[argColumn].W Then
        Me._$tableView.Columns[argColumn].W = Me._$tableView.Font.TextWidth(argValue) + 16
    Endif
    
End

Public Sub Asakura_Insert()
    
    Inc Me._$tableView.Rows.Count
    If Odd(Me._$tableView.Rows.Max) Then paintRow()
    Me._$tableView.MoveTo(Me._$tableView.Rows.Max, 0)
    Me._$tableView.Edit()
    
End
