' Gambas class file

Inherits NagatoTableViewHandler

Private $csv As String

Private Sub parseHeaders()
    
    Dim yukiIndex As Integer
    
    For yukiIndex = 0 To Me._$tableView.Columns.Max - 1
        $csv &= Quote$(Me._$tableView.Columns[yukiIndex].Text) & ","
    Next
    
    $csv &= Quote$(Me._$tableView.Columns[yukiIndex].Text) & gb.CrLf
    
End

Private Sub parseRow(argRow As Integer)
    
    Dim yukiIndex As Integer
    
    For yukiIndex = 0 To Me._$tableView.Columns.Max - 1
        $csv &= Quote$(Me._$tableView[argRow, yukiIndex].Text) & ","
    Next
    
    $csv &= Quote$(Me._$tableView[argRow, yukiIndex].Text) & gb.CrLf
    
End

Private Sub parseRows()
    
    Dim yukiRow As Integer
    
    For yukiRow = 0 To Me._$tableView.Rows.Max
        parseRow(yukiRow)
    Next
    
End

Public Sub DataSave()
    
    $csv = ""
    parseHeaders()
    parseRows()
    File.Save(User.Home &/ "chart_test.csv", $csv)
    
End
