' Gambas class file

Inherits DBusObject

Create Static

Property Read Ready As String
Property Read CpuUsage As Float
Property Read CpuHistory As Float[]
Property Read MemoryUsage As Float
Property Read MemoryHistory As Float[]
Property Read SwapUsage As Float
Property Read SwapHistory As Float[]
Property Read ProcessCount As Integer
Property Read ProcessHistory As Integer[]
Property Read NetworkTransmitTotal As Integer
Property Read NetworkTransmitBps As Float
Property Read NetworkReceiveTotal As Integer
Property Read NetworkReceiveBps As Float
Property Read ThermalCount As Integer

Private $reservations As New String[]

Private Sub activateAll()
    
    NagatoObserverFacadeSystem.Start()
    NagatoObserverFacadeNetwork.Start()
    NagatoObserverFacadeHardware.Start()
    
End

Public Sub CheckIn(argId As String) As Boolean
    
    If $reservations.Exist(argId) Then Return False
    
    $reservations.Add(argId)
    activateAll()
    
    Return True
    
End

Public Sub CheckOut(argId As String) As Boolean
    
    Dim yukiIndex As Integer = $reservations.Find(argId)
    
    If yukiIndex = -1 Then Return 'False
    
    $reservations.Remove(yukiIndex)
    
    If $reservations.Count = 0 Then Me.Stop()
    
    Return True
    
End

Public Sub Stop() As Boolean
    
    Try NagatoObserverFacadeSystem.Stop()
    Try NagatoObserverFacadeNetwork.Stop()
    Try NagatoObserverFacadeHardware.Stop()
    
    Try NagatoDBus.Unregister()
    
    Return (Not Error )
    
End

Public Sub GetTemperature(argThermalZoneIndex As Integer) As Integer
    
    If Me.ThermalCount = 0 Then Return 0
    
    Return NagatoObserverFacadeHardware.GetTemperature(argThermalZoneIndex)
    
End

Private Function Ready_Read() As String

    Return "YUKI.N >  Can you see this ?"

End

Private Function CpuUsage_Read() As Float

    Return NagatoObserverFacadeSystem.CpuUsage

End

Private Function MemoryUsage_Read() As Float

    Return NagatoObserverFacadeSystem.MemoryUsage

End

Private Function SwapUsage_Read() As Float

    Return NagatoObserverFacadeSystem.SwapUsage

End

Private Function ProcessCount_Read() As Integer

    Return NagatoObserverFacadeSystem.ProcessCount

End

Private Function CpuHistory_Read() As Float[]

    Return NagatoObserverFacadeSystem.CpuHistory

End

Private Function MemoryHistory_Read() As Float[]

    Return NagatoObserverFacadeSystem.MemoryHistory

End

Private Function SwapHistory_Read() As Float[]

    Return NagatoObserverFacadeSystem.SwapHistory

End

Private Function ProcessHistory_Read() As Integer[]

    Return NagatoObserverFacadeSystem.ProcessHistrory

End

Private Function NetworkTransmitTotal_Read() As Integer

    Return NagatoObserverFacadeNetwork.TransmitTotal

End

Private Function NetworkTransmitBps_Read() As Float

    Return NagatoObserverFacadeNetwork.TransmitBps

End

Private Function NetworkReceiveTotal_Read() As Integer

    Return NagatoObserverFacadeNetwork.ReceiveTotal

End

Private Function NetworkReceiveBps_Read() As Float

    Return NagatoObserverFacadeNetwork.ReceiveBps

End

Private Function ThermalCount_Read() As Integer

    Return NagatoObserverFacadeHardware.Count

End
