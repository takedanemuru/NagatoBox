' Gambas class file

Property Read ReceiveTotal As Integer
Property Read ReceiveBps As Float
Property Read ReceiveBpsHistory As Float[]
Property Read TransmitTotal As Integer
Property Read TransmitBps As Float
Property Read TransmitBpsHistory As Float[]

Private $streamReader As New NagatoNetworkStreamReader
Private $receiveHistory As New NagatoHistory
Private $transmitHistory As New NagatoHistory

Public Sub Prep()
    
    $streamReader.Refresh()
    
    $receiveHistory.Push($streamReader.ReceiveBytes)
    $transmitHistory.Push($streamReader.TransmitBytes)
    
End

Public Sub Step()
    
    $streamReader.Refresh()
    
    $receiveHistory.Push($streamReader.ReceiveBytes)
    $transmitHistory.Push($streamReader.TransmitBytes)
    
End

Private Function ReceiveTotal_Read() As Integer

    Return $streamReader.ReceiveTotal

End

Private Function ReceiveBps_Read() As Float


    Return $streamReader.ReceiveBytes

End

Private Function TransmitTotal_Read() As Integer

    Return $streamReader.TransmitTotal

End

Private Function TransmitBps_Read() As Float

    Return $streamReader.TransmitBytes

End

Private Function ReceiveBpsHistory_Read() As Float[]

    Return $receiveHistory.History

End

Private Function TransmitBpsHistory_Read() As Float[]

    Return $transmitHistory.History

End
