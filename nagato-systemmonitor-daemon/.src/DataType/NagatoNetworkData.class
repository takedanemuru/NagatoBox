' Gambas class file

Property Read ReceiveBytes As Integer
Property Read ReceiveTotal As Integer
Property Read TransmitBytes As Integer
Property Read TransmitTotal As Integer

Private $receiveBytes As Integer
Private $receiveBytesPrevious As Integer
Private $transmitBytes As Integer
Private $transmitBytesPrevious As Integer

Public Sub Clear()
    
    $receiveBytesPrevious = $receiveBytes
    $transmitBytesPrevious = $transmitBytes
    
    $receiveBytes = 0
    $transmitBytes = 0
    
End

Public Sub ReadLine(argLine As String)
    
    Dim yukiData As String[] = Split(argLine, " ", "", True)
    
    If yukiData[0] = "lo:" Then Return ' ignore local loopback

    $receiveBytes += CInteger(yukiData[1]) 
    $transmitBytes += CInteger(yukiData[9])

End

Private Function ReceiveBytes_Read() As Integer

    Return Max($receiveBytes - $receiveBytesPrevious, 0)

End

Private Function TransmitBytes_Read() As Integer

    Return Max($transmitBytes - $transmitBytesPrevious, 0)

End

Private Function ReceiveTotal_Read() As Integer

    Return Max($receiveBytes, 0)

End

Private Function TransmitTotal_Read() As Integer

    Return Max($transmitBytes, 0)

End
