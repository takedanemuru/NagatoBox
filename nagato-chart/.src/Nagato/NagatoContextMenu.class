' Gambas class file

Inherits NagatoObject

Public _$rootMenu As Menu

Public Sub _AddChildMenu(argText As String, argTag As Integer, Optional argIconName As String)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIconName Then .Picture = MikuruIcon[argIconName]
    End With
    
End

Public Sub _OnRefreshChildMenus()
    
    
    
End

Public Sub _OptionalOnInitialize(argValues As Variant[])
    
    
    
End

Public Sub _OnMenuItemClick()
    
    
    
End

Public Sub _new(Optional argValues As Variant[])
    
    If argValues Then Me._OptionalOnInitialize(argValues)
    Me._$rootMenu = New Menu(HaruhiMain) As "RootMenu"
    Me._AddChildMenu("", 0) ' as dummy
    
End

Public Sub PopUp()
    
    Me._$rootMenu.Popup()
    
End

Public Sub RootMenu_Show()
    
    Me._$rootMenu.Children.Clear()
    Me._OnRefreshChildMenus()
    
End

Public Sub MenuItem_Click()
    
    Me._OnMenuItemClick()
    
End
