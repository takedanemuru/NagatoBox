' Gambas class file

Inherits NagatoUx

Private $tableView As TableView
Private $headers As NagatoTableViewHandlerHeaders
Private $dataInput As NagatoTableViewHandlerDataInput
Private $dataLoad As NagatoTableViewHandlerDataLoad
Private $dataSave As NagatoTableViewHandlerFileStatus
Private $dataChart As NagatoTableViewHandlerDataChart

Private Sub initializeTableView()
    
    $tableView = New TableView(Me._$container) As "TableView"
    
    With $tableView
        .Header = GridView.Both
        .Rows.Count = 1
        .Columns.Count = 5
        .Expand = True
    End With
    
End

Public Sub _OnInitialize()
    
    initializeTableView()
    $headers = New NagatoTableViewHandlerHeaders($tableView)
    $dataInput = New NagatoTableViewHandlerDataInput($tableView)
    $dataLoad = New NagatoTableViewHandlerDataLoad($tableView)
    $dataSave = New NagatoTableViewHandlerFileStatus($tableView)
    $dataChart = New NagatoTableViewHandlerDataChart($tableView)
    
End

Public Sub IsClosable() As Boolean
    
    Return $dataSave.IsClosable()
    
End

Public Sub _call(argSignal As Integer, argValues As Variant)
    
    Select Case argSignal
        Case MikuruSignal.FileNew
            If $dataSave.IsClosable() Then $dataLoad.New()
        Case MikuruSignal.FileLoad
            If $dataSave.IsClosable() Then $dataLoad.OpenFile()
        Case MikuruSignal.FileSave
            $dataSave.Save()
        Case MikuruSignal.FileSaveAs
            $dataSave.SaveAs()
        Case MikuruSignal.ChartHeader
            $dataChart.CreateChart()
    End Select
    
End
