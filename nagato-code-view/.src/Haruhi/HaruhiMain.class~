' Gambas class file

Private $label As NagatoLabel
Private $menuPanel As NagatoMenuPanel
Private $grids As NagatoGridView

Public Sub Form_Open()
    
    Application.MainWindow = Me
    NagatoSettings.LoadFormSettings(Me)

    $label = New NagatoLabel(MessageBox)
    $menuPanel = New NagatoMenuPanel(PanelBox) As "TFEI"
    $grids = New NagatoGridView(Me) As "TFEI"
    
End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub TFEI_Signal(argEvent As Integer, argArgs As Variant[])
    
    Select Case argEvent
        Case MikuruSignal.FileOpen
            $grids.Open()
        Case MikuruSignal.ViewRefresh
            $label.SetText(argArgs[0])
        Case MikuruSignal.ViewFilter
            $grids.Filter(argArgs[0])
        Case MikuruSignal.ViewShowCodeView
            HaruhiCodeViewer.Show()
            HaruhiCodeViewer.SetCode(argArgs[0])
        Case MikuruSignal.ApplicationAbout
            HaruhiAbout.ShowDialog()
        Case MikuruSignal.ApplicationClose
            Me.Close()
    End Select
    
End
