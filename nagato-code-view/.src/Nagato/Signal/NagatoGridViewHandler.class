' Gambas class file

Private $grids As GridView

Private Sub initializeGridView()
    
    With $grids
        .Header = GridView.Horizontal
        .Resizable = True
        .Expand = True
        .Columns.Count = 7
        .Columns[0].Text = ("Type")
        .Columns[0].Width = 100
        .Columns[0].Alignment = Align.Left
        .Columns[1].Text = ("Name")
        .Columns[1].Width = 250
        .Columns[1].Alignment = Align.Left
        .Columns[2].Text = ("Lines")
        .Columns[2].Alignment = Align.Left
        .Columns[2].Width = 100
        .Columns[3].Text = ("Valid Lines")
        .Columns[3].Alignment = Align.Left
        .Columns[3].Width = 100
        .Columns[4].Text = ("Properties")
        .Columns[4].Alignment = Align.Left
        .Columns[4].Width = 100
        .Columns[5].Text = ("Methods")
        .Columns[5].Alignment = Align.Left
        .Columns[5].Width = 100
        .Columns[6].W = 16
        .Rows.Count = 0
    End With
    
End

Private Sub setBackgroundColor()
    
    Dim yukiCount As Integer
    
    For yukiCount = 0 To $grids.Columns.Max
        $grids[$grids.Rows.Max, yukiCount].Background = Color.Pink
    Next
    
End

Private Sub setRow(argColumnIndex As Integer, argText As String, Optional argAlign As Integer = Align.Right)
    
    $grids[$grids.Rows.Max, argColumnIndex].Text = argText
    $grids[$grids.Rows.Max, argColumnIndex].Alignment = argAlign
    
End

Public Sub Fill(argGridData As Variant[])
    
    Dim yukiCount As Integer
    
    For yukiCount = 0 To argGridData.Max
        Inc $grids.Rows.Count
        With argGridData[yukiCount]
            $grids[$grids.Rows.Max, 0].Text = argGridData[yukiCount]["type"]
            $grids[$grids.Rows.Max, 1].Text = argGridData[yukiCount]["name"]
            setRow(2, Format$(.["lines"], "#,###,###,###"))
            If .["type"] <> "Form" Then setRow(3, Format$(.["withoutvoid"], "#,###,###,###"))
            setRow(4, Format$(.["properties"], "#,###,###,###"))
            setRow(5, Format$(.["methods"], "#,###,###,###"))
            If .["lines"] >= 100 Then setBackgroundColor()
        End With
    Next
    
End

Public Sub SetSumRow(argData As NagatoData)
    
    Inc $grids.Rows.Count
    
    With $grids
        .[.Rows.Max, 1].Text = ("TOTAL")
        setRow(2, Format$(argData.GetLinesOfCode(False), "#,###,###"))
        setRow(3, Format$(argData.GetLinesOfCode(True), "#,###,###"))
        setRow(4, Format$(argData.PropertyCount, "#,###,###"))
        setRow(5, Format$(argData.MethodCount, "#,###,###"))
    End With
    
End

Public Sub Clear()
    
    $grids.Clear()
    $grids.Rows.Count = 0
    
End

Public Sub _new(argGrids As GridView)
    
    $grids = argGrids
    
    initializeGridView()
    
End
