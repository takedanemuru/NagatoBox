' Gambas class file

Create Static

Private Function isExactMatch(argQuery As String, argSubject As String) As Boolean
    
    Dim yukiTest As String
    
    For Each yukiTest In Split(argSubject, " ", "", True)
        If yukiTest == argQuery Then Return True
    Next
    
    Return False
    
End

Private Sub showEnglishResult(argResult As Result, argQuery As String) As Boolean
    
    Dim yukiJapanese As String = argResult[NagatoDBGeneralDict.ColumnJapanese]
    Dim yukiEnglish As String = argResult[NagatoDBGeneralDict.ColumnEnglish]
    
    If yukiEnglish = "" Then Return False
    If Not NagatoArgs.Fuzzy And If Not isExactMatch(argQuery, yukiEnglish) Then Return False
    Print yukiJapanese, Replace$(yukiEnglish, ")", "")
    
    Return True
    
End

Private Function searchEnglish(argQuery As String) As Integer
    
    Dim yukiResult As Result = NagatoDBGeneralDict.GetWithEnglish(Subst$("%&1%", argQuery))
    Dim yukiCount As Integer
    
    For Each yukiResult
        If showEnglishResult(yukiResult, argQuery) Then Inc yukiCount
    Next
    
    Return yukiCount
    
End

Private Sub showJapaneseResult(argResult As Result) As Boolean
    
    Dim yukiJapanese As String = argResult[NagatoDBGeneralDict.ColumnJapanese]
    Dim yukiEnglish As String = argResult[NagatoDBGeneralDict.ColumnEnglish]
    
    If yukiEnglish = "" Then Return False
    Print yukiJapanese, Replace$(yukiEnglish, ")", "")
    
    Return True
    
End

Private Function searchJapanese(argQuery As String) As Integer
    
    Dim yukiResult As Result = NagatoDBGeneralDict.Get(Subst$("%&1%", argQuery))
    Dim yukiCount As Integer
    
    For Each yukiResult
        If showJapaneseResult(yukiResult) Then Inc yukiCount
    Next
    
    Return yukiCount
    
End

Public Sub ShowResults(argQueries As String[])
    
    Dim yukiQuery As String
    Dim yukiResultCount As Integer
    
    For Each yukiQuery In argQueries
        yukiResultCount = IIf(IsAscii(yukiQuery), searchEnglish(yukiQuery), searchJapanese(yukiQuery))
    Next
    
    If Not yukiResultCount Then Print "YUKI.N > Query not found."
    
End
