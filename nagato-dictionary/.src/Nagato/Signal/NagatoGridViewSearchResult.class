' Gambas class file

Inherits NagatoGridView

Private Function getResult(argQueryType As Integer, argQueryWord As String) As Result
    
    Select Case argQueryType
        Case NagatoQuerySelector.TypeJapanese
            Return NagatoDBGeneralDict.Get(Subst$("%&1%", argQueryWord))
        Case NagatoQuerySelector.TypePronunciation
            Return NagatoDBGeneralDict.GetWithPronunciation(Subst$("%&1%", argQueryWord))
        Case NagatoQuerySelector.TypeEnglish
            Return NagatoDBGeneralDict.GetWithEnglish(Subst$("%&1%", argQueryWord))
    End Select
    
End

Private Function setRow(argResult As Result) As Boolean
    
    Dim yukiJapanese As String = argResult[NagatoDBGeneralDict.ColumnJapanese] 
    Dim yukiPronounciation As String = argResult[NagatoDBGeneralDict.ColumnPronunciation] 
    Dim yukiEnglish As String = Replace$(argResult[NagatoDBGeneralDict.ColumnEnglish], ")", "")
    
    If yukiEnglish = "" Or If yukiJapanese = "" Then Return False
    Me._SetData(yukiJapanese, yukiPronounciation, yukiEnglish)

    Return True

End

Public Sub Searh(argQueryType As Integer, argQueryWord As String)
    
    Dim yukiResult As Result = getResult(argQueryType, argQueryWord)
    Dim yukiCount As Integer
    
    Me._Clear()
    
    For Each yukiResult
        If setRow(yukiResult) Then Inc yukiCount
    Next
    
    If yukiCount = 0 Then Message.Info(("YUKI.N > Query not found."), ("OK"))
    
End
