' Gambas class file

Inherits NagatoGrid

Public _$headers As String[] = ["Id", "Parent project", "Name", "Date"]

Public Sub _RefreshData()
    
    Dim yukiResult As Result = NagatoDBToDo.GetDone()
    Dim yukiMax As Integer
    
    Me._$grid.Clear()
    Me._$grid.Rows.Count = 0
    
    For Each yukiResult
        With yukiResult
            Inc Me._$grid.Rows.Count
            yukiMax = Me._$grid.Rows.Max
            Me._$grid[yukiMax, 0].Text = .[NagatoDBToDo.ColumnId]
            Try Me._$grid[yukiMax, 1].Text = NagatoDBToDo.GetProjectName(.[NagatoDBToDo.ColumnProject])
            If Me._$grid[yukiMax, 1].Text <> "" Then 
                Me._$grid[yukiMax, 1].Picture = NagatoDBToDo.GetProjectIcon(.[NagatoDBToDo.ColumnProject])
            End If
            Me._$grid[yukiMax, 2].Picture = MikuruIcon.Get("button-check")
            Me._$grid[yukiMax, 2].Text = .[NagatoDBToDo.ColumnName]
            Try Me._$grid[yukiMax, 3].Text = Format$(.[NagatoDBToDo.ColumnDateDone], ("mm/dd/yyyy hh:nn:ss"))
            If Even(yukiMax) Then Me._SetGridBackground(yukiMax, MikuruUX.GridBackgroundPink)
            Me._AdjustColumnSize(yukiMax, [1, 2], [1, 2])
        End With
    Next
    
End

Public Sub _new(argGridView As GridView)
    
    Me._$grid = argGridView
    Me._InitializeHeader()
    Me._RefreshData()
    
End
