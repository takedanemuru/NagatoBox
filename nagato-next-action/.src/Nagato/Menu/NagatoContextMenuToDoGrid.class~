' Gambas class file

Inherits NagatoContextMenu

Private Sub setMenu(argText As String, argTag As Integer, Optional argIcon As Picture)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIcon Then .Picture = argIcon
    End With
    
End

Public Sub _InitializeMenus() 'Override
    
    With MikuruMenuEvent
        setMenu(("Done"), .MenuDone, MikuruIcon.Get("button-check"))
        setMenu(("Add NEW item"), .MenuAddChild, MikuruIcon.Get("button-add"))
            setMenu("", .None) 'separator
        setMenu(("Add child item"), .MenuAddChild, MikuruIcon.Get("button-add"))
        setMenu(("Edit"), .MenuEdit, MikuruIcon.Get("document-edit"))
        setMenu(("Delete"), .MenuDelete, MikuruIcon.Get("bin"))
    End With
    
End

Public Sub MenuItem_Click()
    
    Raise MenuEvent(Last.Tag)
    
End
