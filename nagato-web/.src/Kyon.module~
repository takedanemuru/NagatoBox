' Gambas module file

Private Function getSartupUrl() As String
    
    Dim yukiUrl As String = ""
    Dim yukiArgs As String[]
    
    Args.Begin("Usage")
        yukiUrl = Args.Get("u", "url", "open specific url", "url to open")
    yukiArgs = Args.End()
    
    If yukiUrl = "" And If yukiArgs.Count > 0 Then yukiUrl = yukiArgs[0]
    If yukiUrl Begins "/" Then yukiUrl = "file://" & yukiUrl
    
    Return yukiUrl
    
End

Private Sub showMain(argUrl As String)
    
    NagatoDBus.Register()
    HaruhiMain.Show()
    MikuruWebSettings.Initialize()
    If argUrl <> "" Then HaruhiMain.SetUrl(argUrl)
    Application.MainWindow = HaruhiMain
    
End

Private Sub tryOpen()
    
    If Object.IsValid(NagatoDBus.Proxy) Then 
        NagatoDBus.Proxy.Show()
    Else
        NagatoDBus.Unregister()
        showMain("")
    End If
    
End

Public Sub Main()
    
    ' Dim yukiUrl As String = getSartupUrl()
    ' 
    ' If NagatoDBus.IsUnique() Then
    '     showMain(yukiUrl)
    ' Else If yukiUrl = "" Then
    '     tryOpen()
    ' Else
    '     NagatoDBus.Proxy.SetUrl(yukiUrl)
    ' End If
    
    Dim yukiCategory As String
    
    For Each yukiCategory In NagatoDBBookmark.CategoryNames.Sort(gb.Natural + gb.IgnoreCase)
        Debug yukiCategory
    Next
    
End
