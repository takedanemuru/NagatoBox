' Gambas module file

Private Function getSartupUrl() As String
    
    Dim yukiUrl As String = ""
    Dim yukiArgs As String[]
    
    Args.Begin("Usage")
        yukiUrl = Args.Get("u", "url", "open specific url", "url to open")
    yukiArgs = Args.End()
    
    If yukiUrl = "" And If yukiArgs.Count > 0 Then yukiUrl = yukiArgs[0]
    
    Return IIf(yukiUrl = "", "", "file://" & yukiUrl)
    
End

Public Sub Main()
    
    Dim yukiUrl As String = getSartupUrl()
    
    If NagatoDBus.IsUnique() Then
        NagatoDBus.Register()
        HaruhiMain.Show()
        MikuruWebSettings.Initialize()
        If yukiUrl <> "" Then HaruhiMain.SetUrl(yukiUrl)
        Application.MainWindow = HaruhiMain
    Else If yukiUrl = "" Then
        NagatoDBus.Proxy.Show()
    Else
        Debug "i came here"
        NagatoDBus.Proxy.SetUrl(yukiUrl)
    End If
    
End
