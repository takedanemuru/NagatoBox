' Gambas class file

Inherits NagatoObject

Public _$rootMenu As Menu

Private Sub initializeRootMenu(argUniqueName As String)
    
    Me._$rootMenu = New Menu(HaruhiMain) As "RootMenu"
    Me._$rootMenu.Name = argUniqueName
    
    MikuruMenuSeparator.Set(Me._$rootMenu) ' use as dummy menu to catch RootMenu_Show event.
    
End

Public Sub _OnInitialize()
    
    
    
End

Public Sub _OnShowRootMenu()
    
    
    
End

Public Sub _AddMenu(argText As String, argTag As Integer, Optional argIconName As String)
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIconName Then .Picture = MikuruIcon.Get(argIconName)
    End With
    
End

Public Sub _new(argUniqueName As String, Optional argConstructOnInitialize As Boolean = False)
    
    initializeRootMenu(argUniqueName)
    Me._OnInitialize()
    If argConstructOnInitialize Then Me._OnShowRootMenu()
    
End

Public Sub RootMenu_Show()
    
    Me._$rootMenu.Children.Clear()
    Me._OnShowRootMenu()
    
End
