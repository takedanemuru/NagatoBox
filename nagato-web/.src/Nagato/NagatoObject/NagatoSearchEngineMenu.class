' Gambas class file

Inherits NagatoSearchEngines

Public Const _CategoryName As String = "Test"
Public _$parentMenu As Menu

Public Sub _InitializeParentMenu(argRootMenu As Menu)
    
    Me._$parentMenu = New Menu(argRootMenu) 
    
    With Me._$parentMenu
        .Text = Me._CategoryName
    End With
    
End

Public Sub _AddChildMenu(argText As String, argTag As Variant, Optional argIcon As Picture)
    
    Dim yukiMenu As New Menu(Me._$parentMenu) As "EngineMenu"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIcon Then .Picture = argIcon
    End With
    
End

Public Sub _InitializeChildMenus()
    
    Dim yukiMenu As New Menu(Me._$parentMenu)
    
    yukiMenu.Text = "TEST"
    
End

Public Sub _new(argRootMenu As Menu)
    
    Me._InitializeParentMenu(argRootMenu)
    Me._InitializeChildMenus()
    
End

Public Sub EngineMenu_Click()
    
    Raise Signal(MikuruSignal.SearchEngineChanged, [Last.Tag, Last.Text])
    
End
