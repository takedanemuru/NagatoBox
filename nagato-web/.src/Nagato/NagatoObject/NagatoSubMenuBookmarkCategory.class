' Gambas class file

Inherits NagatoObject

Private $categoryMenu As Menu
Private $pages As NagatoSubMenuBookmarkPages

Private Sub addSubCategories(argCategory As String)
    
    Dim yukiCategory As String
    Dim yukiMenu As NagatoSubMenuBookmarkCategory
    
    For Each yukiCategory In NagatoDBBookmark.CategoryNames.Sort(gb.Natural + gb.IgnoreCase)
        If argCategory = yukiCategory Then Continue
        If yukiCategory Not Begins argCategory Then Continue
        yukiMenu = New NagatoSubMenuBookmarkCategory($categoryMenu, yukiCategory) As "TFEI"
    Next
    
End

Private Sub initializeCategoryMenu(argParentMenu As Menu, argCategory As String)
    
    $categoryMenu = New Menu(argParentMenu) 
    
    With $categoryMenu
        .Text = File.BaseName(argCategory)
        .Picture = MikuruIcon["folder"]
        .Tag = argCategory
    End With
    
End

Public Sub _new(argParentMenu As Menu, argCategory As String)
    
    initializeCategoryMenu(argParentMenu, argCategory)
    addSubCategories(argCategory)
    $pages = New NagatoSubMenuBookmarkPages($categoryMenu, argCategory) As "TFEI"
    
End
