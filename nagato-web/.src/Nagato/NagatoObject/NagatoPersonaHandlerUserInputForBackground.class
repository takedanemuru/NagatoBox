' Gambas class file

Inherits NagatoObject

Private $drawingArea As DrawingArea
Private $observer As Observer

Private Function setNewY(argUnit As Float) As Integer
    
    Dim yukiY As Integer = NagatoSettingsPersona.Y + argUnit * TFEI.UX.Unit
    
    yukiY = Min(0, yukiY)
    yukiY = Max(yukiY, $drawingArea.H - MikuruPersona.Image.H)    
    
    NagatoSettingsPersona.Y = yukiY
    $drawingArea.Refresh()
    
End

Public Sub _new(argDrawingArea As DrawingArea)
    
    $drawingArea = argDrawingArea
    $observer = New Observer(argDrawingArea) As "Asakura"
    
End

Public Sub Asakura_KeyPress()
    
    Select Case Key.Code
        Case Key.Up
            setNewY(2)
        Case Key.Down
            setNewY(-2)
    End Select
    
End

Public Sub Asakura_MouseWheel()
    
    setNewY(Mouse.Delta)

End
