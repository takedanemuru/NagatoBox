' Gambas class file

Inherits NagatoSearchEngines

Private $queryBox As ButtonBox
Private $api As New NagatoDuckDuckGo

Private Sub initializeQueryBox(argContainer As Container)
    
    $queryBox = New ButtonBox(argContainer) As "QueryBox"
    
    With $queryBox
        .Expand = True
        .Picture = MikuruIcon.Get("search")
        .Border = False
    End With
    
End

Public Sub SetBang(argBang As String)
    
    $api.Bang = argBang
    
End

Public Sub _new(argContainer As Container)
    
    initializeQueryBox(argContainer)
    
End

Public Sub QueryBox_Activate()
    
    Dim yukiApi As String = $api.GetApi($queryBox.Text)
    Dim yukiTwitterQuery As String = "http://duckduckgo.com/?q=!tw"
    Dim yukiTwitterLiteQuery As String = "https://mobile.twitter.com/search?q="

    If $queryBox.Text = "" Then Return
    
    If WebSettings[WebSettings.JavascriptEnabled] Or If yukiApi Not Begins yukiTwitterQuery Then
        Raise Signal(MikuruSignal.WebNew, [yukiApi])
    Else
        Raise Signal(MikuruSignal.WebNew, [Replace(yukiApi, yukiTwitterQuery, yukiTwitterLiteQuery)])
    End If
    
End

Public Sub QueryBox_Click()
    
    QueryBox_Activate()
    
End
