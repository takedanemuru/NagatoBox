' Gambas class file

Inherits NagatoObject

Property Read Max As Integer

Public Enum TypeNull, TypeWebView, TypePlusButton

Private Const MouseMissing As Integer = -1

Private $onMouseIndex As Integer = MouseMissing
Private $handlerRectangles As NagatoTabsHandlerRectangles

Public Function GetTabOrder(argMouseX As Integer) As Integer
    
    Return $handlerRectangles.GetTabOrder(argMouseX)
    
End

Public Function GetTabIndex(argMouseX As Integer, argMouseY As Integer) As Integer
    
    Return $handlerRectangles.GetTabIndex(argMouseX, argMouseY)
    
End

Public Sub _new(argDrawingArea As DrawingArea)
    
    $handlerRectangles = New NagatoTabsHandlerRectangles(argDrawingArea)
    
End

Public Sub _get(argIndex As Integer) As Rect
    
    Return $handlerRectangles[argIndex]
    
End

Public Sub Refresh()
    
    $handlerRectangles.Refresh()
    
End

Public Function OnMouse(argIndex As Integer) As Boolean
    
    Return (argIndex = $onMouseIndex)
    
End

Public Function GetTabType(argX As Integer, argY As Integer) As Integer
    
    Select Case $handlerRectangles.GetTabIndex(argX, argY)
        Case MouseMissing
            Return TypeNull
        Case $handlerRectangles.Max 
            Return TypePlusButton
        Default
            Return TypeWebView
    End Select
    
End

Public Sub SetOnMouseIndex(argX As Integer, argY As Integer)
    
    $onMouseIndex = $handlerRectangles.GetTabIndex(argX, argY)
    
End

Public Sub ClearOnMouseIndex()
    
    $onMouseIndex = MouseMissing
    
End

Private Function Max_Read() As Integer

    Return $handlerRectangles.Max

End
