' Gambas class file

Private $drawingArea As DrawingArea

Public Sub _new(argDrawingArea As DrawingArea)
    
    $drawingArea = argDrawingArea
    
End

Private Function getActiveTabPolygon(argRect As Rect) As Float[]
    
    Dim yukiPolygon As New Float[]
    
    With argRect
        yukiPolygon.Add(0)
        yukiPolygon.Add($drawingArea.H)
        yukiPolygon.Add(0)
        yukiPolygon.Add($drawingArea.H - (1 * MikuruUxTab.Margin))
        yukiPolygon.Add(.X)
        yukiPolygon.Add($drawingArea.H - (1 * MikuruUxTab.Margin))
        yukiPolygon.Add(.X)
        yukiPolygon.Add($drawingArea.H - (MikuruUxTab.Height + 2 * MikuruUxTab.Margin))
        yukiPolygon.Add(.X + .W)
        yukiPolygon.Add($drawingArea.H - (MikuruUxTab.Height + 2 * MikuruUxTab.Margin))
        yukiPolygon.Add(.X + .W)
        yukiPolygon.Add($drawingArea.H - (1 * MikuruUxTab.Margin))
        yukiPolygon.Add($drawingArea.W)
        yukiPolygon.Add($drawingArea.H - (1 * MikuruUxTab.Margin))
        yukiPolygon.Add($drawingArea.W)
        yukiPolygon.Add($drawingArea.H)
        yukiPolygon.Add(0)
        yukiPolygon.Add($drawingArea.H)
    End With
    
    Return yukiPolygon
    
End

Public Sub DrawActiveTab(argRect As Rect, argOnMouse As Boolean)
    
    Paint.Brush = Paint.Color(IIf(argOnMouse, MikuruColor.Highlight, MikuruColor.ActiveTab))
        Paint.Polygon(getActiveTabPolygon(argRect))
    Paint.Fill()
    
End

Public Sub DrawNonActiveTab(argRectangle As Rect, argOnMouse As Boolean)
    
    Paint.Brush = Paint.Color(IIf(argOnMouse, MikuruColor.Highlight, MikuruColor.NonActiveTab))
    With argRectangle
        Paint.Rectangle(.X, .Y, .W, .H)
    End With
    Paint.Fill()
    
End

Public Sub DrawTitle(argTitle As String, argRectangle As Rect, Optional argCollapse As Boolean = True)
    
    Dim yukiTitle As String = MikuruUxTabText.GetCollapsedTitle(argTitle, argRectangle)
    
    Paint.Brush = Paint.Color(Color.White)
    With argRectangle
        If argCollapse Then
            Paint.RichText(yukiTitle, .X + MikuruUxTab.Margin, .Y, .W, .H, Align.Left)
        Else
            Paint.RichText(argTitle, .X, .Y, .W, .H, Align.Center)
        End If
    End With
    Paint.Fill()

End
