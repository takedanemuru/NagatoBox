' Gambas class file

Inherits NagatoMenuPipe

Private Const MenuName As String = "StarMenu"

Private $rootMenu As Menu

Private Enum MenuNone, MenuChangePersona, MenuAbout, MenuQuit

Private Sub initializeRootMenu(argButton As MenuButton)
    
    $rootMenu = New Menu(HaruhiMain)  
    $rootMenu.Name = MenuName
    
    argButton.Menu = MenuName
    
End

Private Sub addMenu(argText As String, argTag As Integer, Optional argIconName As String)
    
    Dim yukiMenu As New Menu($rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIconName Then .Picture = MikuruIcon.Get(argIconName)
    End With
    
End

Private Sub initializeCategoryMenus()
    
    addMenu(("Change Persona"), MenuChangePersona, "image")
        addMenu("", MenuNone)
    addMenu(("About"), MenuAbout, "information-balloon")
    addMenu(("Quit"), MenuQuit, "button-power")
    
End

Public Sub _new(argButton As MenuButton)
    
    initializeRootMenu(argButton)
    initializeCategoryMenus()
    
End

Public Sub MenuItem_Click()
    
    Select Case Last.Tag
        Case MenuChangePersona
            
        Case MenuAbout
            HaruhiAbout.ShowDialog()
        Case MenuQuit
            If HaruhiQuit.ShowDialog() = HaruhiQuit.ResponseQuit Then HaruhiMain.Close()
    End Select
    
End
