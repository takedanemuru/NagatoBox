' Gambas class file

Static Public UserTitle As String
Static Public Category As String

Public Sub SetTitle(argTitle As String)
    
    UserTitleTextBox.Text = argTitle
    
End

Public Sub SetList(argList As String[])
    
   Dim yukiList As String[] = MikuruArray.RemoveVoid(argList)
    
    yukiList.Add("", 0)
    CategoryComboBox.List = yukiList
    
End

Public Sub Form_Open()

    Dim yukiImage As Image = Image.Load("pictures/yukichan_29.jpg")

    Me.Picture = yukiImage.Stretch(Me.Width, Me.Height).Picture
    AddButton.Enabled = False

End

Public Sub CancelButton_Click()

    Me.Close(0)

End

Public Sub AddButton_Click()
    
    UserTitle = UserTitleTextBox.Text
    Category = CategoryComboBox.Text
    
    Me.Close(1)
    
End

Public Sub UserTitleTextBox_Change()

    If UserTitleTextBox.Text = "" Then AddButton.Enabled = False
    If CategoryComboBox.Text = "" Then AddButton.Enabled = False
    
    AddButton.Enabled = True
    
End

Public Sub CategoryComboBox_Change()

    UserTitleTextBox_Change()

End
