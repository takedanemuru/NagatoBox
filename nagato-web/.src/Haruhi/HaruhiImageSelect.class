' Gambas class file

Public Sub _new()
    
    With FileChooser1
        .FileView.IconSize = 128
        .Filter = ["*.png;*.jpg;*.jpeg", "Picture Files"]
        .Dir = Desktop.GetDirectory("PICTURES")
    End With
    
End

Public Sub FileChooser1_Activate()

    Dim yukiMimeType As String = DesktopMime.FromFile(FileChooser1.SelectedPath).Type

    If yukiMimeType Not Begins "image" Then Return

    NagatoSettingsPersona.Path = FileChooser1.SelectedPath
    MikuruPersona.Reset()
    HaruhiMain.RefreshPersona()
    Me.Close()

End
