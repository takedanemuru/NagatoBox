' Gambas class file

Private Const StartupUrl As String = "http://www.tonvid.com/search.php?q=nagato yuki"
Private Const VideoIdHeader As String = "http://www.tonvid.com/info.php?video_id="

Private $downloader As New NagatoYoutubeDL As "Downloader"

Public Sub Form_Open()
    
    WebView1.Url = StartupUrl
    
End

Public Sub WebView1_Load()
    
    ToolBar.Visible = (WebView1.Url Begins VideoIdHeader)
    
End

Public Sub VideoButton_Click()

    $downloader.DownloadAsMovie(WebView1.Url)

End

Public Sub MusicButton_Click()
    
    $downloader.DownloadAsMusic(WebView1.Url)
    
End

Public Sub Downloader_Signal(argSignal As Integer)
    
    ToolBar.Visible = True
    
    Select Case argSignal
        Case MikuruSignal.Downloading
            Label1.Text = ("Now Downloading...")
        Case MikuruSignal.Encoding
            Label1.Text = ("Now Encoding...")
        Case MikuruSignal.ErrorOccurred
            Label1.Text = ("Some error occurred.")
        Case MikuruSignal.Finished
            Label1.Text = ("Finished")
    End Select
    
End
