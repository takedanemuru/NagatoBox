' Gambas class file

Private $connection As Connection
Private $uniqueName As String

Private Sub addConnection()
    
    $connection = New Connection
    
    With $connection
        .Type = "sqlite3"
        .Host = MikuruDBHost.HostName
        .Name = ""
        .Login = ""
        .Password = ""
        .Port = ""
    End With
    
End

Private Sub checkAndCreateDatabase()
    
    $connection.Open()
    
    If Not $connection.Databases.Exist($uniqueName) Then
        Me._$connection.Databases.Add($uniqueName)
        Wait 0.5
    Endif
    
    $connection.Close()
    
End

Private Sub moveToDatabase()
    
    $connection.Host = MikuruDBHost.HostName
    $connection.Name = $uniqueName
    
End

Public Sub Get(argUniqueName As String) As Connection
    
    $uniqueName = argUniqueName
    
    MikuruDBHost.EnsureHostDirectory()
    addConnection()
    checkAndCreateDatabase()
    moveToDatabase()
    
    Return $connection
    
End
