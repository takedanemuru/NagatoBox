' Gambas class file

Inherits NagatoWidget

Private $downloader As New NagatoYoutubeDL As "Downloader"
Private $mpv As New NagatoMpv As "MPV"
Private $webView As NagatoWebView
Private $toolBar As NagatoToolBar

Public Sub _OnInitialize()
    
    $toolBar = New NagatoToolBar(Me._$container) As "ToolBar"
    $webView = New NagatoWebView(Me._$container) As "WebView"
    
End

Public Sub Kill()
    
    $mpv.Stop()
    
End

Public Sub ToolBar_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.UserRequestPlayVideo
            $mpv.Play($webView.Url)
        Case MikuruSignal.UserRequestPlayAudio
            $mpv.PlayNoVideo($webView.Url)
        Case MikuruSignal.UserRequestStopMpv
            $mpv.Stop()
        Case MikuruSignal.UserRequestDownloadAsMusic
            $downloader.DownloadAsMusic($webView.Url)
        Case MikuruSignal.UserRequestDownloadAsVideo
            $downloader.DownloadAsMovie($webView.Url)
        Case MikuruSignal.UserRequestSetUrl
            $webView(argSignal, argValues)
    End Select
    
End

Public Sub WebView_Signal(argSignal As Integer, argValues As Variant[])
    
    $toolBar(argSignal, argValues)
    
End

Public Sub Downloader_Signal(argSignal As Integer, argValues As Variant[])
    
    $toolBar(argSignal, argValues)
    
End

Public Sub MPV_Signal(argSignal As Integer, argValues As Variant[])
    
    $toolBar(argSignal, argValues)
    
End
