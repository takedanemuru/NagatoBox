' Gambas class file

Inherits NagatoPropertyWidget

Public _$sliderStep As Integer = 1

Private $label As Label
Private $slider As Slider
Private $valueLabel As TextLabel

Public Sub _AddSpacer(argWidth As Integer)
    
    Dim yukiLabel As New Label(Me._$hBox)
    
    With yukiLabel
        .Width = argWidth
    End With
    
End

Public Sub _AddLabel(argLabelTitle As String)
    
    $label = New Label(Me._$hBox)
    
    With $label
        .Text = argLabelTitle
        .Width = .Font.TextWidth(.Text)
        .Expand = True
    End With
    
End

Public Sub _AddSlider(argValue As Integer)
    
    $slider = New Slider(Me._$hBox) As "Slider"
    
    With $slider
        .Step = Me._$sliderStep
        .Mark = True
        .MaxValue = Me._$maxValue
        .MinValue = Me._$minValue
        Debug .MaxValue 
        Debug .MinValue 
        .Value = argValue
        .Expand = True
    End With
    
End

Public Sub _AddValueLabel(argValue As Integer)
    
    $valueLabel = New TextLabel(Me._$hBox)
    
    With $valueLabel
        .Alignment = Align.Right
        .Text = CInt(argValue) & " "
        .Width = 36
        .Expand = False
    End With
    
End

Public Sub _AddValueWidget(argLabelTitle As String, argHeader As String) ' override 
    
    Me._AddSpacer(32)
    Me._AddLabel(argLabelTitle)
    Me._AddValueLabel(NagatoConfigFile.Properties[argHeader])
    Me._AddSpacer(16)
    Me._AddSlider(CInt(NagatoConfigFile.Properties[argHeader]))
    
End

Public Sub Slider_Change()
    
    $valueLabel.Text = CInt($slider.Value)
    
End
