' Gambas class file

Private $toolbarThemes As NagatoToolbarWidgetThemes
Private $gridsThemes As NagatoGridsThemes
Private $applyButtons As NagatoToolbarApplyButtons

Private $icons As NagatoIconSettingsHandler
Private $cursors As NagatoCursorSettingsHandler

Private Sub initializeGridThemes()
    
    $gridsThemes = New NagatoGridsThemes(MainTabStrip) As "Themes"
    
    With $gridsThemes
        .SetList(NagatoConfigFacade.ThemesList)
        .SetCurrentTheme(NagatoConfigFacade.WidgetTheme)
    End With
    
End

Public Sub _new()

    MainTabStrip.Index = 0
    $toolbarThemes = New NagatoToolbarWidgetThemes(MainTabStrip)
    initializeGridThemes()
    $applyButtons = New NagatoToolbarApplyButtons(Me)

    $icons = New NagatoIconSettingsHandler(MainTabStrip) As "Themes"
    $cursors = New NagatoCursorSettingsHandler(MainTabStrip) As "Themes"

End

Public Sub Form_Open()

    NagatoSettings.LoadFormSettings(Me)

End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub Themes_Signal(argSignal As Integer, argValues As Variant[])
    
    If argSignal = MikuruSignal.PropertyChanged Then $applyButtons.Activate()
    
End
