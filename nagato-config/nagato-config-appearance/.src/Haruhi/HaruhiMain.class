' Gambas class file

Private $themes As NagatoSettingsHandlerTheme
Private $fonts As NagatoSettingsHandlerFont
Private $icons As NagatoSettingsHandlerIcon
Private $cursors As NagatoSettingsHandlerCursor
Private $applyButtons As NagatoToolbarApplyButtons

Private Sub setupSettingsHandlers()
    
    $themes = New NagatoSettingsHandlerTheme(MainTabStrip, 0) As "SettingsHandler"
    $fonts = New NagatoSettingsHandlerFont(MainTabStrip, 1) As "SettingsHandler"
    $icons = New NagatoSettingsHandlerIcon(MainTabStrip, 2) As "SettingsHandler"
    $cursors = New NagatoSettingsHandlerCursor(MainTabStrip, 3) As "SettingsHandler"
    $applyButtons = New NagatoToolbarApplyButtons(Me) As "ApplyButtons"
    
End

Public Sub _new()

    MainTabStrip.Index = 0
        setupSettingsHandlers()
    MainTabStrip.Index = 0

End

Public Sub Form_Open()

    NagatoSettings.LoadFormSettings(Me)

End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub SettingsHandler_Signal(argSignal As Integer, argValues As Variant[])
    
    If argSignal = MikuruSignal.PropertyChanged Then $applyButtons.Activate()
    
End
