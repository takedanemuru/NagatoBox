' Gambas class file

Inherits NagatoGrids

Private $directories As NagatoDirectoriesCursors

Private Sub setCheckMark(argName As String)
    
    If argName = NagatoConfigFacade.CursorTheme Then
        With Me._$grids
            .[.Rows.Max, Me.ColumnCheck].Picture = MikuruIcon["button-check"]
        End With
    End If
    
End

Private Sub setData()
    
    Dim yukiPath As String
    
    For Each yukiPath In $directories.Directories
        Inc Me._$grids.Rows.Count
        Me._$grids[Me._$grids.Rows.Max, Me.ColumnTheme].Text = File.Name(yukiPath)
        If Even(Me._$grids.Rows.Max) Then Me._SetBackground()
        setCheckMark(File.Name(yukiPath))
    Next
    
End

Private Sub setStarButton()
    
    Dim yukiRow As Integer
    
    For yukiRow = 0 To Me._$grids.Rows.Max
        If Me._$grids[yukiRow, 1].Text = NagatoConfigFacade.CursorTheme Then
            Me._$grids[yukiRow, 0].Picture = MikuruIcon["button-check"]
        Else If yukiRow = Me._$grids.Row Then
            Me._$grids[yukiRow, 0].Picture = MikuruIcon["auction"]
        Else
            Me._$grids[yukiRow, 0].Picture = Null
        Endif
    Next
    
End

Public Sub _AbstractOnInitializeGrids()
    
    Me._SetGridsFrame("Cursor Theme")
    $directories = New NagatoDirectoriesCursors
    setData()
    
End

Public Sub Grids_Activate()
    
    setStarButton()
    
    NagatoInterimStatus.CursorTheme = Me._$grids[Me._$grids.Row, 0].Text
    
    Raise Signal(MikuruSignal.PropertyChanged, [Me._$grids[Me._$grids.Row, 1].Text])
    
End
