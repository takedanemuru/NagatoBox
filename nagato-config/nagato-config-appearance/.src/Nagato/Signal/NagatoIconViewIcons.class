' Gambas class file

Private $iconView As IconView

Private Function getIcon(argIconName As String) As Picture
    
    Return Stock[Subst$("&1/&2", "large", argIconName)]
    
End

Private Sub setIcons()
    
    Dim yukiItemName As String
    
    For Each yukiItemName In Stock.Icons
        $iconView.Add(yukiItemName, "", getIcon(yukiItemName))
    Next

    $iconView.Refresh()

End

Public Sub Refresh(argIconThemeName As String)
    
    Application.Theme = argIconThemeName
    $iconView.Clear()
    Stock.Refresh()
    setIcons()
    
End

Public Sub _new(argContainer As Container)
    
    $iconView = New IconView(argContainer)
    $iconView.Expand = True
    setIcons()
    
End
