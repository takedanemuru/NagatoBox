' Gambas class file

Inherits NagatoDynamicSubMenu

Private Sub addSummaryMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "ModeMenu"
    
    With yukiMenu
        .Text = ("Summary")
        .Picture = Me._GetCheckedIcon(NagatoSettingsOSD.ForecastMode = MikuruForecastMode.Summary)
        .Tag = MikuruForecastMode.Summary
    End With
    
End

Private Sub addFullTextMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "ModeMenu"
    
    With yukiMenu
        .Text = ("FullForecast")
        .Picture = Me._GetCheckedIcon(NagatoSettingsOSD.ForecastMode = MikuruForecastMode.Full)
        .Tag = MikuruForecastMode.Full
    End With
    
End

Public Sub _RefreshMenu() ' This method is virtual, MUST be overridden.
    
    addSummaryMenu()
    addFullTextMenu()
    
End

Public Sub ModeMenu_Click()
    
    NagatoSettingsOSD.ForecastMode = Last.Tag
    
End
