' Gambas class file

Inherits NagatoDynamicSubMenu

Private $weatherElement As NagatoWeatherElement

Private Sub addConditionMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Picture = NagatoWeatherIcon.GetIconMono($weatherElement.IconId)
        .Text = Subst$("Condition : &1", NagatoWeatherCondition.GetText($weatherElement.IconId))
    End With
    
End

Private Sub addTemperatureMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Text = Subst$("Temperature : &1 Â°C", $weatherElement.Temperature)
    End With
    
End

Private Sub addPrecipitationMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Text = Subst$("Precipitation : &1 mm", $weatherElement.Precipitation)
    End With
    
    
End

Private Sub addPressureMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Text = Subst$("Pressure : &1 HPa", $weatherElement.Pressure)
    End With
    
End

Private Sub addHumidityMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Text = Subst$("Humidity : &1 %", $weatherElement.Humidity)
    End With
    
End

Private Sub addWindDirectionMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Text = Subst$("WindDirection : &1", $weatherElement.WindDirection)
    End With
    
End

Private Sub addWindSpeedMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Text = Subst$("WindSpeed : &1 km/h", $weatherElement.WindSpeed)
    End With
    
End

Public Sub _RefreshMenu()
    
    If Not NagatoWeatherCache.IsReady Then Return
    
    $weatherElement = NagatoWeatherCache.GetWeatherElementMostRecent()
    addConditionMenu()
    addTemperatureMenu()
    addPrecipitationMenu()
    addPressureMenu()
    addHumidityMenu()
    addWindDirectionMenu()
    addWindSpeedMenu()
    
End
