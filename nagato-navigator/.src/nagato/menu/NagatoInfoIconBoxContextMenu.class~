' Gambas class file

Inherits NagatoInfobarContextMenu

Private $desktopWindow As DesktopWindow

Private Sub addDesktopMenu(argMenu As Menu) 
    
    Dim yukiCount As Integer
    Dim yukiMenu As Menu
    
    For yukiCount = 0 To Desktop.Count - 1
        yukiMenu = New Menu(argMenu) As "DesktopMenu"
        With yukiMenu
            .Text = Subst$(("Desktop #&1"), yukiCount + 1)
            .Enabled = Not (yukiCount = $desktopWindow.Desktop)
            .Tag = yukiCount
        End With
    Next
    
End

Private Sub addMoveToMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu)
    
    With yukiMenu
        .Text = ("Move To...")
    End With
    
    addDesktopMenu(yukiMenu)
    
End

Private Sub addMaximizeMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "MaximizeMenu"
    
    With yukiMenu
        .Text = IIf($desktopWindow.Maximized, ("Unmaximize"), ("Maximize"))
    End With
    
End

Private Sub addMinimizeMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "MinimizeMenu"
    
    With yukiMenu
        .Text = IIf($desktopWindow.Minimized, ("Unminimize"), ("Minimize"))
    End With
    
End

Private Sub addCloseMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "CloseMenu"
    
    With yukiMenu
        .Picture = MikuruMonoIconBlue.Get("button-cross", 2 * MikuruUX.Grid)
        .Text = ("Close")
    End With
    
End

Private Sub addShowDesktopMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "ShowDesktopMenu"
    
    With yukiMenu
        .Text = ("Show Desktop")
        .Picture = MikuruMonoIconBlue.Get("desktop", 2 * MikuruUX.Grid)
    End With
    
End

Public Sub _Initialize()
    
    $desktopWindow = Me._$optionalVariable
    
    addMoveToMenu()
    addMaximizeMenu()
    addMinimizeMenu()
        MikuruMenuSeparator.Set(Me._$rootMenu)
    addCloseMenu()
        MikuruMenuSeparator.Set(Me._$rootMenu)
    addShowDesktopMenu()
    
End

Public Sub MaximizeMenu_Click()
    
    $desktopWindow.Maximized = Not $desktopWindow.Maximized
    
End

Public Sub MinimizeMenu_Click()
    
    $desktopWindow.Minimized = Not $desktopWindow.Minimized
    
End

Public Sub CloseMenu_Click()
    
    $desktopWindow.Close()
    
End

Public Sub DesktopMenu_Click()
    
    $desktopWindow.Desktop = Last.Tag
    
End

Public Sub ShowDesktopMenu_Click()
    
    MikuruDesktop.ShowDesktop()
    
End
