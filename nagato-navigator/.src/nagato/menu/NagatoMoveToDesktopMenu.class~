' Gambas class file

Inherits NagatoDynamicSubMenu

Private $desktopWindow As DesktopWindow

Event Move(argDesktop As Integer)

Public Sub _RefreshMenu() ' This method is virtual, MUST be overridden.
    
    Dim yukiCount As Integer
    Dim yukiMenu As Menu
    
    For yukiCount = 0 To Desktop.Count - 1
        yukiMenu = New Menu(Me._$rootMenu) As "DesktopMenu"
        With yukiMenu
            .Text = Subst$(("Desktop #&1"), yukiCount + 1)
            .Picture = Me._GetCheckedIcon(yukiCount = $desktopWindow.Desktop)
            .Tag = yukiCount
        End With
    Next
    
End

' Public Sub _new(argParent As Menu, argDesktopWindow As DesktopWindow)
' 
'     Me._$rootMenu = argParent
'     Me._InitializeMenu()
'     $desktopWindow = argDesktopWindow
'     
' End

Public Sub DesktopMenu_Click()
    
    $desktopWindow.Desktop = Last.Tag
    
End
