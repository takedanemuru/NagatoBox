' Gambas class file

Inherits NagatoMenu

Event Switch(argMode As Integer)

Private Sub addSelectLabelColorMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "SelectLabelColorMenu"
    
    With yukiMenu
        .Text = ("select label color")
        .Picture = MikuruMonoIconBlue.Get("paint-bucket")
    End With
    
End

Private Sub addApplicationSwitcherMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "Menu"
    
    With yukiMenu
        .Picture = MikuruMonoIconBlue.Get("gear")
        .Text = ("Tasks")
        .Tag = NagatoInfo.IconBox
    End With
    
End

Private Sub addBatteryMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "Menu"
    
    With yukiMenu
        .Picture = MikuruMonoIconBlue.Get("battery")
        .Text = ("Battery")
        .Tag = NagatoInfo.BatteryAlert
    End With
    
End

Private Sub addMusicMenu()
    
    Dim yukiMenu As New Menu(Me._$rootMenu) As "Menu"
    
    With yukiMenu
        .Picture = MikuruMonoIconBlue.Get("music")
        .Text = ("Music")
        .Tag = NagatoInfo.Music
    End With
    
End
    
Private Sub addRssMenu()
    
   Dim yukiMenu As New Menu(Me._$rootMenu) As "Menu"
    
    With yukiMenu
        .Picture = MikuruMonoIconBlue.Get("feed")
        .Text = ("Rss")
        .Tag = NagatoInfo.Rss
    End With 
    
End

Private Sub addSystemMenu()
    
   Dim yukiMenu As New Menu(Me._$rootMenu) As "Menu"
    
    With yukiMenu
        .Picture = MikuruMonoIconBlue.Get("oscilloscope")
        .Text = ("System")
        .Tag = NagatoInfo.System
    End With 
    
End

Public Sub _InitializeMenu() ' override.
    
    addSelectLabelColorMenu()
        MikuruMenuSeparator.Set(Me._$rootMenu)
    addApplicationSwitcherMenu()
    addBatteryMenu()
    addMusicMenu()
    addRssMenu()
    addSystemMenu()
    
End

Public Sub SelectLabelColorMenu_Click()
    
    Dialog.Title = ("select label color")
    Dialog.Color = NagatoSettingsInfobar.LabelColor
    
    If Not Dialog.SelectColor() Then
        NagatoSettingsInfobar.LabelColor = Dialog.Color
    Endif
    
End

Public Sub Menu_Click()
    
    Raise Switch(Last.Tag)
    
End
