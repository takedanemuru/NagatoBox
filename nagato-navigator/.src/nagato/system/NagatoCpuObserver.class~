' Gambas class file

Create Static

Private $prevCpuUsage As Integer
Private $prevCpuTotal As Integer
Private $currentCpuUsage As Integer
Private $currentCpuTotal As Integer

Private Function getSystemSnapShot() As String[]
    
    Dim yukiCpuData As String[] = Split(File.Load("/proc/stat"), " \n", "", True)
    
    Return yukiCpuData
    
End

Public Sub setPrevData()
    
    Dim yukiSnapShot As String[] = getSystemSnapShot()
    
    $prevCpuUsage = yukiSnapShot[1] + yukiSnapShot[2] + yukiSnapShot[3]
    $prevCpuTotal = $prevCpuUsage + yukiSnapShot[4]
    
End

 Public Sub setCurrentData()
    
    Dim yukiSnapShot As String[] = getSystemSnapShot()
        
    $currentCpuUsage = yukiSnapShot[1] + yukiSnapShot[2] + yukiSnapShot[3]
    $currentCpuTotal = $currentCpuUsage + yukiSnapShot[4]
    
End

Public Function getCpuRate() As Float
    
    Return ($currentCpuUsage - $prevCpuUsage) / ($currentCpuTotal - $prevCpuTotal)
    
Catch
    Return 0
    
End
