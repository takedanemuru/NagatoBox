' Gambas class file

Inherits NagatoSettings

Create Static

Property Latitude As Float
Property Longitude As Float
Property Altitude As Float
Property VisibleName As String

Private Function Latitude_Read() As Float

    Dim yukiLatitude As String = Me._$settings["geo/latitude", ""]

    If yukiLatitude = "" Then
        Return 34.773632
    Else
        Return CFloat(NagatoCipher.Decryption(yukiLatitude))
    Endif

End

Private Sub Latitude_Write(Value As Float)

    Me._$settings["geo/latitude"] = NagatoCipher.Encryption(Value)
    Me._$settings.Save()
    
End

Private Function Longitude_Read() As Float

    Dim yukiLongitude As String = Me._$settings["geo/longitude", ""]

    If yukiLongitude = "" Then
        Return 135.3166017
    Else
        Return CFloat(NagatoCipher.Decryption(yukiLongitude))
    Endif

End

Private Sub Longitude_Write(Value As Float)

    Me._$settings["geo/longitude"] = NagatoCipher.Encryption(Value)
    Me._$settings.Save()

End

Private Function Altitude_Read() As Float

    Return 5

End

Private Sub Altitude_Write(Value As Float)

    'pass

End

Private Function VisibleName_Read() As String

    Dim yukiVisibleName As String = Me._$settings["geo/visible-name", ""]

    If yukiVisibleName = "" Then
        Return "Nishinomiya-City Japan"
    Else
        Return NagatoCipher.Decryption(yukiVisibleName)
    Endif

End

Private Sub VisibleName_Write(Value As String)

    Me._$settings["geo/visible-name"] = NagatoCipher.Encryption(Value)
    Me._$settings.Save()

End
