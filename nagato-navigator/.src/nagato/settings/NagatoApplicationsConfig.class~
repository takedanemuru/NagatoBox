' Gambas class file

Create Static

Property Recent As String[]
Property Read HasData As Boolean
Property Read Max As Integer

Private Const MaxCount As Integer = 5
Private $recentAppPaths As String[]

Public Sub PushNewApp(argPath As String)
    
    If $recentAppPaths.Find(argPath) = -1 Then ' .Find() returns -1 when there's no path.
        $recentAppPaths.Add(argPath, 0)
    Else
        $recentAppPaths.Remove($recentAppPaths.Find(argPath), 1)
        $recentAppPaths.Add(argPath, 0)
    Endif
    
    If $recentAppPaths.Count >= MaxCount Then $recentAppPaths.Extract(MaxCount)
    NagatoSettingsCore.SetRecentApps($recentAppPaths)
    
End

Private Function Recent_Read() As String[]

    Return $recentAppPaths

End

Private Sub Recent_Write(Value As String[])

    $recentAppPaths = Value

End

Private Function HasData_Read() As Boolean

    If $recentAppPaths[0] <> "" Then
        Return True
    Else
        Return False
    Endif

End

Private Function Max_Read() As Integer

    Return $recentAppPaths.Max

End
