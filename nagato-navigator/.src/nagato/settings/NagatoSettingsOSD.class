' Gambas class file

Inherits NagatoSettings

Create Static

Property ClockFace As Integer
Property Radius As Integer
Property ForecastMode As Integer
Property Positions As Integer

Public Enum LeftSide, RightSide, FreePosition

Private Function ClockFace_Read() As Integer

    Return Me._$settings["osd/clockface", 5]

End

Private Sub ClockFace_Write(Value As Integer)

    Me._$settings["osd/clockface"] = Value
    Me._$settings.Save()
    
End

Public Sub GetColor(argUniqueName As String, Optional argDefault As Integer) As Integer ' as color
    
    Dim yukiColor As Integer = IIf(argDefault, argDefault, MikuruColor.NagatoPurple)
    
    Return Me._$settings[Subst$("color/&1", argUniqueName), yukiColor]
    
End

Public Sub SetColor(argUniqueName As String, argColor As Integer)
    
    Me._$settings[Subst$("color/&1", argUniqueName)] = argColor
    Me._$settings.Save()
    
End

Public Sub GetLastClosed(argUniqueName As String, Optional argDefault As Boolean = True) As Boolean
    
    Return Me._$settings[Subst$("lastClosed/&1", argUniqueName), argDefault]
    
End

Public Sub SetLastClosed(argUniqueName As String, argIsClosed As Boolean)
    
    Me._$settings[Subst$("lastClosed/&1", argUniqueName)] = argIsClosed
    Me._$settings.Save()
    
End

Private Function Radius_Read() As Integer

    Return Me._$settings["osd/shape", 0]

End

Private Sub Radius_Write(Value As Integer)
    
    Me._$settings["osd/shape"] = Value
    Me._$settings.Save()
    
End

Private Function ForecastMode_Read() As Integer

    Return Me._$settings["osd/forecast_mode", MikuruForecastMode.Summary]

End

Private Sub ForecastMode_Write(Value As Integer)

    Me._$settings["osd/forecast_mode"] = Value
    Me._$settings.Save()

End

Private Function Positions_Read() As Integer

    Return Me._$settings["osd/positions", Me.RightSide]

End

Private Sub Positions_Write(Value As Integer)

    Me._$settings["osd/positions"] = Value
    Me._$settings.Save()

End
