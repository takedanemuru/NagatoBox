' Gambas class file

Create Static

Public Function GetThumbnail(argPath As String, argSize As Integer) As Picture
    
    Dim yukiImage As Image = Image.Load(argPath)
    
    If Max(yukiImage.H, yukiImage.W) > argSize Then
        If yukiImage.Height >= yukiImage.Width Then
            yukiImage = yukiImage.Stretch(Int(argSize * (yukiImage.Width / yukiImage.Height)), argSize)
        Else
            yukiImage = yukiImage.Stretch(argSize, Int(argSize * (yukiImage.Height / yukiImage.Width)))
        Endif
    Endif
    
    Return yukiImage.Picture
    
Catch
    Debug "can't load file"
    Debug argPath
    Return Stock[Subst$("&1/file", argSize)]

End

Public Function Get(argPath As String, argSize As Integer) As Picture
    
    Dim yukiPicture As Picture
    
    If NagatoDBThumbnail.HasThumbnail(argPath, argSize) Then
        Return NagatoDBThumbnail.Get(argPath, argSize)
    Else
        yukiPicture = GetThumbnail(argPath, argSize)
        NagatoDBThumbnail.Push(argPath, argSize, yukiPicture)
        Return yukiPicture
    Endif
    
End
