' Gambas class file

Private $targetDirectory As String

Event Thumbnail(argPath As String, argIcon As Picture)
Event ThumbnailWithFullPath(argPath As String, argIcon As Picture)

Private Function getMimeType(argRelativePath As String) As String
    
    Return DesktopMime.FromFile($targetDirectory &/ argRelativePath).Type
    
 Catch
     Return ""
    
End

Public Sub Start(argDirectory As String, argIconSize As Integer)
    
    Dim yukiRelativePath As String
    Dim yukiIcon As Picture
    
    $targetDirectory = argDirectory
    
    For Each yukiRelativePath In Dir(argDirectory, "*", gb.File).Sort()
        If getMimeType(yukiRelativePath) Begins "image" Then
            yukiIcon = NagatoImageThumbnailer.Get(argDirectory &/ yukiRelativePath, argIconSize)
            Raise Thumbnail(yukiRelativePath, yukiIcon)
        Endif
    Next
    
End

Public Sub StartWithArray(argArray As String[], argIconSize As Integer)
    
    Dim yukiPath As String
    Dim yukiIcon As Picture
    
    For Each yukiPath In argArray
        If Not MikuruMimeType.IsImageFile(yukiPath) Then Continue
        If Not Exist(yukiPath) Then Continue
            yukiIcon = NagatoImageThumbnailer.Get(yukiPath, argIconSize)
            Raise ThumbnailWithFullPath(yukiPath, yukiIcon)
    Next
    
End

Public Sub _new()
    
    
    
End
