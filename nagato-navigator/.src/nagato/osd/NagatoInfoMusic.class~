' Gambas class file

Inherits NagatoInfo

Private Function getStatusString() As String
    
    Select Case NagatoMusicPlayer.Status
        Case MediaPlayer.Playing
            Return Subst$("  &1", NagatoMusicPlayer.ProgressInText)
        Case MediaPlayer.Paused
            Return ("  [paused]")
        Case MediaPlayer.Ready
            Return ("  [stopped]")
    End Select
    
End

Private Function getMainLine() As String
    
    Dim yukiLine As String
    
    With NagatoMusicPlayer
        yukiLine = .Title
        If .Artist <> "" Then yukiLine &= Subst$("  Artist:&1", .Artist)
        If .Album <> "" Then yukiLine &= Subst$("  Album:&1", .Album)
        yukiLine &= getStatusString()
    End With
    
    Return Subst$(("now playing: &1"), yukiLine)
    
End

Public Sub DrawInfo(argOffsetLeft As Integer)
    
    Me._DrawMainLineText(getMainLine(), argOffsetLeft)
    
End

Public Sub _SetType()
    
    Me._$type = NagatoInfo.Music
    
End

Public Sub PopUpMenu(argMouseX As Integer) 'override
    
    Dim yukiContextMenu As New NagatoInfoMusicContextMenu
    
    yukiContextMenu.PopUp()
    
End
