' Gambas class file

Inherits NagatoInfoPainter

Private $workspaceFont As New Font
Private $workspaceText As String

Private Sub drawWorkspaceBox(argIndex As Integer)
    
    With Paint
        .Brush = .Color(IIf(argIndex = Desktop.Current, Color.Yellow, Color.White))
        .Rectangle(24 * argIndex + 2 + 8, 2, 20, 20)
        .Fill()
        .Brush = .Color(Color.DarkBlue)
        .Text(argIndex + 1, 8 + 24 * argIndex, 0, 24, 24, Align.Center)
        .Fill()
    End With
    
End

Public Sub Refresh()
    
    $workspaceFont.Size = 9
    $workspaceFont.Bold = True
    Me._$drawingArea.Width = 24 * Desktop.Count + 16

    Me._$drawingArea.Refresh()
    
End

Public Sub _InitializeDrawingArea()
    
    With Me._$drawingArea
        .Expand = False
        .Width = 24 * Desktop.Count + 16
        .Background = NagatoSettingsInfobar.LabelColor
    End With
    
End

Public Sub DrawingArea_Draw()
    
    Dim yukiCount As Integer
    
    With Paint
        .Begin(Me._$drawingArea)
        For yukiCount = 0 To Desktop.Count - 1
            drawWorkspaceBox(yukiCount)
        Next
        .End()
    End With
    
End

Public Sub DrawingArea_MouseDown()
    
    If Mouse.Right Then Return
    
    If 8 > Mouse.X Or If Mouse.X > 24 * Desktop.Count Then
        Return
    Else
        Desktop.Current = (Mouse.X - 8) Div 24
    End If
    
Catch
    Return
    
End

Public Sub DrawingArea_Menu()
    
    Dim yukiRootMenu As New Menu(HaruhiInfobar2)
    Dim yukiMenu As New NagatoQuickListMenu(yukiRootMenu)
    
    yukiRootMenu.Popup()
    
End
