' Gambas class file

Private $persona As Picture

Private Sub setPersona()
    
    $persona = Picture.Load(NagatoSettings.PersonaPath)
    Me.Picture = $persona
    
End

Private Sub setPosition()
    
    With Me
        .H = $persona.H
        .W = $persona.W
        .Y = Screen.H - $persona.H
        .X = 100
    End With
    
End

Public Sub ChangePersona()
    
    setPersona()
    
End

Public Sub EnsureVisible()
    
    Dim yukiWindow As New DesktopWindow(Me.Id)
    
    Me.Show()
    yukiWindow.Desktop = Desktop.Current
    
    HaruhiBalloon.NewFortune()
    HaruhiBalloon.X = Me.X
    
End

Public Sub SetText(argText As String)
    
    Dim yukiWindow As New DesktopWindow(Me.Id)
    
    Me.Show()
    yukiWindow.Desktop = Desktop.Current
    
    HaruhiBalloon.SetText(argText)
    HaruhiBalloon.X = Me.X
    
End

Public Sub Form_Open()
    
    setPersona()
    setPosition()
    
End

Public Sub Form_DblClick()
    
    HaruhiBalloon.Close()
    
    Me.Close()
    
End

Public Sub Form_Move()

    Me.Y = Screen.H - $persona.H

End

Public Sub Form_KeyPress()
    
    Select Case Key.Code
        Case Key.Left
            Me.X -= 16
        Case Key.Right
            Me.X += 16
    End Select
    
End
