' Gambas class file

Private $persona As Picture

Private Sub setPersona()
    
    $persona = Picture.Load("Pictures/Personas/YukiRender-1.png")
    '$persona = Picture.Load("Pictures/Personas/rainy.png")
    '$persona = Picture.Load("Pictures/Personas/laptop2.png")
    Me.Picture = $persona
    
End

Private Sub setPosition()
    
    With Me
        .H = $persona.H
        .W = $persona.W
        .Y = Screen.H - $persona.H
        .X = 100
    End With
    
End

Public Sub EnsureVisible()
    
    Dim yukiWindow As New DesktopWindow(Me.Id)
    
    Me.Show()
    yukiWindow.Desktop = Desktop.Current
    
    HaruhiBalloon.NewFortune()
    
End

Public Sub SetText(argText As String)
    
    Dim yukiWindow As New DesktopWindow(Me.Id)
    
    Me.Show()
    yukiWindow.Desktop = Desktop.Current
    
    HaruhiBalloon.SetText(argText)
    
End

Public Sub Form_Open()
    
    setPersona()
    setPosition()
    
End

Public Sub Form_DblClick()
    
    HaruhiBalloon.Close()
    
    Me.Close()
    
End

Public Sub Form_Move()

    Me.Y = Screen.H - $persona.H

End
