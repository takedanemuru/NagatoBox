' Gambas class file

Inherits NagatoSignal

Private $button As MenuButton
Private $observer As Observer
Private $deviceIndex As Integer = 0

Private Sub initializeButton(argContainer As Container)
    
    $button = New MenuButton(argContainer) As "PowerButton"
    
    With $button
        .Picture = MikuruIcon.Get("wireless-router")
        .Border = False
        .Foreground = NagatoSettings.ForegroundColor
        .AutoResize = True
        .Arrow = False
    End With
    
End

Public Sub _new(argContainer As Container)
    
    initializeButton(argContainer)
    $observer = New Observer(NagatoTimer) As "Asakura"
    
End

Private Sub setButtonText()
    
    Dim yukiSpeed As Float = NagatoNetworkManager.GetSpeed($deviceIndex)
    
    Debug NagatoNetworkManager.DeviceCount
    
    $button.Text = Format$(yukiSpeed / 1000, "##0Mbps")
    
End

Public Sub Asakura_Timer()
    
    $button.Visible = NagatoSettings.ShowNetworkButton
    
    If $button.Visible Then setButtonText()
    
End
