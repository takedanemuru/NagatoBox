' Gambas class file

Create Static

Property Read DeviceCount As Integer

Private Const Service As String = "org.gambas.nagato.network.manager"
Private Const ObjectPath As String = "/org/nagato/network/manager"
Private Const Interface As String = "org.gambas.nagato.network.manager.nagatointerface"

Private $proxy As DBusProxy

Public Function GetSpeed(argDeviceIndex As Integer) As Float
    
    Return $proxy.GetDeviceSpeed(argDeviceIndex)
    
Catch
    Return 0
    
End

Public Sub Activate()
    
    If Not DBus.Session.Applications.Exist(Service) Then
        Shell "nagato-network-manager --non-gui"
    Endif
    
End

Public Sub _new()
    
    Try $proxy = DBus[Service][ObjectPath, Interface]
    
End

Private Function DeviceCount_Read() As Integer

    Return $proxy.DeviceCount

Catch
    Return 0

End
