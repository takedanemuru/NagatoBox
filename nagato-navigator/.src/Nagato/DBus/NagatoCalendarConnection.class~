' Gambas class file

Create Static

Property Read Proxy As DBusProxy

Private Const Service As String = "Session://org.gambas.nagato.calendar"
Private Const ObjectPath As String = "/org/nagato/calendar"
Private Const Interface As String = "org.gambas.nagato.calendar.nagatointerface"

Public Sub Ensure()
    
    If Not DBus.Session.Applications.Exist("org.gambas.nagato.calendar") Then
        Shell "nagato-calendar -d" Wait
    Endif
    
End

Public Function GetRepositoryCount() As Integer
    
    Return Me.Proxy.RepositoryCount
    
End

Public Function GetRepositoryName(argIndex As Integer) As String
    
    Return Me.Proxy.GetRepositoryName(argIndex)
    
End

Public Function GetRepositoryIssueCount(argIndex As Integer) As Integer
    
    Return Me.Proxy.GetRepositoryIssues(argIndex).Count
    
End

Public Function GetRepositoryIssues(argIndex As Integer) As String[]
    
    Return Me.Proxy.GetRepositoryIssues(argIndex)
    
End

Private Function Proxy_Read() As DBusProxy

    Dim yukiProxy As DBusProxy = DBus[Service][ObjectPath, Interface]

    Return yukiProxy

End
