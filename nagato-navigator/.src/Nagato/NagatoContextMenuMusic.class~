' Gambas class file

Inherits NagatoContextMenu

Private Const ApplicationName As String = "org.gambas.nagato.player.x"
Private Const ObjectPath As String = "/org/nagato/player/x"
Private Const Interface As String = "org.gambas.nagato.player.x.nagatointerface"

Private $rootMenu As Menu

Private Sub initializeMenus()
    
    Me._AddMenu("Play", 0, "button-play")
    Me._AddMenu("Pause", 1, "button-pause")
    Me._AddMenu("Back", 2, "button-rew")
    Me._AddMenu("Next", 3, "button-ff")
    'Me._AddMenu("Shuffle", 0, "button-shuffle")
    'Me._AddMenu("Repeat", 0, "button-synchronize")
    
End

Public Sub _new()
    
    Me._$rootMenu = New Menu(HaruhiMain)
    initializeMenus()
    
End

Public Sub ContextMenu_Click()
    
    Dim yukiPlayer As DBusProxy = DBus[ApplicationName][ObjectPath, Interface]
    
    Select Case Last.Tag
        Case 0
            yukiPlayer.Play()
        Case 1
            yukiPlayer.Pause()
        Case 2
            yukiPlayer.Back()
        Case 3
            yukiPlayer.Next()
    End Select
    
End
