' Gambas class file

Create Static

Property Read CpuUsage As Float
Property Read MemoryUsage As Float
Property Read SwapUsage As Float
Property Read ProcessCount As Integer
Property Read Activated As Boolean
Property Read SystemLoad As Float

Private $taskmanager As DBusProxy

Event Finished

Private Sub initializeTaskmanager()
    
    Dim yukiInterface As String = "org.gambas.nagato.taskmanager.nagatointerface"
    
    $taskmanager = DBus["org.gambas.nagato.taskmanager"]["/org/nagato/taskmanager", yukiInterface]
    
End

Public Sub Refresh()
    
    If Not DBus.Session.Applications.Exist("org.gambas.nagato.taskmanager") Then
        Shell Subst$("nagato-taskmanager --register &1", Application.Name)
    Endif
    
    initializeTaskmanager()
    
End

Public Sub Stop()
    
    
    
End

Public Sub _new()
    
    initializeTaskmanager()
    
End

Private Function CpuUsage_Read() As Float

    Return $taskmanager.CpuUsage

End

Private Function MemoryUsage_Read() As Float

    Return $taskmanager.MemoryUsage

End

Private Function SwapUsage_Read() As Float

    Return $taskmanager.SwapUsage

End

Private Function Activated_Read() As Boolean

    Return True

End

Private Function ProcessCount_Read() As Integer

    Return $taskmanager.ProcessCount

End

Private Function SystemLoad_Read() As Float

    Return Max($taskmanager.CpuUsage, $taskmanager.MemoryUsage)

End
