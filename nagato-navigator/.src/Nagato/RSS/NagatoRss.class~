' Gambas class file

Create Static

Property Read Feeds As NagatoRssFeed2[]

Private Const BBCTop As String = "http://feeds.bbci.co.uk/news/rss.xml"
Private Const BBCWorld As String = "http://feeds.bbci.co.uk/news/world/rss.xml"
Private Const BBCTechnology As String = "http://feeds.bbci.co.uk/news/technology/rss.xml"
Private Const SourceforgeJpMagazine As String = "http://rss.rssad.jp/rss/sourceforge/magazine/rss"
Private Const MyNavi As String = "http://feeds.journal.mycom.co.jp/rss/mycom/pc"
Private Const Phoronix As String = "http://www.phoronix.com/rss.php"
Private Const Slashdot As String = "http://rss.slashdot.org/Slashdot/slashdot"
Private Const DefenceUpdate As String = "http://feeds.feedblitz.com/feedburner/defenseupdate"

Private $feeds As New NagatoRssFeed2[]
'Private NagatoSettings.FeedLines As New String[]
Private $count As Integer

Event Ready 

Private Sub setFeeds()
    
    Dim yukiLine As String
    Dim yukiFeed As NagatoRssFeed2
    
    Try $feeds.Clear()
    
    For Each yukiLine In NagatoSettings.FeedLines
        yukiFeed = New NagatoRssFeed2(yukiLine) As "RssFeed"
    Next
    
End

Private Sub checkFeedCount()
    
    Inc $count
    If $count = NagatoSettings.FeedLines.Count Then Raise Ready
    
End

Public Sub Refresh()
    
    ' Try NagatoSettings.FeedLines.Clear()
    ' 
    ' NagatoSettings.FeedLines.Add(BBCTop)
    ' NagatoSettings.FeedLines.Add(BBCWorld)
    ' NagatoSettings.FeedLines.Add(BBCTechnology)
    ' NagatoSettings.FeedLines.Add(SourceforgeJpMagazine)
    ' NagatoSettings.FeedLines.Add(MyNavi)
    ' NagatoSettings.FeedLines.Add(Phoronix)
    ' NagatoSettings.FeedLines.Add(Slashdot)
    ' NagatoSettings.FeedLines.Add(DefenceUpdate)
    
    setFeeds()
    
End

Public Sub RssFeed_Finished(argFeed As NagatoRssFeed2)
    
    Debug argFeed.Items.Count
    
    If argFeed.Items.Count > 0 Then 
        Try $feeds.Add(argFeed)
    End If
    
    checkFeedCount()
    
End

Public Sub RssFeed_Error()
    
    checkFeedCount()
    
End

Private Function Feeds_Read() As NagatoRssFeed2[]

    Return $feeds

End
