' Gambas class file

Inherits NagatoContextMenu

Private Const ApplicationName As String = "org.gambas.nagato.player.x"
Private Const ObjectPath As String = "/org/nagato/player/x"
Private Const Interface As String = "org.gambas.nagato.player.x.nagatointerface"

Private $proxy As DBusProxy
'Private $rootMenu As Menu
Private $queueMenu As NagatoCurrentQueueMenu

Public Sub _InitializeMenus()
    
    $queueMenu = New NagatoCurrentQueueMenu(Me._$rootMenu)
    
    Me._AddMenu("Play", 0, "button-play")
    Me._AddMenu("Pause", 1, "button-pause")
    Me._AddMenu("Back", 2, "button-rew")
    Me._AddMenu("Next", 3, "button-ff")
    Me._AddMenu("Shuffle", 4, IIf($proxy.Shuffle, "button-check", Null))
    Me._AddMenu("Repeat", 5, IIf($proxy.Repeat, "button-check", Null))
    
End

Public Sub _Initialize()
    
    $proxy = DBus[ApplicationName][ObjectPath, Interface]
    
End

Public Sub ContextMenu_Click()
    
    Dim yukiPlayer As DBusProxy = DBus[ApplicationName][ObjectPath, Interface]
    
    Select Case Last.Tag
        Case 0
            yukiPlayer.Play()
        Case 1
            yukiPlayer.Pause()
        Case 2
            yukiPlayer.Back()
        Case 3
            yukiPlayer.Next()
        Case 4
            yukiPlayer.ToggleShuffle()
        Case 5
            yukiPlayer.ToggleRepeat()
    End Select
    
End
