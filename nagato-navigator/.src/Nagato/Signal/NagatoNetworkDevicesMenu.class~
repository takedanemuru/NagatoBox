' Gambas class file

Inherits NagatoSubMenu

Event Selected(argIndex As Integer, argPicture As Picture)

Private Function getMenuText(argIndex As Integer, argDeviceType As String) As String
    
    Dim yukiText As String = argDeviceType & ": "
    
    Debug argDeviceType
    Debug yukiText
    
    yukiText &= Format$(NagatoNetworkManager.GetSpeed(argIndex) / 1000, "##0Mbps")
    
    Return yukiText
    
End

Private Sub addDeviceMenu(argIndex As Integer, argRootMenu As Menu)
    
    Dim yukiMenu As New Menu(argRootMenu) As "DeviceMenu"
    
    With yukiMenu
        .Picture = MikuruIcon.GetNetworkDeviceIcon(argIndex)
        .Text = NagatoNetworkManager.GetDeviceTypeReadable(argIndex)
        .Tag = argIndex
    End With
    
End

Public Sub _InitializeParentMenu(argRootMenu As Menu)
    
    Dim yukiDeviceIndex As Integer 
    
    Debug NagatoNetworkManager.DeviceCount
    
    For yukiDeviceIndex = 0 To NagatoNetworkManager.DeviceCount - 1
       addDeviceMenu(yukiDeviceIndex, argRootMenu)
    Next
    
End

Public Sub DeviceMenu_Click()
    
    Raise Selected(Last.Tag, Last.Picture)
    
End
