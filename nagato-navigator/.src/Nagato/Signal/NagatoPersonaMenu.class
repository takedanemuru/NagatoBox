' Gambas class file

Inherits NagatoSubMenu

Private Sub refreshMenu()
    
    Dim yukiIndex As Integer
    
    Me._$parentMenu.Children.Clear()
    
    For yukiIndex = 1 To 4
        Me._AddMenu(yukiIndex, yukiIndex)
    Next
    
End

Public Sub _InitializeParentMenu(argRootMenu As Menu)
    
    Me._$parentMenu = New Menu(argRootMenu) As "ParentMenu"
    
    With Me._$parentMenu
        .Text = ("Personas")
        .Picture = MikuruIcon.Get("equalizer")
    End With
    
End

Public Sub _InitializeMenus()
    
    Me._AddMenu("", 0) ' as dummy menu to get "Show" event
    
End

Public Sub ParentMenu_Show()
    
    refreshMenu()
    
End

Public Sub MenuItem_Click()
    
    NagatoSettings.PersonaPath = Subst$("Pictures/Personas/&1.png", Last.Tag)
    
    HaruhiPersona.ChangePersona()
    
End
