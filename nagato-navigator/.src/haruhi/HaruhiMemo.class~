' Gambas class file

Private Sub initializeMemoListBox()
    
    MemoListBox.List = Dir(MikuruDirectory.Memo).Sort()
    
End

Public Sub Refresh()
    
    initializeMemoListBox()
    
End

Public Sub Form_Open()
    
    Me.Center()
    initializeMemoListBox()
    
End

Public Sub MemoListBox_DblClick()

    Dim yukiMemo As NagatoMemo

    If Exist(MikuruDirectory.Memo &/ MemoListBox.Text) Then
        yukiMemo = New NagatoMemo(MemoListBox.Text)
    Endif

End

Public Sub OpenButton_Click()

    If MemoListBox.Text = "" Then Return
    
    MemoListBox_DblClick()

End

Public Sub DeleteButton_Click()

    If MemoListBox.Text = "" Then Return
    
    If Message.Delete(("YUKI.N> Are you sure to delete this memo?"), ("Cancel"), ("Delete")) = 2 Then
        Try Kill MikuruDirectory.Memo &/ MemoListBox.Text
    Endif
    
    HaruhiMemo.Refresh()
    
End

Public Sub NewButton_Click()

    Dim yukiMemo As NagatoMemo
    
    yukiMemo = New NagatoMemo

End
