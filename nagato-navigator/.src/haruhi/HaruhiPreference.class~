' Gambas class file

Private Sub setLocationData()
    
    With NagatoSettingsGeo
        LocationNameLabel.Text = .VisibleName
        LatitudeLabel.Text = .Latitude
        LongitudeLabel.Text = .Longitude
    End With
    
End

Private Sub setGridView()
    
    Dim yukiCount As Integer
    Dim yukiFeed As NagatoRssFeed
    
    RssGridView.Columns.Count = 1
    RssGridView.Rows.Count = NagatoRss.Count
    
    For yukiCount = 0 To NagatoRss.Max
        yukiFeed = NagatoRss.GetFeed(yukiCount)
        RssGridView[yukiCount, 0].Text = yukiFeed.GetTitle(0)
    Next
    
End

Private Sub setPreference()
    
    setLocationData()
    setGridView()
    
End

Public Sub Form_Open()
    
    setPreference()
    Me.Center()
    
End

Public Sub RssButtonBox_Click()

    Dim yukiRssFeeds As String[] = NagatoSettingsRss.Feeds

    If RssButtonBox.Text <> "" Then
        If NagatoSettingsRss.Feeds.Exist(RssButtonBox.Text) Then Return
        Debug RssButtonBox.Text
        yukiRssFeeds.Add(RssButtonBox.Text)
        NagatoSettingsRss.Feeds = yukiRssFeeds
        setGridView()
        NagatoRss.Refresh()
    Endif

End

Public Sub ChangeLoctionButton_Click()

    If HaruhiUserLocation.ShowDialog() = HaruhiUserLocation.Changed Then
        setLocationData()
        NagatoWeatherCache.Activate()
    Endif

End
