' Gambas class file

Private Sub pushCommandToHistory(argCommand As String)
    
    With NagatoSettingsCommandLine
        .PushCommand(argCommand)
        CommandlineComboBox.List = .CommandHistory
    End With
    
End

Private Sub executeCommand()
    
    Dim yukiOutput As String
    
    Shell CommandlineComboBox.Text To yukiOutput
    
    If yukiOutput <> "" Then HaruhiBalloon.TextAreaText = yukiOutput
    
Finally
    If Not Error Then pushCommandToHistory(CommandlineComboBox.Text)
    Return
    
End

Public Sub Form_Show()

    Me.Center()
    CommandlineComboBox.List = NagatoSettingsCommandLine.CommandHistory

End

Public Sub CommandlineComboBox_KeyPress()

    If Key.Code = 16777220 Then executeCommand()

End
