' Gambas class file

Private $trayIcon As TrayIcon
Private $popupMenu As New NagatoPopupMenu
Private $observer As Observer

Private Sub initializeTrayIcon()
    
    $trayIcon = New TrayIcon As "TrayIcon"
    
    With $trayIcon
        .Icon = MikuruIcon["speaker"]
        .Tooltip = NagatoAlsaState.Text
        .PopupMenu = "PopupMenu"
        .Show()
    End With
    
End

Public Sub _new()
    
    initializeTrayIcon()
    $observer = New Observer(NagatoAlsaState) As "Asakura"
    
End

Public Sub TrayIcon_Click()
    
    $popupMenu.Popup()
    
End

Public Sub TrayIcon_Scroll(argDelta As Float, argOrientation As Integer)
    
    NagatoAlsaState.SetVolume(NagatoAlsaState.Volume + CInteger(argDelta * 10))
    
End

Public Sub Asakura_Changed(argVolume As Integer)
    
    $trayIcon.Tooltip = NagatoAlsaState.Text
    
End
