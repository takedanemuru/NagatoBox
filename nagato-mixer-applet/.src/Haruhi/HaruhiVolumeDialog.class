' Gambas class file

Private $observer As Observer
Private $timer As New Timer As "Timer"
Private $count As Integer = 0

Public Sub _new()
    
    $observer = New Observer(NagatoAlsaState) As "Asakura"
    
End

Public Sub Form_Close()
    
    $timer.Enabled = False
    $count = 0
    
End

Public Sub Asakura_Changed2()
    
    Me.Show()
    Me.Center()
    $timer.Enabled = True
    $count = 0
    TextLabel1.Text = NagatoAlsaState.Text
    
    ProgressBar1.Value = NagatoAlsaState.Volume / 100
    
End

Public Sub Timer_Timer()
    
    Inc $count
    
    If $count > 5 Then Me.Close()
    
End

Public Sub Form_Open()

    Dim yukiPicture As Picture = Picture.Load("Pictures/headphones.png")

    Me.Picture = yukiPicture
    Me.W = yukiPicture.W
    Me.H = yukiPicture.H

End

Public Sub ProgressBar1_MouseDown()

    NagatoAlsaState.SetVolume(CInt(Mouse.X / Me.W * 10) * 10)

End
