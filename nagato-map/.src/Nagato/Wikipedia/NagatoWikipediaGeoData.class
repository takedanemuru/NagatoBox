' Gambas class file

Property Read Elements As NagatoWikipediaGeoDataElement[]

Private Const Api As String = "https://&1.wikipedia.org/w/api.php?action=query&format=xml&list=geosearch&gslimit=100&gsradius=10000&gscoord=&2|&3"

Private $downloader As New NagatoDownloaderWikipediaGeoData As "Downloader"

Event Finished
Event Error

Public Sub Start(argLatitude As Float, argLongitude As Float) As String
    
    $downloader.Lang = NagatoSettingsWikipedia.LanguageKey
    $downloader.Get(Subst$(Api, NagatoSettingsWikipedia.LanguageKey, argLatitude, argLongitude))
    
End

Public Sub Downloader_Finished()
    
    Raise Finished
    
End

Private Function Elements_Read() As NagatoWikipediaGeoDataElement[]

    Return $downloader.Elements

End
