' Gambas class file

Inherits NagatoMenuPipe

Private $tabstrip As TabStrip
Private $reloadButton As NagatoReloadButton
Private $wikipediaGrid As NagatoGridViewWikipedia
Private $wikipediaGeoData As New NagatoWikipediaGeoData As "WikipediaGeoData"

Event NewArticle(argUrl As String)

Private Sub initializeWikipediaListGrid()
    
    $tabStrip.Index = 1
    $wikipediaGrid = New NagatoGridViewWikipedia($tabstrip) As "WikipediaGridView"
    
End

Private Sub setWikipediaArticles()
    
    Dim yukiElement As NagatoWikipediaGeoDataElement
    
    For Each yukiElement In $wikipediaGeoData.Elements
        $wikipediaGrid.SetData(yukiElement.Title)
    Next
    
    $tabStrip.Index = 1
    
End

Public Sub Request(argLatitude As Float, argLongitude As Float)
    
    $wikipediaGeoData.Start(argLatitude, argLongitude)
    
End

Public Sub _new(argTabstrip As TabStrip)
    
    $tabstrip = argTabstrip
    initializeWikipediaListGrid()
    $reloadButton = New NagatoReloadButton(argTabstrip) As "Menu"
    
End

Public Sub WikipediaGeoData_Finished()
    
    $wikipediaGrid.Clear()
    setWikipediaArticles()
    
End

Public Sub WikipediaGridView_Activate(argRow As Integer)
    
    Dim yukiElement As NagatoWikipediaGeoDataElement = $wikipediaGeoData.Elements[argRow]
    
    Raise NewArticle(yukiElement.Url)
    HaruhiMain.SetMarker(yukiElement.Latitude, yukiElement.Longitude)
    
End
