' Gambas class file

Inherits NagatoInfo

Private $bookmarkGrid As NagatoGridViewBookmark

Private Sub setBookmarkData()
    
    Dim yukiResult As Result = NagatoDBGeo.GetAllResult()
    Dim yukiName As String
    Dim yukiLatitude As Float
    Dim yukiLongitude As Float
    
    For Each yukiResult
        yukiName = yukiResult[NagatoDBGeo.ColumnVisibleName]
        yukiLatitude = yukiResult[NagatoDBGeo.ColumnLatitude]
        yukiLongitude = yukiResult[NagatoDBGeo.ColumnLongitude]
        $bookmarkGrid.SetData(yukiName, yukiLatitude, yukiLongitude)
    Next
    
End

Public Sub _InitializeWidgets()
    
    Me._$tabStrip.Index = 4
    
    $bookmarkGrid = New NagatoGridViewBookmark(Me._$tabStrip) As "BookmarkGrid"    
    
    If NagatoDBGeo.HasAnyBookmark() Then setBookmarkData()
    
End

Public Sub Refresh()
    
    $bookmarkGrid.Clear()
    setBookmarkData()
    
End
