' Gambas class file

Inherits NagatoMenuPipe

Private $leftPanelContainer As NagatoLeftPanelContainer
Private $weather As NagatoInfoWeather
Private $bookmark As NagatoInfoBookmarks
Private $search As NagatoInfoSearch
Private $candidates As NagatoInfoWikipediacandidates
Private $article As NagatoInfoWikipediaArticle

Public Sub _new(argContainer As Container)
    
    $leftPanelContainer = New NagatoLeftPanelContainer(argContainer)
    $weather = New NagatoInfoWeather($leftPanelContainer.TabStrip)
    $candidates = New NagatoInfoWikipediacandidates($leftPanelContainer.TabStrip) As "Menu"
    $article = New NagatoInfoWikipediaArticle($leftPanelContainer.TabStrip)
    $bookmark = New NagatoInfoBookmarks($leftPanelContainer.TabStrip)
    $search = New NagatoInfoSearch($leftPanelContainer.TabStrip) As "Menu"
    
    $leftPanelContainer.Close(0)
    
End

Public Sub Toggle()
    
    $leftPanelContainer.Show(3)
    $search.SetFocus()
    
End

Public Sub Request(argLatitude As Float, argLongitude As Float)
    
    $candidates.Request(argLatitude, argLongitude)
    $weather.Request(argLatitude, argLongitude)
    
End

Public Sub AddBookmark()
    
    $bookmark.Refresh()
    
End

Public Sub Menu_NewArticle(argUrl As String)
    
    $article.SetUrl(argUrl)
    $leftPanelContainer.Show(2)
    
End
