' Gambas class file

Inherits NagatoMenu

Private $uniqueName As String = "GearMenu"

Private Sub initializeRootMenu(argForm As Form, argButton As MenuButton)
    
    Me._$rootMenu = New Menu(argForm) As "ParentMenu"
    Me._$rootMenu.Name = $uniqueName
    argButton.Menu = $uniqueName
    
End

Private Sub addMenus()
    
    Dim yukiMenu As NagatoSubMenuWikipedia
    
    With NagatoMenuPipe
        Me._AddMenuItem(("Search"), .MenuSearch, MikuruIcon.Get("search"))
        yukiMenu = New NagatoSubMenuWikipedia(Me._$rootMenu) As "Menu"
        Me._AddMenuItem(("Bookmark here"), .MenuBookmark, MikuruIcon.Get("book-bookmark"))
        Me._AddMenuItem(("Show Scale"), .MapShowScale, MikuruIcon.GetCheck(NagatoSettings.ShowScale))
        Me._AddMenuItem(("Export"), .MapExport, MikuruIcon.Get("hard-drive-download"))
            Me._AddMenuItem((""), 0) ' as a separator
        Me._AddMenuItem(("About"), .MenuAbout, MikuruIcon.Get("star"))
        Me._AddMenuItem(("Close"), .MenuQuit, MikuruIcon.Get("button-cross"))
    End With
    
End

Public Sub _new(argForm As Form, argButton As MenuButton)
    
    initializeRootMenu(argForm, argButton)
    Me._AddMenuItem("", 0)
    
End

Public Sub MenuItem_Click()
    
    With NagatoMenuPipe
        Select Case Last.Tag
            Case .MapShowScale
                NagatoSettings.ShowScale = Not NagatoSettings.ShowScale
            Case .MenuAbout
                HaruhiAbout.ShowDialog()
            Case .MenuQuit
                HaruhiMain.Close()
            Case .MenuSearch
                Raise MenuEvent(NagatoMenuPipe.UxToggleLeftPane)
            Default
                Raise MenuEvent(Last.Tag)
        End Select
    End With
    
End

Public Sub ParentMenu_Show()
    
    Me._$rootMenu.Children.Clear()
    
    addMenus()
    
End
