' Gambas class file

Inherits NagatoSettingsCore

Property Radius As Integer
Property Limit As Integer
Property Read Languages As Collection
Property LanguageKey As String

Private $languages As Collection = ["en": ("English"), "ja": ("Japanese")]

Event WikipediaApiChanged

Private Function Radius_Read() As Integer

    Return Me._$settings["wikipedia/radius", 100000]

End

Private Sub Radius_Write(Value As Integer)

    If Me._$settings["wikipedia/radius"] = Value Then Return

    Me._$settings["wikipedia/radius"] = Value
    Me._$settings.Save()

    Raise WikipediaApiChanged

End

Private Function Limit_Read() As Integer

    Return Me._$settings["wikipedia/limit", 100]

End

Private Sub Limit_Write(Value As Integer)

    If Me._$settings["wikipedia/limit"] = Value Then Return

    Me._$settings["wikipedia/limit"] = Value
    Me._$settings.Save()

    Raise WikipediaApiChanged

End

Private Function Languages_Read() As Collection

    Return $languages

End

Private Function LanguageKey_Read() As String

    Return Me._$settings["wikipedia/language_key", "en"]

End

Private Sub LanguageKey_Write(Value As String)

    Me._$settings["wikipedia/language_key"] = Value

    Raise WikipediaApiChanged

End