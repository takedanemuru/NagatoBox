' Gambas class file

Create Static

Property Read IsReady As Boolean

Private $downloader As New NagatoDownloaderWeather As "Downloader"

Event Finished

Public Sub Activate(argLatitude As Float, argLongtude As Float)
    
    $downloader.Ready = False
    $downloader.Get(NagatoWeatherApi.Get(argLatitude, argLongtude, 5))
    
End

Public Function GetWeatherElementMostRecent() As NagatoWeatherElement
    
    Return $downloader.Cache[MikuruTimeStamp.GetRecent()]
    
End

Public Function HasElement(argTime As String) As Boolean
    
    Return $downloader.Cache.Exist(argTime)
    
End

Public Function GetElement(argTime As String) As NagatoWeatherElement
    
    Return $downloader.Cache[argTime]
    
Catch
    Return Null
    
End

Public Sub Downloader_Finished()
    
    $downloader.Ready = True
    
    Raise Finished
    
End

Private Function IsReady_Read() As Boolean

    Return $downloader.Ready

End
