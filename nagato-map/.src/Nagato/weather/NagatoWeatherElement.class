' Gambas class file

Property Read Temperature As Float
Property Read WindDirection As String
Property Read WindSpeed As Float
Property Read Humidity As Float
Property Read Pressure As Float
Property Read Cloudiness As Float
Property Read Fog As Float
Property Read LowCloud As Float
Property Read MediumCloud As Float
Property Read HighCloud As Float
Property Read Precipitation As Float 'mm
Property Read IconId As Integer
Property Read IconName As String
Property Read HasIcon As Boolean

Private $temperature As Float
Private $windDirection As String
Private $windSpeed As Float
Private $humidity As Float
Private $pressure As Float
Private $cloudiness As Float
Private $fog As Float
Private $lowCloud As Float
Private $mediumCloud As Float
Private $highCloud As Float
Private $precipitation As Float 'mm
Private $iconId As Integer = 0
Private $iconName As String

Public Sub SetEssentialData(argXmlElements As XmlElement[])
    
    $temperature = argXmlElements[0].Attributes["value"]
    $windDirection = argXmlElements[1].Attributes["name"]
    $windSpeed = argXmlElements[2].Attributes["mps"]
    $humidity = argXmlElements[3].Attributes["value"]
    $pressure = argXmlElements[4].Attributes["value"]
    $cloudiness = argXmlElements[5].Attributes["percent"]
    $fog = argXmlElements[6].Attributes["percent"]
    $lowCloud = argXmlElements[7].Attributes["percent"]
    $mediumCloud = argXmlElements[8].Attributes["percent"]
    $highCloud = argXmlElements[9].Attributes["percent"]
    
End

Public Sub SetAdditionalData(argXmlElements As XmlElement[])
    
    If $iconId <> 0 Then Return
    
    $precipitation = argXmlElements[0].Attributes["value"]
    $iconId = argXmlElements[1].Attributes["number"]
    $iconName = argXmlElements[1].Attributes["id"]
    
End

Private Function Temperature_Read() As Float

    Return $temperature

End

Private Function WindDirection_Read() As String

    Return $windDirection

End

Private Function WindSpeed_Read() As Float

    Return $windSpeed

End

Private Function Humidity_Read() As Float

    Return $humidity

End

Private Function Pressure_Read() As Float

    Return $pressure

End

Private Function Cloudiness_Read() As Float

    Return $cloudiness

End

Private Function Fog_Read() As Float

    Return $fog

End

Private Function LowCloud_Read() As Float

    Return $lowCloud

End

Private Function MediumCloud_Read() As Float

    Return $mediumCloud

End

Private Function HighCloud_Read() As Float

    Return $highCloud

End

Private Function Precipitation_Read() As Float

    Return $precipitation

End

Private Function IconId_Read() As Integer

    Return $iconId

End

Private Function HasIcon_Read() As Boolean

    If $iconId = 0 Then
        Return False
    Else
        Return True
    Endif

End

Private Function IconName_Read() As String

    Return $iconName

End
