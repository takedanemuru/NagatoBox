' Gambas class file

Inherits NagatoMenuPipe

Private $tabStrip As TabStrip
Private $searchBox As ButtonBox

Event NewData(argData As Collection)

Private Sub initializeSearchBox()
    
    $searchBox = New ButtonBox($tabStrip) As "SearchBox"
    
    With $searchBox
        .Expand = False
        .Height = 32
        .Picture = MikuruIcon.Get("search")
    End With
    
End

Private Sub search()
    
    Dim yukiObserver As Observer
    
    yukiObserver = New Observer(NagatoOpenStreetMapApi) As "Asakura"
    
    NagatoOpenStreetMapApi.Get($searchBox.Text)
    
End

Public Sub SetFocus()
    
    $searchBox.SetFocus()
    
End

Public Sub _new(argTabStrip As TabStrip)
    
    $tabStrip = argTabStrip
    initializeSearchBox()
    
End

Public Sub Asakura_Finished(argXmlDocument As XmlDocument) ' see Private Sub search()
    
    Dim yukiGeoElements As Collection = NagatoOpenStreetMapApi.GetElements(argXmlDocument)
    
    Raise NewData(yukiGeoElements)
    
End

Public Sub SearchBox_Activate()
    
    If $searchBox.Text <> "" Then search()
    
End

Public Sub SearchBox_Click()
    
    If $searchBox.Text <> "" Then search()
    
End
