' Gambas class file

Private $temperature As Float
Private $windDirection As String
Private $windSpeed As Float
Private $humidity As Float
Private $pressure As Float
Private $cloudiness As Float
Private $fog As Float
Private $lowCloud As Float
Private $mediumCloud As Float
Private $highCloud As Float
Private $precipitation As Float 'mm
Private $iconId As Integer = 0
Private $iconName As String

Public Sub SetEssentialData(argXmlElements As XmlElement[])
    
    $temperature = argXmlElements[0].Attributes["value"]
    $windDirection = argXmlElements[1].Attributes["name"]
    $windSpeed = argXmlElements[2].Attributes["mps"]
    $humidity = argXmlElements[3].Attributes["value"]
    $pressure = argXmlElements[4].Attributes["value"]
    $cloudiness = argXmlElements[5].Attributes["percent"]
    $fog = argXmlElements[6].Attributes["percent"]
    $lowCloud = argXmlElements[7].Attributes["percent"]
    $mediumCloud = argXmlElements[8].Attributes["percent"]
    $highCloud = argXmlElements[9].Attributes["percent"]
    
End

Public Sub SetAdditionalData(argXmlElements As XmlElement[])
    
    If $iconId <> 0 Then Return
    
    $precipitation = argXmlElements[0].Attributes["value"]
    $iconId = argXmlElements[argXmlElements.Max].Attributes["number"]
    $iconName = argXmlElements[argXmlElements.Max].Attributes["id"]
    
End

Public Sub _get(argKey As Integer) As Variant
    
    With MikuruWeatherKey
        Select Case argKey
            Case .Cloudiness
                Return $cloudiness
            Case .Fog
                Return $fog
            Case .HasIcon
                Return IIf($iconId = 0, False, True)
            Case .IconName
                Return $iconName
            Case .HighCloud
                Return $highCloud
            Case .Humidity
                Return $humidity
            Case .IconId
                Return $iconId
            Case .LowCloud
                Return $lowCloud
            Case .MediumCloud
                Return $mediumCloud
            Case .Precipitation
                Return $precipitation
            Case .Pressure
                Return $pressure
            Case .Temperature
                Return $temperature
            Case .WindDirection
                Return $windDirection
            Case .WindSpeed
                Return $windSpeed
        End Select
    End With
    
End
