' Gambas class file

Inherits NagatoMenuPipe

Private $mapView As MapView

Private Sub setMapTile()
    
    With MikuruOpenStreetMap
        $mapView.Map.AddTile(.Name, .Pattern, Null).Copyright = .Copyright
    End With 
    
    MikuruGoogleMap.AddTile($mapView)
    
End

Public Sub SetVisibleLayer(argMapType As Integer)
    
    With $mapView
        If argMapType = HaruhiMain.OpenStreetMap Then
            .Map[MikuruOpenStreetMap.Name].Visible = True
            .Map[MikuruGoogleMap.Name].Visible = False
            .Map[MikuruGoogleMap.NameRoad].Visible = False
        Else If argMapType = HaruhiMain.GoogleMapWithRoad Then
            .Map[MikuruOpenStreetMap.Name].Visible = False
            .Map[MikuruGoogleMap.Name].Visible = True
            .Map[MikuruGoogleMap.NameRoad].Visible = True
        Else If argMapType = HaruhiMain.GoogleMap Then
            .Map[MikuruOpenStreetMap.Name].Visible = False
            .Map[MikuruGoogleMap.Name].Visible = True
            .Map[MikuruGoogleMap.NameRoad].Visible = False
        End If
    End With
    
End

Public Sub _new(argMapView As MapView)
    
    $mapView = argMapView
    
    setMapTile()
    setVisibleLayer(HaruhiMain.OpenStreetMap)
    
End

