' Gambas class file

Private $tabstrip As TabStrip
Private $weatherDrawingArea As NagatoWeatherDrawingArea

Private Sub initializeWeatherDrawingArea()
    
    Dim yukiDrawingArea As DrawingArea
    
    $tabStrip.Index = 0
    
    yukiDrawingArea = New DrawingArea($tabStrip) As "DrawingArea"
    
    With yukiDrawingArea
        .Expand = True
        .Background = Color.Blue
    End With
    
    $weatherDrawingArea = New NagatoWeatherDrawingArea(yukiDrawingArea)
    
End

Public Sub Request(argLatitude As Float, argLongitude As Float)
    
    Dim yukiObserver As Observer
    
    Debug "requested"
    
    yukiObserver = New Observer(NagatoWeatherCache) As "Asakura"
    
    NagatoWeatherCache.Activate(argLatitude, argLongitude)
    $weatherDrawingArea.Longitude = argLongitude
    
End

Public Sub _new(argTabStrip As TabStrip)
    
    $tabstrip = argTabStrip
    initializeWeatherDrawingArea()
    
End

Public Sub Asakura_Finished()
    
    $weatherDrawingArea.Refresh()
    
End
