' Gambas class file

Public Enum OpenStreetMap, GoogleMap

Private Sub setMapTile()
    
    With MikuruOpenStreetMap
        MapView.Map.AddTile(.Name, .Pattern, Null).Copyright = .Copyright
    End With 
    
    MikuruGoogleMap.AddTile(MapView)
    
End

Private Sub setVisibleLayer(argLayer As Integer)
    
    With MapView
        If argLayer = Me.OpenStreetMap Then
            .Map[MikuruOpenStreetMap.Name].Visible = True
            .Map[MikuruGoogleMap.Name].Visible = False
        Else
            .Map[MikuruOpenStreetMap.Name].Visible = False
            .Map[MikuruGoogleMap.Name].Visible = True
        End If
    End With
    
End

Public Sub Form_Open()

    Application.MainWindow = Me
    NagatoSettings.LoadFormSettings(Me)

    setMapTile()
    setVisibleLayer(Me.OpenStreetMap)

End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End