' Gambas class file

Private $menuBar As NagatoMenuBar
Private $player As NagatoPlayer
Private $drawingArea As NagatoDrawingArea

' Private Sub openFile()
'     
'     Dialog.Title = ("Open file")
'     Dialog.Path = NagatoSettings.LastDirectory &/ ""
'     
'     If Dialog.OpenFile(False) Then Return
'     $player.SetPathAndPlay(Dialog.Path)
'     NagatoSettings.LastDirectory = File.Dir(Dialog.Path)
'     Me.Title = File.BaseName(Dialog.Path)
'     
' End

Public Sub SetPathAndPlay(argPath As String)
    
    $player.SetPathAndPlay(argPath)
    
End

Public Sub _new()

    $menuBar = New NagatoMenuBar(MenuHBox) As "MenuBar"
    $drawingArea = New NagatoDrawingArea(Me)
    $player = New NagatoPlayer($drawingArea.DrawingArea) As "Player"

End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub Form_Resize()
    
    $drawingArea.SetBackground()
    
End

Public Sub MenuBar_Signal(argEvent As Integer, argValues As Variant[])
    
    ' With MikuruMenuEvent
    '     Select Case argEvent
    '        Case .MediaPlay, .MediaPause, .MediaProgress
               $player.SignalReceiver(argEvent, argValues)
    '         Case .FileOpen
    '             openFile()
    '     End Select
    ' End With
    
End

Public Sub MediaTimer_Timer()

    $menuBar.SetWidgetProperty($player.Position, $player.Duration)

End

Public Sub Form_Enter()
    
    MenuHBox.Visible = True
    
End

Public Sub Form_Leave()
    
    MenuHBox.Visible = False
    
End
