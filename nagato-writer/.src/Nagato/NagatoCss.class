' Gambas class file

Create Static

Public Enum StyleGitHub, StyleLight, StyleDark

Public Sub EnsureCssData()
    
    Dim yukiDirectory As String = User.Home &/ ".nagato-writer"
    Dim yukiImagesDirectory As String = yukiDirectory &/ "images"
    
    If Not Exist(yukiDirectory) Then Mkdir yukiDirectory
    
    Try Mkdir yukiImagesDirectory
    Try Copy "Css/github.css" To yukiDirectory &/ "github.css"
    Try Copy "Css/dark_theme.css" To yukiDirectory &/ "dark_theme.css"
    Try Copy "Css/light_theme.css" To yukiDirectory &/ "light_theme.css"
    Try Copy "Css/nagato_slide.css" To yukiDirectory &/ "nagato_slide.css"
    Try Copy "Css/light_slide.css" To yukiDirectory &/ "light_slide.css"
    Try Copy "Css/dirty-shade.png" To yukiImagesDirectory &/ "dirty-shade.png" 
    Try Copy "Css/para.png" To yukiImagesDirectory &/ "para.png"
    
End

Public Function Get() As String
    
    Select Case NagatoSettings.PreviewCss
        Case Me.StyleGitHub
            Return User.Home &/ ".nagato-writer/github.css"
        Case Me.StyleLight
            Return User.Home &/ ".nagato-writer/light_theme.css"
        Case Me.StyleDark
            Return User.Home &/ ".nagato-writer/dark_theme.css"
    End Select
    
End

Public Function GetSlideCss() As String
    
    Select Case NagatoSettingsSlide.Theme
        Case NagatoSettingsSlide.ThemeDark
            Return User.Home &/ ".nagato-writer/nagato_slide.css"
        Case NagatoSettingsSlide.ThemeLight
            Return User.Home &/ ".nagato-writer/light_slide.css"
    End Select
    
End
