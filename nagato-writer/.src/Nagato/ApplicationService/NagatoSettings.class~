' Gambas class file

Create Static

Property TabSize As Integer

Private Const DefaultTabSize As Integer = 4

Private $settings As New Settings

Public Sub LoadFormSettings(argForm As Form)
    
    With argForm
        .X = $settings[Subst$("&1/x", argForm.Name), Screen.H * 0.25]
        .Y = $settings[Subst$("&1/y", argForm.Name), Screen.W * 0.25]
        .H = $settings[Subst$("&1/h", argForm.Name), Screen.H * 0.75]
        .W = $settings[Subst$("&1/w", argForm.Name), Screen.W * 0.75]
    End With
    
End

Public Sub SaveFormSettings(argForm As Form)
    
    With argForm
        $settings[Subst$("&1/x", argForm.Name)] = .X
        $settings[Subst$("&1/y", argForm.Name)] = .Y
        $settings[Subst$("&1/h", argForm.Name)] = .H
        $settings[Subst$("&1/w", argForm.Name)] = .W
    End With
    
    $settings.Save()
    
End

Private Function TabSize_Read() As Integer

    Return $settings["editor/tab_size", DefaultTabSize]

End

Private Sub TabSize_Write(Value As Integer)

    $settings["editor/tab_size"] = Value
    $settings.Save()

End
