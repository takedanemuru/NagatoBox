' Gambas class file

Inherits NagatoSettingsCore

Property SyntaxIndex As Integer
Property Read Syntax As String
Property CssIndex As Integer
Property Read TabSize As Integer
Property TabSizeIndex As Integer
Property ShowStatusPanel As Boolean

Event RequestReload
Event ToggleStatusPanel

Private Sub resetProperty(argProperty As String, Value As Variant)
    
    If Me._$settings[argProperty] = Value Then Return

    Me._$settings[argProperty] = Value
    Me._$settings.Save()
    Raise RequestReload
    
End

Private Function Syntax_Read() As String

    Return NagatoValueListSyntax.Values[Me.SyntaxIndex]

End

Private Function SyntaxIndex_Read() As Integer

    Return Me._$settings["markdown/syntax_index", NagatoValueListSyntax.GitHub]

End

Private Sub SyntaxIndex_Write(Value As Integer)

    resetProperty("markdown/syntax_index", Value)

End

Private Function CssIndex_Read() As Integer

    Return Me._$settings["preview/css", 1] ' 1 means LightTheme.Css

End

Private Sub CssIndex_Write(Value As Integer)

    resetProperty("preview/css", Value)

End

Private Function TabSizeIndex_Read() As Integer

    Return Me._$settings["editor/tab_size_index", NagatoValueListTabSize.Size4]

End

Private Sub TabSizeIndex_Write(Value As Integer)

    resetProperty("editor/tab_size_index", Value)

End

Private Function TabSize_Read() As Integer

    Return NagatoValueListTabSize.Values[Me.TabSizeIndex]

End

Private Function ShowStatusPanel_Read() As Boolean

    Return Me._$settings["editor/show_statuspanel", False]

End

Private Sub ShowStatusPanel_Write(Value As Boolean)

    If Me._$settings["editor/show_statuspanel"] = Value Then Return

    Me._$settings["editor/show_statuspanel"] = Value
    Me._$settings.Save()
    Raise ToggleStatusPanel

End
