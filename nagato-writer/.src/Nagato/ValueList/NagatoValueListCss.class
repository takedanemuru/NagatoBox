' Gambas class file

Inherits NagatoValueList

Property Read Directory As String
Property Read ImageDirectory As String
Property Read Current As String

Public Enum StyleGitHub, StyleLight, StyleDark

Public _$themes As String[]

Private Sub ensureFile(argDirectory As String, argFile As String)
    
    Dim yukiSourcePath As String = Subst$("Css/&1", argFile)
    Dim yukiTargetPath As String = argDirectory &/ argFile
    
    If Not Exist(yukiTargetPath) Then 
        Copy yukiSourcePath To yukiTargetPath
    Endif
    
    Me._$values.Add(yukiTargetPath)
    
End

Public Sub _EnsureThemes(argMax As Integer)
    
    Dim yukiIndex As Integer
    
    For yukiIndex = 0 To argMax
        ensureFile(Me.Directory, Me._$themes[yukiIndex])
    Next
    
End

Public Function _GetCurrent() As String ' virtual.
    
    Return ""
    
End

Private Sub ensureDirectory(argDirectory As String)
    
    If Not Exist(argDirectory) Then Mkdir argDirectory
    
End

Public Sub EnsureCssData()
    
    ensureDirectory(Me.Directory)
    ensureDirectory(Me.ImageDirectory)
    
    Try Copy "Css/dirty-shade.png" To Me.ImageDirectory &/ "dirty-shade.png" 
    Try Copy "Css/para.png" To Me.ImageDirectory &/ "para.png"
    
    NagatoValueListCssPreview.EnsureCssData()
    NagatoValueListCssSlide.EnsureCssData()
    NagatoValueListCssWeb.EnsureCssData()
    
End

Private Function Directory_Read() As String

    Return User.Home &/ ".nagato-writer"

End

Private Function ImageDirectory_Read() As String

    Return Me.Directory &/ "images"

End

Private Function Current_Read() As String

    Return Me._GetCurrent()

End
