' Gambas class file

Inherits NagatoUxContainer

Property Text As String
Property Read Line As Integer

Private $ux As NagatoTextAreaUx
Private $source As NagatoTextAreaSource
Private $keyboardHandler As NagatoTextAreaKeyboard
Private $searchAndReplace As NagatoTextAreaSearchAndReplace
Private $statusPanel As NagatoStatusPanel

Public Sub _initialize() ' override
    
    $ux = New NagatoTextAreaUx(Me._$parentContainer) As "TFEI"
    $source = New NagatoTextAreaSource($ux.TextArea) As "TFEI"
    $statusPanel = New NagatoStatusPanel($ux.Container, [$ux.TextArea])
    $keyboardHandler = New NagatoTextAreaKeyboard($ux.TextArea) As "TFEI"
    $searchAndReplace = New NagatoTextAreaSearchAndReplace($ux.TextArea) As "TFEI"
    
End

Public Sub _call(argSignal As Integer, argValues As Variant[])
    
    $source(argSignal, argValues)
    
End

Public Sub CheckCursorPosition()
    
    $keyboardHandler.CheckCursorPosition()
    
End

Private Function Text_Read() As String

    Return $source.Text

End

Private Sub Text_Write(Value As String)

    $source.SetTextWithNoSignal(Value)

End

Private Function Line_Read() As Integer

    Return $source.Line

End
