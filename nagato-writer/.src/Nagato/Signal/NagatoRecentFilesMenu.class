' Gambas class file

Inherits NagatoButtonMenu

Private Sub addRecentFileMenus()
    
    Dim yukiPath As String
    Dim yukiMenu As Menu
    Dim yukiRecentFiles As String[] = NagatoSettings.RecentFiles.Copy()
    
    For Each yukiPath In yukiRecentFiles
        yukiMenu = New Menu(Me._$parentMenu) As "RecentFileMenu"
        'yukiMenu.Text = File.Name(yukiPath)
        yukiMenu.Text = MikuruPaths.GetDistinguishableFileName(yukiPath, yukiRecentFiles)
        yukiMenu.Tag = yukiPath
    Next
    
End

Public Sub _RefreshChildMenus()
    
    If Not NagatoSettings.RecentFiles Then
        Me._AddMenu("Not Found", MikuruSignal.None, "exclamation")
    Else
        addRecentFileMenus()
    End If
    
End

Public Sub RecentFileMenu_Click()
    
    Raise Signal(MikuruSignal.FileOpenPath, [Last.Tag])
    
End
