' Gambas class file

Inherits NagatoWorkingFile

Private Sub convert(argSourcePath As String, argTargetPath As String)
    
    Dim yukiCss As String = Subst$("--css=&1", NagatoValueListCssPreview.Current)
    
    Exec ["pandoc", "-f", NagatoSettingsView.Syntax, "-t", "html5", yukiCss, argSourcePath, "-o", argTargetPath] Wait
    
End

Public Sub Set(argSourceText As String)
    
    Dim yukiSourcePath As String = Temp$()
    
    Me._ResetWorkingPath()
    File.Save(yukiSourcePath, MikuruMacro.ConvertToRelative(argSourceText))
    convert(yukiSourcePath, Me._$workingPath)
    
End
