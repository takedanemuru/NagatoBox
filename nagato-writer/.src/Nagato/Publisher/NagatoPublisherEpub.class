' Gambas class file

Inherits NagatoPublisher

Public Sub Publish(argPath As String)
    
    Dim yukiTarget As String = Me._GetPathToSave2("epub", argPath)
    Dim yukiSource As String = MikuruHtmlConverter.WorkingFileEpub
    Dim yukiCover As String = "--epub-cover-image=" & User.Home &/ "headphones_x.png"
    Dim yukiCss As String = NagatoValueListCssPreview.Current
    
    If Not yukiTarget Then Return
    If HaruhiEpubMetadata.ShowDialog() <> MikuruDialog.ResponseApply Then Return

    Exec ["pandoc", "-t", "epub3", yukiCover, "-c", yukiCss, "-S", yukiSource, "-o", yukiTarget] 
    
    Me._ShowMessage(yukiTarget)
    
End
