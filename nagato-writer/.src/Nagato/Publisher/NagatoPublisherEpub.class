' Gambas class file

Inherits NagatoPublisher

Public Sub Publish()
    
    Dim yukiTarget As String = Me._GetPathToSave("epub")
    Dim yukiSource As String = MikuruHtmlConverter.WorkingFileRelative
    Dim yukiCover As String = "--epub-cover-image=" & User.Home &/ "headphones_x.png"
    
    If Not yukiTarget Then Return

    HaruhiEpubMetadata.ShowDialog()

    Exec ["pandoc", "-t", "epub3", yukiCover, "-c", NagatoValueListCssPreview.Current, "-S", yukiSource, "-o", yukiTarget] 
    
    Me._ShowMessage(yukiTarget)
    
End