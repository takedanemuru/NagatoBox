' Gambas class file

Private $previewer As NagatoPreviewer

Private Sub refreshView(argSource As String)
    
    Me.Show()
    $previewer.Refresh(argSource)
    
End

Private Sub moveToTag(argID As String)
    
    $previewer.MoveToTag(argID)
    
End

Public Sub _call(argSignal As Integer, argValues As Variant[], argBufferText As String)
    
    Select Case argSignal
        Case MikuruSignal.ViewPreview
            refreshView(argBufferText)
        Case MikuruSignal.ViewMoveToBottom
            moveToTag(MikuruHtmlConverter.BottomId)
        Case MikuruSignal.ViewMoveTag
            If argValues[0] = -1 Then moveToTag("<body>") ' move to top of page.
            If argValues[0] >= 0 Then Try moveToTag(MikuruHtmlConverter.IDs[argValues[0]])
    End Select
    
End

Public Sub _new()
    
    $previewer = New NagatoPreviewer(VBox1)
    
End

Public Sub Form_Open()

    NagatoSettingsForm.Load(Me)

End

Public Sub Form_Close()
    
    NagatoSettingsForm.Save(Me)
    
End
