' Gambas class file

Private $htmlPath As String

Private Sub convert()
    
    Dim yukiCss As String = User.Home &/ "/.nagato-writer/nagato_slide.css"
    Dim yukiIncludeCss As String = Subst$("--include-after-body=&1", yukiCss)
    
    If Exist($htmlPath) Then Kill $htmlPath
    $htmlPath = Temp$() & ".html" 
    Exec ["pandoc", "-t", "dzslides", yukiIncludeCss, "-s", MikuruHtmlConverter.TempFile, "-o", $htmlPath] Wait
    
End

Public Sub Set(argText As String)
    
    If argText = "" Then Return
    
    convert()
    
    WebSettings[WebSettings.JavascriptEnabled] = True
    
    SlideWebView.Url = Media.URL($htmlPath)
    
End

Public Sub SlideWebView_KeyPress()

    If Key.Code = Key.Esc Then Me.Close()

End
