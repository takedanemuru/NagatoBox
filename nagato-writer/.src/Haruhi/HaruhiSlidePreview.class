' Gambas class file

Private $htmlPath As String

Private Sub convert()
    
    Dim yukiCss As String = Subst$("--include-after-body=&1", NagatoCss.GetSlideCss())
    Dim yukiLevel As Integer = NagatoSettingsSlide.SectionLevel
    Dim yukiSourcePath As String = MikuruHtmlConverter.TempFile
    
    If Exist($htmlPath) Then Kill $htmlPath
    $htmlPath = Temp$() & ".html" 
    Exec ["pandoc", "-t", "dzslides", yukiCss, "--slide-level", yukiLevel, "-s", yukiSourcePath, "-o", $htmlPath] Wait
    
End

Public Sub Set(argText As String)
    
    If argText = "" Then Return
    
    convert()
    
    WebSettings[WebSettings.JavascriptEnabled] = True
    
    SlideWebView.Url = Media.URL($htmlPath)
    
End

Public Sub SlideWebView_KeyPress()

    If Key.Code = Key.Esc Then Me.Close()

End
