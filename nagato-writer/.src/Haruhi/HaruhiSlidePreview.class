' Gambas class file

Private $htmlPath As String

Private Sub resetHtmlPath()
    
    If Exist($htmlPath) Then Kill $htmlPath
    $htmlPath = Temp$() & ".html" 
    
End

Private Function getCommand() As String[]
    
    Dim yukiCommand As String[] = ["pandoc", "-t"]
    
    With yukiCommand
        .Insert(["dzslides", Subst$("--include-after-body=&1", NagatoValueListCssSlide.Current)])
        .Insert(["--slide-level", NagatoSettingsSlide.SectionLevel])
        .Insert(["-s", MikuruHtmlConverter.WorkingFileAbsolute])
        .Insert(["-o", $htmlPath])
    End With

    Return yukiCommand    
    
End

Public Sub Set(argText As String)
    
    If argText = "" Then Return
    
    resetHtmlPath()
    Exec getCommand() Wait
    
    WebSettings[WebSettings.JavascriptEnabled] = True
    SlideWebView.Url = "file://" & Url$($htmlPath)
    
End

Public Sub SlideWebView_KeyPress()

    If Key.Code = Key.Esc Then Me.Close()

End
