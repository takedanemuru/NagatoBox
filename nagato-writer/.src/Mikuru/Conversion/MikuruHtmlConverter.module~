' Gambas module file

Property Read Source As String
Property Read WorkingFileRelative As String
Property Read WorkingFileAbsolute As String

Private $sourceText As String
Private $workinPathAbsolute As New NagatoWorkingFileAbsolute
Private $workinPathRelative As New NagatoWorkingFileRelative

Public Sub ToHtmlDirect(argSourceText As String)

    $sourceText = argSourceText
    $workinPathAbsolute.Set(argSourceText)

End

Public Sub Export(argTargetPath As String)
    
    Dim yukiTempPath As String = Temp$() & ".md"
    
    File.Save(yukiTempPath, $sourceText)
    
    Exec ["pandoc", "-f", "html", "--self-contained", "-o", argTargetPath, yukiTempPath]
    
End

Private Function Source_Read() As String

    Return $sourceText

End

Private Function WorkingFileRelative_Read() As String

    $workinPathRelative.Set($sourceText)

    Return $workinPathRelative.WorkingPath

End

Private Function WorkingFileAbsolute_Read() As String

    Return $workinPathAbsolute.WorkingPath

End
