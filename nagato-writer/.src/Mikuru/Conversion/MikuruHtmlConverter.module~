' Gambas module file

Property Read TempFile As String

Private $tempPath As String
Private $workingPath As String

Public Sub ToHtmlDirect(argSourceText As String, argFormat As String)

    Dim yukiTempPath As String = IIf($tempPath, $tempPath, Temp$())
    Dim yukiOutput As String
    
    If Exist($workingPath) Then Kill $workingPath
    $workingPath = Temp$() & ".html"
    
    If Exist(Me.TempFile) Then Kill Me.TempFile
    
    File.Save(yukiTempPath, MikuruMacro.Set(argSourceText))
    
    'Exec ["pandoc", "-f", argFormat, "-t", "html5", "-c", NagatoCss.Get(), yukiTempPath, "-o", Me.TempFile] Wait
    Exec ["pandoc", "-f", argFormat, "-t", "html5", "-c", NagatoCss.Get(), yukiTempPath, "-o", $workingPath] Wait
    
End

Private Function TempFile_Read() As String

    'Return User.Home &/ ".nagato-writer/temp.html"
    Return $workingPath

End
