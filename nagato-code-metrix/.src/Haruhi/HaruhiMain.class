' Gambas class file

Private $label As NagatoLabel
Private $tabStrip As TabStrip
Private $menuPanel As NagatoMenuPanel
Private $grids As NagatoSourcesView
Private $treeView As NagatoTreeViewObjectInheritance

Public Sub Form_Open()

    NagatoSettings.LoadFormSettings(Me)

    $label = New NagatoLabel(MainVBox)
    $tabStrip = New TabStrip(MainVBox)
    $tabStrip.Count = 2
    $tabStrip.Arrangement = Arrange.Vertical
    $tabStrip.Expand = True
    $tabStrip.Orientation = Align.Left
    $tabStrip.Index = 0
    $tabStrip.Text = "Codes"
    $menuPanel = New NagatoMenuPanel($tabStrip) As "TFEI"
    $grids = New NagatoSourcesView($tabStrip) As "TFEI"
    $tabStrip.Index = 1
    $tabStrip.Text = "Inheritance"
    $treeView = New NagatoTreeViewObjectInheritance($tabStrip) As "TFEI"
    $tabStrip.Index = 0
    
End

Public Sub Form_Close()
    
    NagatoSettings.SaveFormSettings(Me)
    
End

Public Sub TFEI_Signal(argEvent As Integer, argValues As Variant[])
    
    Select Case argEvent
        Case MikuruSignal.FileOpen
            $grids.Open()
        Case MikuruSignal.FileOpenRecent
            $grids.Open(argValues[0])
            $treeView.Refresh(argValues[0])
        Case MikuruSignal.ViewRefresh
            $label.SetText(argValues[0])
        Case MikuruSignal.ViewReload
            $grids.Reload()
        Case MikuruSignal.ViewFilter
            $grids.Filter(argValues[0])
        Case MikuruSignal.ViewShowCodeView
            HaruhiCodeViewer.SetCode(argValues[0])
        Case MikuruSignal.ApplicationAbout
            HaruhiAbout.ShowDialog()
        Case MikuruSignal.ApplicationClose
            Me.Close()
    End Select
    
End
