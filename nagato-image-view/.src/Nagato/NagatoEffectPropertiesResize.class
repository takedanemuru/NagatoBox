' Gambas class file

Inherits NagatoEffectProperties

Property Read Values As Variant[]

Private $container As Container
Private $heightSlider As NagatoImageEffectSpinBox
Private $widthSlider As NagatoImageEffectSpinBox
Private $linkCheckbox As CheckBox

Private Sub addHeightSliderBox()
    
    Dim yukiDefaultValue As Integer = HaruhiImageView.BeforeImage.H
    
    $heightSlider = New NagatoImageEffectSpinBox($container, yukiDefaultValue) As "HeightSpinBox"
    
End

Private Sub addWidthSliderBox()
    
    Dim yukiDefaultValue As Integer = HaruhiImageView.BeforeImage.W
    
    $widthSlider = New NagatoImageEffectSpinBox($container, yukiDefaultValue) As "WidthSpinBox"
    
    
End

Private Sub addLinkCheckbox()
    
    $linkCheckbox = New CheckBox($container) As "LinkCheckbox"
    
    With $linkCheckbox
        .Text = ("Link")
        .Value = True
        .H = 48
    End With
    
End

Public Sub _new(argContainer As Container)
    
    $container = argContainer
    Try $container.Children.Clear()
    
    Object.New("NagatoImageEffectLabel", [argContainer, ("Height")])
    addHeightSliderBox()
    Object.New("NagatoImageEffectLabel", [argContainer, ("Width")])
    addWidthSliderBox()
    addLinkCheckbox()
    
End

Public Sub HeightSpinbox_ChangeValue(argNewValue As Integer)
    
    If Not $linkCheckbox.Value Then Return

    With HaruhiImageView
        $widthSlider.SetValueWithoutEvent(CInt(.BeforeImage.W * (argNewValue / .BeforeImage.H)))
    End With
    
End

Public Sub WidthSlider_ChangeValue(argNewValue As Integer)
    
    If Not $linkCheckbox.Value Then Return

    With HaruhiImageView
        $heightSlider.SetValueWithoutEvent(CInt(.BeforeImage.H * (argNewValue / .BeforeImage.W)))
    End With
    
End

Private Function Values_Read() As Variant[]

    Return [$heightSlider.Value, $widthSlider.Value]

End
