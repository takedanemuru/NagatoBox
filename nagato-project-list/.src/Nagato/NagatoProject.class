' Gambas class file

Property Read Title As String
Property Read TitleHeader As String
Property Read IconPath As String
Property Read Version As String
Property Read Description As String
Property Read LastModified As Date
Property Read Icon As Picture
Property Read ScreenshotsCount As Integer
Property Read Document As String
Property Read Status As Integer

Private $lastModefied As Date
Private $data As NagatoProjectData
Private $screenshot As NagatoProjectScreenshot
Private $document As NagatoProjectDocument

Public Function GetScreenShot(argIndex As Integer) As String
    
    Return $screenshot[argIndex]
    
End

Public Sub _new(argProjectFilePath As String)
    
    $data = New NagatoProjectData(argProjectFilePath)
    $document = New NagatoProjectDocument(File.Dir(argProjectFilePath))
    $screenshot = New NagatoProjectScreenshot(File.Dir(argProjectFilePath))
    $lastModefied = Stat(argProjectFilePath).LastModified
    
End

Private Function Title_Read() As String

    Return $data.Title

End

Private Function Version_Read() As String

    Return $data.Version

End

Private Function Description_Read() As String

    Return $data.Description

End

Private Function LastModified_Read() As Date

    Return $lastModefied

End

Private Function IconPath_Read() As String

    Return $data.IconPath
    
End

Private Function Icon_Read() As Picture

    Return $data.Icon

End

Private Function ScreenshotsCount_Read() As Integer

    Return $screenshot.Count

End

Private Function TitleHeader_Read() As String

    Return $data.TitleHeader

End

Private Function Document_Read() As String

    Return $document.Text

End

Private Function Status_Read() As Integer

    Return MikuruDate.GetMaintainStatus($lastModefied)

End
