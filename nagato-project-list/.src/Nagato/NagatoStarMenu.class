' Gambas class file

Private $rootMenu As Menu

Private Enum MenuMarkdownTable, MenuMarkdownList, MenuNone, MenuQuit

Private Sub initializeRootMenu(argMenuName As String)
    
    $rootMenu = New Menu(HaruhiMain)
    
    With $rootMenu
        .Name = argMenuName
    End With
    
End

Private Sub addChildMenu(argText As String, argTag As Integer, Optional argIconName As String)
    
    Dim yukiMenu As New Menu($rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIconName Then .Picture = MikuruIcon[argIconName]
    End With
    
End

Public Sub _new(argMenuName As String)
    
    initializeRootMenu(argMenuName)
    Object.New("NagatoMenuItemAdd", [$rootMenu])
    Object.New("NagatoMenuItemReload", [$rootMenu])
        Object.New("NagatoMenuItemVoid", [$rootMenu])
    Object.New("NagatoSubMenuExportGithubDoc", [$rootMenu])
    addChildMenu("Export markdown (Table)", MenuMarkdownTable)
    addChildMenu("Export markdown (List)", MenuMarkdownList)
        Object.New("NagatoMenuItemVoid", [$rootMenu])
    Object.New("NagatoMenuItemAbout", [$rootMenu])
    Object.New("NagatoMenuItemQuit", [$rootMenu])
    
End

Public Sub MenuItem_Click()
    
    Select Case Last.Tag
        Case MenuMarkdownTable
            MikuruMarkdownTable()
        Case MenuMarkdownList
            MikuruMarkdownList()
    End Select
    
End
