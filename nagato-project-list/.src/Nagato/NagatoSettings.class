' Gambas class file

Create Static

Property Read ProjectPaths As String[]
Property Read Ready As Boolean

Private $settings As New Settings

Private Function isAddible(argPath As String) As Boolean
    
    If Not Exist(argPath) Then Return False
    If Not Dir(argPath, ".*", gb.Directory).Exist(".git") Then Return False
    
    Return True
    
End

Public Sub SaveForm(argForm As Form)
    
    $settings["form/x"] = argForm.X
    $settings.Save()
    
End

Public Sub LoadForm(argForm As Form)
    
    argForm.X = $settings["form/x", argForm.X]
    
End

Public Function AddProject(argDirectory As String) As Boolean
    
    Dim yukiPaths As String[] = Me.ProjectPaths.Copy()
    
    If Not isAddible(argDirectory) Then Return False
    
    If yukiPaths.Count = 0 Then 
        $settings["projects/directory"] = [argDirectory]
    Else
        yukiPaths.Add(argDirectory)
        $settings["projects/directory"] = yukiPaths
    End If
    
    $settings.Save()

    Return True
    
End

Private Function ProjectPaths_Read() As String[]
    
    Dim yukiPaths As New String[]
    Dim yukiPath As String
    
    For Each yukiPath In $settings["projects/directory", [""]]
        If yukiPaths.Exist(yukiPath) Then Continue
        If isAddible(yukiPath) Then yukiPaths.Add(yukiPath)
    Next
    
    Return yukiPaths
    
End

Private Function Ready_Read() As Boolean

    Return $settings["app/ready", True]

End
