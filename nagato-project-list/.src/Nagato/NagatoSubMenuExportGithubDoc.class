' Gambas class file

Private $rootMenu As Menu

Private Sub refreshChildMenus()
    
    Dim yukiMenu As Menu
    Dim yukiPath As String
    
    For Each yukiPath In NagatoSettings.ProjectPaths
        yukiMenu = New Menu($rootMenu) As "ExportMenu"
        yukiMenu.Text = File.BaseName(yukiPath)
        yukiMenu.Tag = yukiPath
    Next
    
End

Public Sub _new(argRootMenu As Menu)
    
    $rootMenu = New Menu(argRootMenu) As "RootMenu"
    
    With $rootMenu
        .Text = ("Export (GitHub)")
    End With
    
    Object.New("NagatoMenuItemVoid", [$rootMenu])
    
End

Public Sub RootMenu_Show()
    
    $rootMenu.Children.Clear()
    
    If NagatoProjectList.All.Count > 0 Then
        refreshChildMenus()
    Else
        Object.New("NagatoMenuItemNotFound", [$rootMenu])
    End If
    
End

Public Sub ExportMenu_Click()
    
    MikuruMarkdownListForGithub.Export(Last.Tag)
    
End
