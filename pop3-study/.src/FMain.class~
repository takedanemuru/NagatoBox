' Gambas class file

Private $htmlMessage As String = ""

Private Sub decodeDataMultipartAlternative(argMimePart As MimePart)
    
    Dim yukiCount As Integer
    
    For yukiCount = 0 To argMimePart.Count - 1
        Debug argMimePart[yukiCount].Data
        $htmlMessage &= argMimePart[yukiCount].Data
    Next
    
End

Private Sub downloadMessage()
    
    Dim yukiMessage As _Pop3Client_Message

    For Each yukiMessage In NagatoPop3Client

        Select Case yukiMessage.Message.Body.ContentType
            Case "text/plain"
                $htmlMessage = Html$(yukiMessage.Message.Body.Data)
            Case "multipart/alternative"
                decodeDataMultipartAlternative(yukiMessage.Message.Body)
        End Select
        
        Break

    Next
    
End

Private Sub initializePop3Client()
    
    With NagatoPop3Client
        .Host = "pop.gmail.com"
        .Port = 995
        .User = "takeda.nemuru@gmail.com"
        .Password = "sleeping"
        .Encrypt = Net.SSL
    End With
    
End

Public Sub _new()

End

Public Sub Form_Open()

    initializePop3Client()

    NagatoPop3Client.Open()
        downloadMessage()
        WebView1.HTML = $htmlMessage
    NagatoPop3Client.Close()

End
