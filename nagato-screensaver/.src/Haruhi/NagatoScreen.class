' Gambas class file

Private $count As Integer
Private $color As Integer
Private $x As Integer
Private $fontSize As Integer

Private $stars1 As New NagatoScreenSaverStars
Private $stars2 As New NagatoScreenSaverStars
Private $stars3 As New NagatoScreenSaverStars

Public Sub Form_Open()
    
    Timer1.Start()
    
End

Public Sub Form_Close()
    
    Application.MainWindow = Me
    Timer1.Stop()
    
End

Public Sub Form_MouseDown()

    Me.Close()

End

Public Sub ScreenArea_MouseDown()

    Me.Close()

End

Public Sub Timer1_Timer()
    
    Inc $count
    ScreenArea.Refresh()
    
End

Public Sub ScreenArea_Draw()

    If ($count * 8) Mod Screen.W = 0 Then
        $color = MikuruRandomColor.Get()
        $x = Int(Rnd(0, Screen.H))
        $fontSize = Int(Rnd(10, 30))
    End If

    With Paint
        .Begin(ScreenArea)
        .Brush = .Color($color)
        '.Font.Size = $fontSize
        .DrawText("NagatoBox", Screen.Width - ($count * 8) Mod Screen.w, $x)
        $stars1.DrawScreenSaver($count)
        $stars2.DrawScreenSaver($count)
        $stars3.DrawScreenSaver($count)
        .End()
    End With

End
