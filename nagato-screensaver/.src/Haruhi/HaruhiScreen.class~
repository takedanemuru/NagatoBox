' Gambas class file

Private $glArea As GLArea
Private $timer As New Timer As "Timer"

Private Sub initialize()
    
    Gl.ClearDepth(100.0)                'Enables Clearing Of The Depth Buffer
  gl.ClearColor(0.0, 0.0, 0.5, 0.0)   'This Will Clear The Background Color To Black
  gl.DepthFunc(gl.LESS)            'The Type Of Depth Test To Do
  gl.Enable(gl.DEPTH_TEST)         'Enables Depth Testing
  gl.ShadeModel(gl.SMOOTH)         'Enables Smooth Color Shading
  gl.MatrixMode(gl.PROJECTION)
  gl.LoadIdentity()                     'Reset The Projection Matrix
  glu.Perspective(45.0, screen.Width / screen.Height, 0.1, 100.0)   'Calculate The Aspect Ratio Of The Window
  gl.MatrixMode(gl.MODELVIEW)
    
End

Public Sub _new()
    
    $glArea = New GLArea(Me) As "GLArea"
    
    With $glArea
        .Background = Color.Red
        .Show()
    End With
    
    initialize()
    
    $timer.Enabled = True
    
End

Public Sub Timer_Timer()
    
    $glArea.Refresh()
    
End

Public Sub GLArea_Draw()
    
    Debug "fooo"
    
    gl.Translatef(3.0, 0.0, 0.0)                          'MOVE Right 3 Units

    gl.Begin(gl.QUADS)                                     'Draw A Quad
    gl.Vertex3f(-1.0, 1.0, 0.0)                    'Top Left
    gl.Vertex3f(1.0, 1.0, 0.0)                     'Top Right
    gl.Vertex3f(1.0, -1.0, 0.0)                    'Bottom Right
    gl.Vertex3f(-1.0, -1.0, 0.0)                   'Bottom Left
    gl.End()        
    
End
