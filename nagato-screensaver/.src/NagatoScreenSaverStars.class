' Gambas class file

Private $color As Integer
Private $speed As Float
Private $radius As Integer = 200
Private $x As Integer = 200
Private $y As Integer = 200

Private Sub setVariables()
    
    $x = Int(Rnd(0, Screen.W))
    $y = Int(Rnd(0, Screen.H))
    $radius = Int(Screen.H / Rnd(5, 10))
    $speed = Rnd(0.5, 3)
    
End

Private Function getRadius(argCount As Integer) As Integer
    
    Return IIf(Odd(argCount), $radius, $radius / 2)
    
End

Private Function getStarPoints(argCount As Integer) As Float[]
    
    Dim yukiCount As Integer
    Dim yukiResult As New Float[]
    
    For yukiCount = 0 To 10
        yukiResult.Add(getRadius(yukiCount) * (Sin(Rad(yukiCount * 36 + argCount * $speed))) + $x)
        yukiResult.Add(getRadius(yukiCount) * (Cos(Rad(yukiCount * 36 + argCount * $speed))) + $y)
    Next
    
    Return yukiResult
    
End

Public Sub DrawScreenSaver(argCount As Integer)
    
    If (argCount * 8) Mod Screen.W = 0 Then setVariables()
    
    With Paint
        .Polygon(getStarPoints(argCount))
        .Fill()
    End With
    
End
