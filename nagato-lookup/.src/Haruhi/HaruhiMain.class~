' Gambas class file

Private Const HeightHide As Integer = 1
Private Const HeightShow As Integer = 28

Private $applicationButtons As NagatoApplicationButtons
Private $spacer As NagatoSpacer
Private $searchBox As NagatoSearchBox
Private $infomationButton As NagatoInfomationButton

Private Sub initializeForm()
    
    Me.X = 0
    Me.Y = 0
    Me.Width = Screen.Width
    Me.Height = HeightHide
    Me.Background = NagatoSettings.FormColor
    MainHBox.Visible = False
    
End

' Private Sub addMenuButton(argTitle As String, argCategory As String, Optional argIcon As Picture)
'     
'     Dim yukiButton As MenuButton
'     Dim yukiMenu As NagatoApplicationsMenu
'     
'     If NagatoMenuCache3.GetApplications(argCategory).Count = 0 Then Return
'     
'     yukiButton = New MenuButton(MainHBox) 
'     
'     With yukiButton
'         .Text = (argTitle)
'         .AutoResize = True
'         .Arrow = False
'         If argIcon Then .Picture = argIcon
'         .Border = False
'         .Foreground = NagatoSettings.FontColor
'         .Font.Bold = True
'     End With
' 
'     yukiMenu = New NagatoApplicationsMenu(yukiButton, argCategory, argTitle)
'     
' Catch
'     Return
'     
' End

Private Sub initializeMenuButtons()

    ' If NagatoSettings.RecentApplications Then $recentApplicationsButton = New NagatoRecentApplicationsButton(MainHBox)
    ' addMenuButton(("Nagato"), "Nagato", MikuruIcons.Get("star"))
    ' addMenuButton(("Develop"), "Developments", MikuruIcons.Get("wrench"))
    ' addMenuButton(("Education"), "Educations", MikuruIcons.Get("bank"))
    ' addMenuButton(("Game"), "Games", MikuruIcons.Get("game-controller"))
    ' addMenuButton(("Graphics"), "Graphics", MikuruIcons.Get("image"))
    ' addMenuButton(("Office"), "Offices", MikuruIcons.Get("document-edit"))
    ' addMenuButton(("Media"), "Medias", MikuruIcons.Get("video-music"))
    ' addMenuButton(("Network"), "Networks", MikuruIcons.Get("web"))
    ' addMenuButton(("Settings"), "Settings", MikuruIcons.Get("equalizer"))
    ' addMenuButton(("System"), "Systems", MikuruIcons.Get("computer"))
    ' addMenuButton(("Utility"), "Utilities", MikuruIcons.Get("scissors"))
    ' 'addMenuButton(("KDE"), "Kde4", MikuruIcons.Get("gear"))
    
End

Public Sub SetForegroundColor(argColor As Integer)
    
    Dim yukiObject As Object
    
    For Each yukiObject In MainHBox.Children
        If Object.Type(yukiObject) = "MenuButton" Then yukiObject.Foreground = argColor 
    Next
    
End

Public Sub Form_Open()
    
    Application.MainWindow = Me
    initializeForm()
    $applicationButtons = New NagatoApplicationButtons(MainHBox)
    $spacer = New NagatoSpacer(MainHBox)
    $searchBox = New NagatoSearchBox(MainHBox)
    $infomationButton = New NagatoInfomationButton(MainHBox)
    
    MikuruNotify.Activate()
    
End

Public Sub Form_Enter()
    
    Me.Height = HeightShow
    MainHBox.Visible = True
    
End

Public Sub Form_Leave()
    
    Me.Height = HeightHide
    MainHBox.Visible = False
    $searchBox.Clear()
    
End

Public Sub Form_Move()
    
    Me.X = 0
    Me.Y = 0
    
End
