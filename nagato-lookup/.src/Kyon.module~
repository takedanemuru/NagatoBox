' Gambas module file

Private Function IsUnique() As Boolean
    
    ' Dim yukiWindow As DesktopWindow
    ' 
    ' For Each yukiWindow In Desktop.Windows
    '     If yukiWindow.VisibleName = Application.Name Then Return False
    ' Next
    
    If Not DBus.Session.Applications.Exist("org.gambas.nagato.lookup") Then
        NagatoDBus.Register()
        Return True
    End If
    
End

Public Sub Main()
    
    If IsUnique() Then
        NagatoMenuCache3.Activate()
        HaruhiMain.Show()
    End If
    
End

