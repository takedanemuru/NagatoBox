' Gambas class file

Private $menuButton As MenuButton
Private $text As String
Private $iconName As String

Public Sub _new(argContainer As Container, argText As String, argIcon As String, argMenu As String)
    
    $menuButton = New MenuButton(argContainer) As "MenuButton"
    
    With $menuButton
        .AutoResize = True
        .Arrow = False
        .Border = False
        .Menu = argMenu
        .Foreground = Color.White
        .Font.Bold = True
    End With
    
    $iconName = argIcon
    $text = argText
    
End

Public Sub MenuButton_Enter()
    
    Try Last.Foreground = Color.Gray
    If Not Error Then Last.Font.Bold = False
    
End

Public Sub MenuButton_Leave()
    
    Try Last.Foreground = Color.White
    If Not Error Then Last.Font.Bold = True
    
End

Public Sub Toggle()
    
    If $menuButton.H = 1 Then
        $menuButton.Text = ""
        $menuButton.Picture = Null
    Else 
        $menuButton.Text = $text
        $menuButton.Picture = MikuruIcons.Get($iconName)
    End If
    
End
