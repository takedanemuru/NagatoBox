' Gambas class file

Private $menuButton As MenuButton
Private $text As String
Private $iconName As String

Private Sub initializeMenuButton(argContainer As Container, argMenu As String)
    
    $menuButton = New MenuButton(argContainer) As "MenuButton"
    
    With $menuButton
        .AutoResize = True
        .Arrow = False
        .Border = False
        .Foreground = NagatoSettingsForm.FontColor
        .Font.Bold = True
        .Menu = argMenu
    End With
    
End

Public Sub _new(argContainer As Container, argText As String, argIcon As String, argMenu As String)
    
    initializeMenuButton(argContainer, argMenu)
    $iconName = argIcon
    $text = argText
    $menuButton.Refresh()
    
End

Public Sub MenuButton_Enter()
    
    Try Last.Foreground = Color.Gray
    If Not Error Then Last.Font.Bold = False
    
End

Public Sub MenuButton_Leave()
    
    Try Last.Foreground = NagatoSettingsForm.FontColor
    If Not Error Then Last.Font.Bold = True
    
End

Public Sub Toggle()
    
    If $menuButton.H = 1 Then
        $menuButton.Text = ""
        $menuButton.Picture = Null
    Else 
        $menuButton.Text = $text
        $menuButton.Picture = MikuruIcons.Get($iconName)
    End If
    
End
