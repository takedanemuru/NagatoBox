' Gambas class file

Private $rootMenu As Menu

Private Sub initializeRootMenu(argMenuName As String)
    
    $rootMenu = New Menu(HaruhiMain)
    $rootMenu.Name = argMenuName
    
End

Private Sub addPreferenceMenu()
    
    Dim yukiMenu As New Menu($rootMenu) 
    Dim yukiPereferenceMenu As NagatoPereferenceMenu
    
    With yukiMenu
        .Picture = MikuruIcons.Get("equalizer")
        .Text = ("Preference")
    End With
    
    yukiPereferenceMenu = New NagatoPereferenceMenu(yukiMenu)
    
End

Private Sub addLogoutMenu()
    
    Dim yukiMenu As New Menu($rootMenu)
    Dim yukiLogoutMenu As NagatoLogoutMenu
    
    With yukiMenu
        .Picture = MikuruIcons.Get("button-power")
        .Text = IIf(MikuruSession.IsNagatoBox(), ("Logout (NagatoBox)"), ("Logout (Openbox)"))
    End With
    
    yukiLogoutMenu = New NagatoLogoutMenu(yukiMenu)
    
End

Private Sub addHelpMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "HelpMenu"
    
    With yukiMenu
        .Picture = MikuruIcons.Get("question")
        .Text = ("Help")
    End With
    
End

Private Sub addAboutMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "AboutMenu"
    
    With yukiMenu
        .Picture = MikuruIcons.Get("star")
        .Text = ("About")
    End With
    
End

Private Sub addCloseMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "CloseMenu"
    
    With yukiMenu
        .Picture = MikuruIcons.Get("button-cross")
        .Text = ("Close")
    End With
    
End

Public Sub _new(argMenuName As String)
    
    initializeRootMenu(argMenuName)
    addPreferenceMenu()
    'addHelpMenu()
        MikuruMenuSeparator.Set($rootMenu)
    addAboutMenu()
    addCloseMenu()
    If MikuruSession.IsOpenbox() Then
        MikuruMenuSeparator.Set($rootMenu)
        addLogoutMenu()
    End If
    
End

Public Sub AboutMenu_Click()
    
    HaruhiAbout.Show()
    
End

Public Sub CloseMenu_Click()
    
    If Message.Question(("YUKI.N > Are you sure to close this application ?"), ("Cancel"), ("Close")) = 2 Then
        HaruhiMain.Close()
    End If
    
End
