' Gambas class file

Private $rootMenu As Menu

Private $preferenceMenu As NagatoPreferenceMenu
Private $screenshotMenu As NagatoScreenshotMenu
Private $alsaMenu As NagatoAlsaMenu

Private Sub initializeRootMenu(argMenuName As String)
    
    $rootMenu = New Menu(HaruhiMain)
    $rootMenu.Name = argMenuName
    
End

Private Sub addPlacesMenu()
    
    Dim yukiMenu As NagatoMenuDirectory
    
    yukiMenu = New NagatoMenuDirectory($rootMenu, User.Home)
    
End

Private Sub addLogoutMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "LogoutMenu"
    
    With yukiMenu
        .Picture = MikuruIcons.Get("button-power")
        .Text = IIf(MikuruSession.IsNagatoBox(), ("Logout (NagatoBox)"), ("Logout (Openbox)"))
    End With
    
End

Private Sub addAboutMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "AboutMenu"
    
    With yukiMenu
        .Picture = MikuruIcons.Get("star")
        .Text = ("About")
    End With
    
End

Private Sub addCloseMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "CloseMenu"
    
    With yukiMenu
        .Picture = MikuruIcons.Get("button-cross")
        .Text = ("Close")
    End With
    
End

Public Sub _new(argMenuName As String)
    
    initializeRootMenu(argMenuName)
    addPlacesMenu()
        MikuruMenuSeparator.Set($rootMenu)
    $preferenceMenu = New NagatoPreferenceMenu($rootMenu)
    $screenshotMenu = New NagatoScreenshotMenu($rootMenu)
    $alsaMenu = New NagatoAlsaMenu($rootMenu)
        MikuruMenuSeparator.Set($rootMenu)
    addAboutMenu()
    If Not MikuruSession.IsOpenbox() Then addCloseMenu()
    If MikuruSession.IsOpenbox() Then
        addLogoutMenu()
    End If
    
End

Public Sub AboutMenu_Click()
    
    HaruhiAbout.Show()
    
End

Public Sub CloseMenu_Click()
    
    If Message.Question(("YUKI.N > Are you sure to close this application ?"), ("Cancel"), ("Close")) = 2 Then
        HaruhiMain.Close()
    End If
    
End

Public Sub LogoutMenu_Click()
    
    Shell "nagato-session -l"
    
End
