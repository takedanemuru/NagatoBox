' Gambas class file

Private $rootMenu As Menu

Private Sub addMenu(argText As String, argTag As Integer, Optional argIcon As Picture)
    
    Dim yukiMenu As New Menu($rootMenu) As "MenuItem"
    
    With yukiMenu
        .Text = argText
        .Tag = argTag
        If argIcon Then .Picture = argIcon
    End With
    
End

Private Sub initializeChildMenus()
    
    With MikuruSession
        addMenu(("Exit"), .TypeExit, MikuruIcons.Get("arrow-right"))
        addMenu(("Reboot"), .TypeReboot, MikuruIcons.Get("button-rotate-cw"))
        addMenu(("Shutdown"), .TypeShutdown, MikuruIcons.Get("button-power"))
    End With
    
End

Public Sub _new(argRootMenu As Menu)
    
    $rootMenu = argRootMenu
    initializeChildMenus()
    
End

Public Sub MenuItem_Click()
    
    MikuruSession.Logout(Last.Tag)
    
End
