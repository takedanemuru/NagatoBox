' Gambas class file

Private $observer As Observer
Private $rootMenu As Menu

Private Sub addFormColorMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "FormColorMenu"
    
    With yukiMenu
        .Picture = MikuruColorChip.Get(NagatoSettings.FormColor)
        .Text = ("Change form color")
    End With
    
End

Private Sub addFontColorMenu()
    
    Dim yukiMenu As New Menu($rootMenu) As "FontColorMenu"
    
    With yukiMenu
        .Picture = MikuruColorChip.Get(NagatoSettings.FontColor)
        .Text = ("Change font color")
    End With
    
End

Private Sub initializeMenu()
    
    addFormColorMenu()
    addFontColorMenu()
    
End

Private Sub initializeDummyMenu()
    
    Dim yukiMenu As New Menu($rootMenu)
    
    yukiMenu.Text = "can you see this?"
    
End

Public Sub _new(argMenu As Menu)
    
    $rootMenu = argMenu
    $observer = New Observer($rootMenu) As "Asakura"
    initializeDummyMenu()
    
End

Public Sub Asakura_Show()
    
    $rootMenu.Children.Clear()
    initializeMenu()
    
End

Public Sub FormColorMenu_Click()
    
    HaruhiColorChooser.Title = ("Select form color")
    HaruhiColorChooser.SetColor(NagatoSettings.FormColor)
    
    If HaruhiColorChooser.ShowDialog() = HaruhiColorChooser.ResponseApply Then
        NagatoSettings.FormColor = MikuruDialog.Color
        HaruhiMain.Background = MikuruDialog.Color
    Endif
    
End

Public Sub FontColorMenu_Click()
    
    HaruhiColorChooser.Title = ("Select font color")
    HaruhiColorChooser.SetColor(NagatoSettings.FontColor)
    
    If HaruhiColorChooser.ShowDialog() = HaruhiColorChooser.ResponseApply Then
        NagatoSettings.FontColor = MikuruDialog.Color
        HaruhiMain.SetForegroundColor(MikuruDialog.Color)
    Endif
    
End
