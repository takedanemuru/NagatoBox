' Gambas class file

Public Sub _call(argStartY As Integer, argText As String, Optional argAlign As Integer = Align.Center) As Integer
    
    Dim yukiTextHeight As Integer = Paint.Font.RichTextHeight(argText, HaruhiMain.W - 16)
    Dim yukiRect As New Rect(8, argStartY, HaruhiMain.W - 16, yukiTextHeight)
    
    If argStartY + yukiTextHeight + 8 >= HaruhiMain.H Then Return argStartY + yukiTextHeight
    
    Paint.Brush = Paint.Color(NagatoSettingsFonts.ShadeColor + Color.Transparent * 192)
    Paint.DrawRichText(argText, yukiRect.X + 1, yukiRect.Y + 1, yukiRect.W, yukiRect.H, argAlign)
    Paint.Fill()
    Paint.Brush = Paint.Color(NagatoSettingsFonts.BaseColor + Color.Transparent * 192)
    Paint.DrawRichText(argText, yukiRect.X, yukiRect.Y, yukiRect.W, yukiRect.H, argAlign)
    Paint.Fill()
    
    Return argStartY + yukiTextHeight 
    
End
