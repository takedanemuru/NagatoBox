' Gambas class file

Private $background As Image

Private Sub refreshBackgroundImage()
    
    Dim yukiImage As Image = Image.Load(MikuruHidden.PathModefiedImage)
    
    $background = yukiImage.Copy(Screen.W - HaruhiMain.W, 0, HaruhiMain.W, Screen.H)
    
Catch
    Return
    
End

Public Sub _call()
    
    If 2 > DateDiff(Stat(MikuruHidden.PathModefiedImage).LastModified, Now, gb.Second) Then
        refreshBackgroundImage()
    Endif
    
    Paint.DrawImage($background, 0, 0)
    
End

Public Sub _new()
    
    refreshBackgroundImage()
    
End
