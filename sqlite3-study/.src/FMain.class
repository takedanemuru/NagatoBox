' Gambas class file

Private $observer As Observer

Private Sub setGridView()
        
        Dim yukiCount As Integer
        
        NagatoDB.Select()
        Debug "max: " & NagatoDB.GetDataCountMax()
        
        For yukiCount = 0 To NagatoDB.GetDataCountMax()
                Inc GridView1.Rows.Count
                'GridView1[yukiCount, 0].Picture = NagatoDB.GetIconPicture(yukiCount)
                GridView1[yukiCount, 0].Picture = NagatoDB.GetIconPicture(yukiCount)
                GridView1[yukiCount, 1].Text = NagatoDB.GetName(yukiCount)
                GridView1[yukiCount, 2].Text = CString(NagatoDB.GetLastModefied(yukiCount))
                GridView1[yukiCount, 3].Text = CString(NagatoDB.GetSize(yukiCount))
        Next
        
End
        
Private Sub initializeForm()
        
        With GridView1
                .Columns.Count = 4
                        .Columns[0].Text = "Picture"
                        .Columns[0].Width = 64
                        .Columns[1].Text = "Name"
                        .Columns[2].Text = "Last Modefied"
                        .Columns[3].Text = "Size"
                .Rows.Count = 3
                .Rows.Height = 64
        End With
        
        GridView1[0, 0].Picture = Stock["64/program"]
        
End

Public Sub _new()

End

Public Sub Form_Open()

        $observer = New Observer(NagatoDB) As "Observer"
        initializeForm()
        NagatoDB.Connect()

End

Public Sub Form_Close()
        
        NagatoDB.CloseConnection()
        
End

Public Sub Button1_Click()

        Dim yukiPathArray As String[]
        Dim yukiPath As String

        yukiPathArray = RDir("/home/colonel-in-cheese/ピクチャ/スクリーンショット", "", gb.File, False)

        For Each yukiPath In yukiPathArray
                NagatoDB.AddRow("/home/colonel-in-cheese/ピクチャ/スクリーンショット" &/ yukiPath)
        Next

        Debug NagatoDB.GetDataCountMax()

        setGridView()

End

Public Sub Observer_Done()
        
        Debug "it's done."
        Debug NagatoDB.GetDataCount()
        
End

