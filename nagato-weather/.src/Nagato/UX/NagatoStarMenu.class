' Gambas class file

Inherits NagatoButtonMenu

Enum MenuNone, MenuSetLocation, MenuShowForecast, MenuToggleBorder, MenuAbout, MenuQuit

Public Sub RootMenu_Show()
    
    Me._$rootMenu.Children.Clear()
    
    Me._AddMenu(("Set User Location"), MenuSetLocation, "user")
    Me._AddMenu(("Forecast"), MenuShowForecast, "information-balloon")
        Me._AddMenu("", MenuNone)
    Me._AddMenu(("About"), MenuAbout, "star")
    Me._AddMenu(("Quit"), MenuQuit, "button-power")
    
End

Public Sub MenuItem_Click()
    
    Select Case Last.Tag
        Case MenuSetLocation
            Try HaruhiWeatherForecast.Close()
            If HaruhiUserLocation.ShowDialog() <> MikuruDialog.ResponseApply Then Return
            NagatoWeatherCache.Activate(NagatoSettingsLocation.UserLatitude, NagatoSettingsLocation.UserLongitude)
        Case MenuShowForecast
            HaruhiWeatherForecast.Show()
        Case MenuAbout
            HaruhiAbout.Show()
        Case MenuQuit
            HaruhiMain.Close()
    End Select
    
End
