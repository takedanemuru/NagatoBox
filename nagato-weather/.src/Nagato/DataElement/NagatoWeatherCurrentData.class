' Gambas class file

Property Read Icon As Image
Property Read CurrentElement As NagatoWeatherElement
Property Read BackgroundColor As Integer

Private Const IconSize As Integer = 96

Private $currentWeather As NagatoWeatherElement
Private $backgroundColor As Integer

Public Sub Reset()
    
    $currentWeather = NagatoWeatherCache.GetWeatherElementMostRecent()
    $backgroundColor = MikuruWeatherColor($currentWeather[MikuruWeatherKey.IconId], MikuruTimeStamp.IsDay())
    
End

Private Function Icon_Read() As Image

    Return MikuruWeatherIcon(MikuruTimeStamp.IsDay(), $currentWeather[MikuruWeatherKey.IconId], IconSize)

End

Private Function CurrentElement_Read() As NagatoWeatherElement

    Return $currentWeather

End

Private Function BackgroundColor_Read() As Integer

    Return $backgroundColor

End
