' Gambas class file

Inherits NagatoSettingsCore

Property Read UserLatitude As Float
Property Read UserLongitude As Float
Property Read UserLocationName As String
Property Read UserLocationLabelText As String

Public Sub ChangeUserLocation(argGeoElement As NagatoGeoElement)
    
    Me._$settings["geo/latitude"] = NagatoCipher.Encryption(argGeoElement.Latitude)
    Me._$settings["geo/longitude"] = NagatoCipher.Encryption(argGeoElement.Longitude)
    Me._$settings["geo/visible-name"] = NagatoCipher.Encryption(argGeoElement.VisibleName)
    Me._$settings.Save()
    
End

Private Function UserLatitude_Read() As Float

    Dim yukiLatitude As String = Me._$settings["geo/latitude", ""]

    If yukiLatitude = "" Then
        Return 34.773632
    Else
        Return CFloat(NagatoCipher.Decryption(yukiLatitude))
    Endif


End

Private Function UserLongitude_Read() As Float

    Dim yukiLongitude As String = Me._$settings["geo/longitude", ""]

    If yukiLongitude = "" Then
        Return 135.3166017
    Else
        Return CFloat(NagatoCipher.Decryption(yukiLongitude))
    Endif

End

Private Function UserLocationName_Read() As String

    Dim yukiVisibleName As String = Me._$settings["geo/visible-name", ""]

    If yukiVisibleName = "" Then
        Return "Nishinomiya-City Japan"
    Else
        Return NagatoCipher.Decryption(yukiVisibleName)
    Endif

End

Private Function UserLocationLabelText_Read() As String

    Dim yukiTemplate As String = File.Load("Text/LocationLabelText")

   Return Subst$(yukiTemplate, Me.UserLocationName, Me.UserLatitude, Me.UserLongitude)

End
