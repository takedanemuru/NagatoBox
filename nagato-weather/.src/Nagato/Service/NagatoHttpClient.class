' Gambas class file

Create Private

Property Read Buffer As String

Public _$buffer As String
Public _$httpClient As New HttpClient As "HttpClient"

Event Finished

Public Sub _Connect(argUrl As String)
    
    With Me._$httpClient
        .Async = True
        .URL = argUrl
        .Timeout = 30
        .Get()
    End With
    
Catch 
    Return 'to avoid changing property during downloading.
    
End

Public Sub _Finished()
    
    
    
End

Public Sub HttpClient_Read()
     
    Dim yukiLines As String = Read #Last, Lof(Last)
     
    Me._$buffer &= yukiLines
    
End

Public Sub HttpClient_Finished()
    
    Me._$httpClient.Close()
    Me._Finished()
    
    Raise Finished
    
End

Private Function Buffer_Read() As String

    Return Me._$buffer

End
