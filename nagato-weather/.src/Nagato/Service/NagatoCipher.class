' Gambas class file

Private Function getSeed() As Integer
    
    Dim yukiCount As Integer
    Dim yukiResult As Integer
    Dim yukiKey As String = Base64$(User.Name & System.Host)
    
    For yukiCount = 0 To Len(yukiKey)
        yukiResult += Asc(yukiKey, yukiCount)
    Next
    
    Return yukiResult + System.FirstDayOfWeek + System.TimeZone
    
End

Private Sub getOrder(argLength As Integer) As Integer[]
    
    Dim yukiRandomNumber As Integer
    Dim yukiResult As New Integer[]

    Randomize getSeed()

    Do 
        yukiRandomNumber = Int(Rnd(0, argLength))
        If Not yukiResult.Exist(yukiRandomNumber) Then
            yukiResult.Add(yukiRandomNumber)
        End If
    Loop Until yukiResult.Count = argLength
    
    Return yukiResult
    
End

Public Function Encryption(argData As String) As String
    
    Dim yukiResult As String
    Dim yukiCount As Integer
    Dim yukiOrder As Integer[] = getOrder(Len(Base64$(argData)))

    For yukiCount = 0 To yukiOrder.Max
        yukiResult &= Mid$(Base64$(argData), yukiOrder[yukiCount] + 1, 1)
    Next
    
    Return yukiResult
    
End

Public Function Decryption(argData As String) As String
    
    Dim yukiResult As String
    Dim yukiCount As Integer
    Dim yukiOrder As Integer[] = getOrder(Len(argData))

    For yukiCount = 0 To yukiOrder.Max
        yukiResult &= Mid$(argData, yukiOrder.Find(yukiCount) + 1, 1)
    Next

    Return UnBase64$(yukiResult)
    
End
