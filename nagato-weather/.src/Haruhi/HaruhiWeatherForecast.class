' Gambas class file

Private $grids As NagatoGridsHandlerForecast

Private Sub refresh()
    
    Dim yukiDayFromToday As Integer
    Dim yukiDate As String
    
    For yukiDayFromToday = 0 To 14
        yukiDate = Format$(DateAdd(Now, gb.Day, yukiDayFromToday), "yyyy-mm-dd")
        $grids.SetData(yukiDate)
    Next
    
End

Public Sub Form_Open()

    Me.Center()
    $grids = New NagatoGridsHandlerForecast(WeatherforecastGrid)
    If NagatoWeatherCache.IsReady Then refresh()

End

Public Sub Form_Close()
    
    NagatoSettingsGrids.Save(WeatherforecastGrid)
    
End
