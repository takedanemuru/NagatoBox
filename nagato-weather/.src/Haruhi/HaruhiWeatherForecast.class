' Gambas class file

Private $grids As NagatoGridsHandlerForecast

Private Sub refresh()
    
    Dim yukiDayFromToday As Integer
    Dim yukiDate As String
    
    For yukiDayFromToday = 0 To 14
        yukiDate = Format$(DateAdd(Now, gb.Day, yukiDayFromToday), "yyyy-mm-dd")
        $grids.SetData(yukiDate)
    Next
    
End

Public Sub Form_Open()

    $grids = New NagatoGridsHandlerForecast(Me)
    If NagatoWeatherCache.IsReady Then refresh()
    NagatoSettingsForm.Load(Me)

End

Public Sub Form_Close()

    NagatoSettingsForm.Save(Me)

End
