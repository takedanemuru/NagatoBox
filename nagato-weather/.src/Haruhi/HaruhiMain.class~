' Gambas class file

Private $weatherDrawingArea As NagatoWeatherDrawingArea
Private $starMenu As NagatoStarMenu
Private $observer As Observer

Private Sub resetTitleBar()
    
    Me.Title = Subst$(("Weather Information for &1"), NagatoSettings.UserLocationName)
    
End

Private Sub initializeDrawingArea()

    $weatherDrawingArea = New NagatoWeatherDrawingArea(MainDrawingArea) As "WeatherDrawingArea"
    
End

Public Sub Request(argLatitude As Float, argLongitude As Float)
    
    $observer = New Observer(NagatoWeatherCache) As "Asakura"
    NagatoWeatherCache.Activate(argLatitude, argLongitude)
    $weatherDrawingArea.Longitude = argLongitude
    
End

Public Sub _new()

    initializeDrawingArea()
    $starMenu = New NagatoStarMenu(StarButton)
    
End

Public Sub Asakura_Finished()
    
    Debug "finished"
    
    $weatherDrawingArea.Refresh()
    resetTitleBar()
    
End

Public Sub Form_Open()

    NagatoSettingsForm.Load(Me)
    resetTitleBar()

End

Public Sub Form_Close()

    NagatoSettingsForm.Save(Me)

End

Public Sub Form_Resize()
    
    With MainDrawingArea
        .H = Me.H
        .W = Me.W
        .X = 0
        .Y = 0
    End With
    
End

Public Sub WeatherDrawingArea_BackgroundColor(argBackground As Integer)
    
    MenuHBox.Background = argBackground
    
End

Public Sub MenuHBox_Enter()

    StarButton.Visible = True

End

Public Sub MenuHBox_Leave()

    StarButton.Visible = False

End

Public Sub MainDrawingArea_Enter()

    StarButton.Visible = True

End

Public Sub MainDrawingArea_Leave()

    StarButton.Visible = False

End
