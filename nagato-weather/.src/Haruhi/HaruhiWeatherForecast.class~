' Gambas class file

Private $grids As NagatoGridsHandlerForecast

Private Sub refresh()
    
    Dim yukiCount As Integer
    Dim yukiDate As String
    
    If Not NagatoWeatherCache.IsReady Then Return
    
    For yukiCount = 0 To 6
        yukiDate = Format$(DateAdd(Now, gb.Day, yukiCount), "yyyy-mm-dd")
        $grids.SetData(yukiDate)
    Next
    
End

Public Sub Form_Open()

    Me.Center()
    $grids = New NagatoGridsHandlerForecast(WeatherforecastGrid)
    refresh()

End

Public Sub Form_Close()
    
    NagatoSettings.SaveGridsSettings(WeatherforecastGrid)
    
End
