' Gambas class file

Private $menuBar As NagatoMenuBar
Private $weatherDrawingArea As NagatoWeatherDrawingArea
Private $observer As Observer

Public Sub _new()

    $menuBar = New NagatoMenuBar(Me) As "Widget"
    $weatherDrawingArea = New NagatoWeatherDrawingArea(Me) As "Widget"
    $observer = New Observer(NagatoWeatherCache) As "Asakura"
    
End

Public Sub Asakura_Finished()
    
    $weatherDrawingArea.Refresh()
    Me.Title = NagatoSettingsLocation.UserLocationName
    
End

Public Sub Form_Open()

    Application.MainWindow = Me
    NagatoSettingsForm.Load(Me)
    Me.Title = NagatoSettingsLocation.UserLocationName
    NagatoWeatherCache.Activate(NagatoSettingsLocation.UserLatitude, NagatoSettingsLocation.UserLongitude)

End

Public Sub Form_Close()

    NagatoSettingsForm.Save(Me)

End

Public Sub Widget_Signal(argSignal As Integer, argValues As Variant[])
    
    Select Case argSignal
        Case MikuruSignal.ViewChangeBackground
            $menuBar.SetBackgroundColor(argValues[0])
        Case MikuruSignal.ViewChangeStarButtonVisible
            $menuBar.SetStarButtonVisible(argValues[0])
    End Select
    
End
