' Gambas class file

Private $menuBar As NagatoMenuBar
Private $weatherDrawingArea As NagatoWeatherDrawingArea
Private $observer As Observer

Private Sub resetTitleBar()
    
    Me.Title = Subst$(("Weather Information for &1"), NagatoSettings.UserLocationName)
    
End

Public Sub Request(argLatitude As Float, argLongitude As Float)
    
    $observer = New Observer(NagatoWeatherCache) As "Asakura"
    NagatoWeatherCache.Activate(argLatitude, argLongitude)
    $weatherDrawingArea.ChangeLongitude(argLongitude)
    
End

Public Sub _new()

    $menuBar = New NagatoMenuBar(Me) As "Widget"
    $weatherDrawingArea = New NagatoWeatherDrawingArea(Me) As "Widget"
    
End

Public Sub Asakura_Finished()
    
    $weatherDrawingArea.Refresh()
    resetTitleBar()
    
End

Public Sub Form_Open()

    Application.MainWindow = Me
    NagatoSettingsForm.Load(Me)
    Me.Border = NagatoSettingsForm.ShowBorder
    resetTitleBar()

End

Public Sub Form_Close()

    NagatoSettingsForm.Save(Me)

End

Public Sub Widget_BackgroundColor(argBackground As Integer)
    
    $menuBar.SetBackgroundColor(argBackground)
    
End

Public Sub Widget_MoveFormTo(argX As Integer, argY As Integer)

    If Not NagatoSettingsForm.ShowBorder Then Return

    Me.X = argX
    Me.Y = argY 

End

Public Sub Widget_ChangeStarButtonVisible(argVisible As Boolean)

    $menuBar.SetStarButtonVisible(argVisible)

End
