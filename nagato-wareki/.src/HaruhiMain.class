' Gambas class file

Private $grigColor As New NagatoGridColor

Private Sub setBackground(argEra As String)
    
    Dim yukiIndex As Integer
    
    $grigColor.Set(argEra)
    
    For yukiIndex = 0 To MainGrids.Columns.Max
        MainGrids[MainGrids.Rows.Max, yukiIndex].Background = $grigColor.Color
    Next
    
End

Private Sub setRow(argLine As String)
    
    Dim yukiData As String[] = Split(argLine, ",", "", True)
    
    Inc MainGrids.Rows.Count
    
    MainGrids[MainGrids.Rows.Max, 0].Text = yukiData[1]
    MainGrids[MainGrids.Rows.Max, 1].Text = yukiData[8]
    MainGrids[MainGrids.Rows.Max, 2].Text = yukiData[10]
    MainGrids[MainGrids.Rows.Max, 3].Text = yukiData[3]
    MainGrids[MainGrids.Rows.Max, 3].Alignment = Align.Right
    
    setBackground(yukiData[4])
    
End

Public Sub _new()

End

Public Sub Form_Open()

    Dim yukiLines As String[] = Split(File.Load("Data/wareki-utf8.csv"), "\n", "", True)
    Dim yukiIndex As Integer

    MainGrids.Columns.Count = 4
    MainGrids.Columns[0].Text = ("Wareki")
    MainGrids.Columns[3].Text = ("A.D.")

    For yukiIndex = 1 To yukiLines.Max
        setRow(yukiLines[yukiIndex])
    Next

    MainGrids.Columns[0].W = 160
    MainGrids.Columns[1].W = 32
    MainGrids.Columns[2].W = 32

End
